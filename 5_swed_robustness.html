<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Modern Sweden Robustness</title>

<script src="library/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="library/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>


<script src="library/auto_tab_first_section.js"></script>

</head>

<body>
<div style="width:100%;height:200px;background-image:url('library/header/swed.jpg');background-size:cover;"></div>
<div class="container-fluid main-container"><div class="row"><div class="col-md-4"><a href="index.html"><i class="glyphicon glyphicon-th-list"></i> Back to index</a></div></div></div>

<div class="container-fluid main-container">


<div id="th-century-sweden-robustness-analyses" class="section level1 tab-content">
<h1>20th century Sweden robustness analyses</h1>
<div id="loading-details" class="section level3 accordion">
<h3>Loading details</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;0__helpers.R&quot;</span>)
opts_chunk$<span class="kw">set</span>(<span class="dt">warning=</span><span class="ot">TRUE</span>, <span class="dt">cache=</span>F,<span class="dt">cache.lazy=</span>F,<span class="dt">tidy=</span><span class="ot">FALSE</span>,<span class="dt">autodep=</span><span class="ot">TRUE</span>,<span class="dt">dev=</span><span class="kw">c</span>(<span class="st">&#39;png&#39;</span>,<span class="st">&#39;pdf&#39;</span>),<span class="dt">fig.width=</span><span class="dv">20</span>,<span class="dt">fig.height=</span><span class="fl">12.5</span>,<span class="dt">out.width=</span><span class="st">&#39;1440px&#39;</span>,<span class="dt">out.height=</span><span class="st">&#39;900px&#39;</span>,<span class="dt">cache.extra=</span><span class="kw">file.info</span>(<span class="st">&#39;swed1.rdata&#39;</span>)[, <span class="st">&#39;mtime&#39;</span>])

make_path =<span class="st"> </span>function(file) {
    <span class="kw">get_coefficient_path</span>(file, <span class="st">&quot;swed&quot;</span>)
} 
<span class="co"># options for each chunk calling knit_child</span>
opts_chunk$<span class="kw">set</span>(<span class="dt">warning=</span><span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="analysis-description" class="section level2">
<h2>Analysis description</h2>
<div id="data-subset" class="section level3">
<h3>Data subset</h3>
<p>The <code>swed_subset_children.1</code> dataset is based on the full dataset of all participants where paternal age is known and birth years are from 1947 to 1959. The subset contains 117726 randomly drawn participants from 80000 families.</p>
</div>
<div id="model-description" class="section level3">
<h3>Model description</h3>
<p>All of the following models are the same as our main model m3, except for the noted changes to test robustness.</p>
</div>
</div>
<div id="r1_relaxed_exclusion_criteria" class="section level2 tab-content">
<h2><em>r1</em>: Relaxed exclusion criteria</h2>
<p>For the four historical populations, we imposed quite stringent exclusion criteria to ensure sufficient data quality for our intended analysis. This was not necessary for the modern Swedish data, because there were no exclusion criteria to relax.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_filename =<span class="st"> </span><span class="kw">make_path</span>(<span class="st">&quot;r1_relaxed_exclusion_criteria&quot;</span>)
if (<span class="kw">file.exists</span>(model_filename)) {
    <span class="kw">cat</span>(<span class="kw">summarise_model</span>())
    r1 =<span class="st"> </span>model
}</code></pre></div>
<div id="model-summary" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 117726) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## sd ~ student_t(3, 0, 10)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 75475) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        438 1.01
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.72      0.02     0.69     0.75       3000
## paternalage               -0.05      0.01    -0.08    -0.02       1375
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.06      0.00    -0.07    -0.05       3000
## maternalage.factor1420     0.07      0.01     0.06     0.09       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.01      0.01    -0.02     0.04       1388
## paternal_loss01            0.19      0.28    -0.38     0.69       3000
## paternal_loss15           -0.06      0.08    -0.21     0.09       3000
## paternal_loss510          -0.06      0.03    -0.12     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.06     0.02       3000
## paternal_loss1520          0.00      0.01    -0.03     0.03       3000
## paternal_loss2025          0.00      0.01    -0.02     0.02       3000
## paternal_loss2530         -0.02      0.01    -0.04     0.00       3000
## paternal_loss3035          0.00      0.01    -0.02     0.01       3000
## paternal_loss3540          0.00      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.30      0.22    -0.76     0.10       3000
## maternal_loss15           -0.02      0.10    -0.22     0.18       3000
## maternal_loss510           0.00      0.05    -0.09     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.03      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.02     0.02       3000
## maternal_loss4045         -0.01      0.01    -0.03     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.02      0.01     0.00     0.03       1642
## older_siblings2            0.03      0.01     0.00     0.05       1404
## older_siblings3            0.04      0.02     0.01     0.08       1445
## older_siblings4            0.01      0.02    -0.04     0.06       1610
## older_siblings5P          -0.04      0.03    -0.10     0.02       1600
## nr.siblings                0.04      0.00     0.03     0.04       1515
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.061</td>
<td align="center">1.999</td>
<td align="center">2.123</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9505</td>
<td align="center">0.9233</td>
<td align="center">0.9782</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9955</td>
<td align="center">0.9846</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.001</td>
<td align="center">0.9893</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9419</td>
<td align="center">0.9338</td>
<td align="center">0.9496</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.074</td>
<td align="center">1.057</td>
<td align="center">1.091</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9913</td>
<td align="center">0.9757</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.007</td>
<td align="center">0.9787</td>
<td align="center">1.037</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.209</td>
<td align="center">0.6848</td>
<td align="center">1.984</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9425</td>
<td align="center">0.8074</td>
<td align="center">1.095</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9399</td>
<td align="center">0.8834</td>
<td align="center">0.9992</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9804</td>
<td align="center">0.9427</td>
<td align="center">1.02</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1</td>
<td align="center">0.9749</td>
<td align="center">1.027</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9972</td>
<td align="center">0.9757</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9841</td>
<td align="center">0.965</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9963</td>
<td align="center">0.98</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9809</td>
<td align="center">1.012</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9863</td>
<td align="center">0.9708</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9453</td>
<td align="center">0.9344</td>
<td align="center">0.9565</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7418</td>
<td align="center">0.47</td>
<td align="center">1.11</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9842</td>
<td align="center">0.8018</td>
<td align="center">1.203</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.001</td>
<td align="center">0.9108</td>
<td align="center">1.096</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9814</td>
<td align="center">0.9292</td>
<td align="center">1.036</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9911</td>
<td align="center">0.952</td>
<td align="center">1.031</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.026</td>
<td align="center">0.9929</td>
<td align="center">1.06</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1</td>
<td align="center">0.9698</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">0.9997</td>
<td align="center">0.9769</td>
<td align="center">1.023</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.003</td>
<td align="center">0.9838</td>
<td align="center">1.023</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9914</td>
<td align="center">0.9731</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9808</td>
<td align="center">0.9707</td>
<td align="center">0.991</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.018</td>
<td align="center">1.004</td>
<td align="center">1.033</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.028</td>
<td align="center">1.004</td>
<td align="center">1.054</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.042</td>
<td align="center">1.006</td>
<td align="center">1.08</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.01</td>
<td align="center">0.9624</td>
<td align="center">1.06</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9597</td>
<td align="center">0.9038</td>
<td align="center">1.02</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.038</td>
<td align="center">1.032</td>
<td align="center">1.044</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.009</td>
<td align="center">0.9999</td>
<td align="center">1.019</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.89;1.96]</td>
<td align="center">[1.91;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.83</td>
<td align="center">[1.79;1.87]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.96</td>
<td align="center">[-7.67;-2.18]</td>
<td align="center">[-6.73;-3.14]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.92;0.98]</td>
<td align="center">[0.93;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-33-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-34-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-35-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-35-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-36-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-37-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r1_relaxed_exclusion_criteria.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r1_relaxed_exclusion_criteria.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r2_few_controls" class="section level2 tab-content">
<h2><em>r2</em>: Fewer covariates</h2>
<p>Adding covariates increases the complexity of the model and makes it harder to interpret. We chose to adjust for many potential confounds because we are interested in causal isolation of the paternal age effect. Here we show what happens when only birth cohort and average paternal age in the family are adjusted for.</p>
<div id="model-summary-1" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-1" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 73 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + paternalage.mean + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1500; warmup = 1000; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.02      0.01        0     0.04         99 1.06
## 
## Population-Level Effects: 
##                       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept                 0.72      0.01     0.70     0.75       3000    1
## paternalage              -0.03      0.01    -0.04    -0.02       3000    1
## birth_cohort1950M1955    -0.01      0.01    -0.02     0.00       3000    1
## birth_cohort1955M1960    -0.02      0.01    -0.03    -0.01       3000    1
## paternalage.mean          0.00      0.01    -0.01     0.02       3000    1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-1" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.064</td>
<td align="center">2.014</td>
<td align="center">2.115</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9679</td>
<td align="center">0.9563</td>
<td align="center">0.98</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9899</td>
<td align="center">0.9796</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9806</td>
<td align="center">0.9707</td>
<td align="center">0.9907</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.001</td>
<td align="center">0.9865</td>
<td align="center">1.015</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-1" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:88%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="16%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.91</td>
<td align="center">[1.89;1.93]</td>
<td align="center">[1.9;1.92]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.85</td>
<td align="center">[1.83;1.87]</td>
<td align="center">[1.84;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-3.2</td>
<td align="center">[-4.37;-2]</td>
<td align="center">[-3.97;-2.43]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.97</td>
<td align="center">[0.96;0.98]</td>
<td align="center">[0.96;0.98]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-1" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-44-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-44-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-44-3.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-1" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-45-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-1" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-1" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-46-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-46-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-1" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-47-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-1" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-48-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-1" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-1" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r2_few_controls.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r2_few_controls.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r3_birth_order_continuous" class="section level2 tab-content">
<h2><em>r3</em>: Continuous birth order control</h2>
<p>We chose to control for birth order/number of older siblings as a categorical variable, lumping all those who had more than 5 in the category 5+. Because a continuous covariate is also plausible, we tested this alternative model as well.</p>
<div id="model-summary-2" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-2" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 1408177) 
## Samples: 6 chains, each with iter = 1000; warmup = 500; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 884975) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01        206 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.75      0.00     0.74     0.76       3000
## paternalage               -0.02      0.00    -0.03    -0.01       3000
## birth_cohort1950M1955      0.00      0.00     0.00     0.00       3000
## birth_cohort1955M1960      0.00      0.00     0.00     0.01       3000
## male1                     -0.06      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.05      0.00     0.05     0.05       3000
## maternalage.factor3561    -0.01      0.00    -0.01     0.00       3000
## paternalage.mean          -0.03      0.00    -0.03    -0.02       3000
## paternal_loss01            0.11      0.05     0.01     0.21       3000
## paternal_loss15            0.03      0.02    -0.01     0.07       3000
## paternal_loss510          -0.02      0.01    -0.04     0.00       3000
## paternal_loss1015         -0.01      0.01    -0.02     0.00       3000
## paternal_loss1520          0.00      0.00     0.00     0.01       3000
## paternal_loss2025          0.00      0.00    -0.01     0.00       3000
## paternal_loss2530          0.00      0.00     0.00     0.01       3000
## paternal_loss3035          0.00      0.00    -0.01     0.00       3000
## paternal_loss3540          0.00      0.00    -0.01     0.00       3000
## paternal_loss4045         -0.01      0.00    -0.01     0.00       3000
## paternal_lossunclear      -0.06      0.00    -0.06    -0.05       3000
## maternal_loss01           -0.20      0.07    -0.34    -0.06       3000
## maternal_loss15           -0.06      0.03    -0.12    -0.01       3000
## maternal_loss510          -0.01      0.01    -0.04     0.02       3000
## maternal_loss1015         -0.01      0.01    -0.02     0.01       3000
## maternal_loss1520         -0.01      0.01    -0.02     0.01       3000
## maternal_loss2025          0.01      0.01     0.00     0.02       3000
## maternal_loss2530          0.00      0.00     0.00     0.01       3000
## maternal_loss3035          0.00      0.00     0.00     0.01       3000
## maternal_loss3540         -0.01      0.00    -0.01     0.00       3000
## maternal_loss4045          0.00      0.00    -0.01     0.00       3000
## maternal_lossunclear      -0.02      0.00    -0.02    -0.02       3000
## older_siblings            -0.01      0.00    -0.01    -0.01       3000
## nr.siblings                0.04      0.00     0.04     0.04       3000
## last_born1                 0.01      0.00     0.01     0.01       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings            1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-2" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.123</td>
<td align="center">2.104</td>
<td align="center">2.142</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9792</td>
<td align="center">0.9713</td>
<td align="center">0.9871</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.001</td>
<td align="center">0.9976</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.002</td>
<td align="center">0.9985</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.936</td>
<td align="center">0.9408</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.052</td>
<td align="center">1.047</td>
<td align="center">1.056</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9935</td>
<td align="center">0.9892</td>
<td align="center">0.9977</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9748</td>
<td align="center">0.9668</td>
<td align="center">0.9828</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.12</td>
<td align="center">1.01</td>
<td align="center">1.237</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.029</td>
<td align="center">0.9909</td>
<td align="center">1.067</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9811</td>
<td align="center">0.9648</td>
<td align="center">0.9981</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9946</td>
<td align="center">0.9846</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9953</td>
<td align="center">1.011</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9973</td>
<td align="center">0.9908</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1.002</td>
<td align="center">0.997</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9996</td>
<td align="center">0.9947</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9957</td>
<td align="center">0.9913</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9914</td>
<td align="center">0.9868</td>
<td align="center">0.996</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9451</td>
<td align="center">0.9419</td>
<td align="center">0.9484</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8192</td>
<td align="center">0.7137</td>
<td align="center">0.9402</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9424</td>
<td align="center">0.8892</td>
<td align="center">0.9945</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9889</td>
<td align="center">0.9628</td>
<td align="center">1.015</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9933</td>
<td align="center">0.9779</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9941</td>
<td align="center">0.9826</td>
<td align="center">1.006</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.008</td>
<td align="center">0.9978</td>
<td align="center">1.018</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.004</td>
<td align="center">0.9962</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.004</td>
<td align="center">0.9974</td>
<td align="center">1.012</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.995</td>
<td align="center">0.9889</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9986</td>
<td align="center">0.9932</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9795</td>
<td align="center">0.9765</td>
<td align="center">0.9825</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings</strong></td>
<td align="center">0.9899</td>
<td align="center">0.9871</td>
<td align="center">0.9927</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.043</td>
<td align="center">1.041</td>
<td align="center">1.044</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.009</td>
<td align="center">1.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-2" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.9</td>
<td align="center">[1.89;1.92]</td>
<td align="center">[1.89;1.91]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.86</td>
<td align="center">[1.85;1.87]</td>
<td align="center">[1.86;1.87]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-2.08</td>
<td align="center">[-2.87;-1.29]</td>
<td align="center">[-2.61;-1.56]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.98</td>
<td align="center">[0.97;0.99]</td>
<td align="center">[0.97;0.98]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-2" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-55-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-2" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-56-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-2" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-2" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-57-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-57-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-2" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-58-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-2" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-59-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-2" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-2" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r3_birth_order_continuous.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r3_birth_order_continuous.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r4_control_dependent_sibs" class="section level2 tab-content">
<h2><em>r4</em>: Control number of dependent siblings</h2>
<p>Birth order is usually used as a proxy variable for parental investment, the assumption being that older siblings require parental attention. However, there are are reasons to doubt this, as fully-grown siblings probably do not compete for the same resources. To compute a clearer proxy variable of competing siblings, we computed and adjusted for the number of siblings who were alive and younger than five at the time of birth of the anchor child.</p>
<div id="model-summary-3" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-3" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + nr.siblings + dependent_sibs_f5y + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1000; warmup = 500; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        453 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.75      0.01     0.72     0.78       3000
## paternalage               -0.04      0.01    -0.06    -0.03       3000
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.06      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.03     0.00       3000
## paternalage.mean          -0.01      0.01    -0.02     0.01       3000
## paternal_loss01            0.09      0.21    -0.36     0.48       3000
## paternal_loss15           -0.02      0.06    -0.14     0.10       3000
## paternal_loss510          -0.06      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.01       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.00       3000
## paternal_loss3035         -0.01      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.05       3000
## maternal_loss01           -0.27      0.20    -0.66     0.12       3000
## maternal_loss15           -0.07      0.09    -0.26     0.10       3000
## maternal_loss510           0.01      0.04    -0.08     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.02     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## nr.siblings                0.04      0.00     0.04     0.05       3000
## dependent_sibs_f5y        -0.01      0.00    -0.01     0.00       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## nr.siblings               1
## dependent_sibs_f5y        1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-3" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.115</td>
<td align="center">2.054</td>
<td align="center">2.176</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9603</td>
<td align="center">0.9463</td>
<td align="center">0.9744</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9951</td>
<td align="center">0.985</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9981</td>
<td align="center">0.9868</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9365</td>
<td align="center">0.9289</td>
<td align="center">0.9439</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.062</td>
<td align="center">1.047</td>
<td align="center">1.079</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9852</td>
<td align="center">0.9708</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9943</td>
<td align="center">0.9796</td>
<td align="center">1.01</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.092</td>
<td align="center">0.6978</td>
<td align="center">1.61</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9813</td>
<td align="center">0.8724</td>
<td align="center">1.103</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9465</td>
<td align="center">0.8918</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9812</td>
<td align="center">0.948</td>
<td align="center">1.015</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.003</td>
<td align="center">0.9758</td>
<td align="center">1.029</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.995</td>
<td align="center">0.974</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9861</td>
<td align="center">0.9678</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9944</td>
<td align="center">0.9778</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9943</td>
<td align="center">0.9798</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9861</td>
<td align="center">0.9721</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9448</td>
<td align="center">0.9345</td>
<td align="center">0.9556</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7647</td>
<td align="center">0.5154</td>
<td align="center">1.124</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9293</td>
<td align="center">0.7708</td>
<td align="center">1.11</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.007</td>
<td align="center">0.922</td>
<td align="center">1.097</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9823</td>
<td align="center">0.9321</td>
<td align="center">1.037</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9903</td>
<td align="center">0.9522</td>
<td align="center">1.028</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.024</td>
<td align="center">0.9911</td>
<td align="center">1.058</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">0.9988</td>
<td align="center">0.9722</td>
<td align="center">1.027</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">0.9997</td>
<td align="center">0.9765</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.003</td>
<td align="center">0.9832</td>
<td align="center">1.023</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9953</td>
<td align="center">0.9782</td>
<td align="center">1.013</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9815</td>
<td align="center">0.9721</td>
<td align="center">0.9916</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.043</td>
<td align="center">1.039</td>
<td align="center">1.047</td>
</tr>
<tr class="even">
<td align="center"><strong>dependent_sibs_f5y</strong></td>
<td align="center">0.9927</td>
<td align="center">0.9865</td>
<td align="center">0.9989</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-3" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.94</td>
<td align="center">[1.92;1.97]</td>
<td align="center">[1.93;1.96]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.87</td>
<td align="center">[1.84;1.89]</td>
<td align="center">[1.85;1.88]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-3.97</td>
<td align="center">[-5.37;-2.56]</td>
<td align="center">[-4.89;-3.06]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.96</td>
<td align="center">[0.95;0.97]</td>
<td align="center">[0.95;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-3" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-66-9.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-3" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-67-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-3" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-3" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-68-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-68-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-3" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-69-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-3" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-70-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-3" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-3" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r4_control_dependent_sibs.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r4_control_dependent_sibs.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r5_birth_order_interact_siblings" class="section level2 tab-content">
<h2><em>r5</em>: Birth order interacted with number of siblings</h2>
<p>Plausibly, being first-born has a different effect, when one is an only child as opposed to having two siblings, etc. Here, we allow for such an interaction effect.</p>
<div id="model-summary-4" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-4" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 3 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings * nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        438    1
## 
## Population-Level Effects: 
##                              Estimate Est.Error l-95% CI u-95% CI
## Intercept                        0.72      0.02     0.69     0.75
## paternalage                     -0.05      0.01    -0.07    -0.02
## birth_cohort1950M1955            0.00      0.01    -0.02     0.01
## birth_cohort1955M1960            0.00      0.01    -0.01     0.01
## male1                           -0.07      0.00    -0.07    -0.06
## maternalage.factor1420           0.07      0.01     0.05     0.08
## maternalage.factor3561          -0.01      0.01    -0.02     0.01
## paternalage.mean                 0.00      0.01    -0.03     0.03
## paternal_loss01                  0.09      0.22    -0.36     0.51
## paternal_loss15                 -0.02      0.06    -0.14     0.10
## paternal_loss510                -0.05      0.03    -0.11     0.00
## paternal_loss1015               -0.02      0.02    -0.05     0.02
## paternal_loss1520                0.00      0.01    -0.02     0.03
## paternal_loss2025                0.00      0.01    -0.03     0.02
## paternal_loss2530               -0.01      0.01    -0.03     0.01
## paternal_loss3035               -0.01      0.01    -0.02     0.01
## paternal_loss3540               -0.01      0.01    -0.02     0.01
## paternal_loss4045               -0.01      0.01    -0.03     0.00
## paternal_lossunclear            -0.06      0.01    -0.07    -0.05
## maternal_loss01                 -0.26      0.21    -0.68     0.12
## maternal_loss15                 -0.06      0.09    -0.25     0.12
## maternal_loss510                 0.01      0.04    -0.07     0.10
## maternal_loss1015               -0.01      0.03    -0.07     0.04
## maternal_loss1520               -0.01      0.02    -0.05     0.03
## maternal_loss2025                0.03      0.02    -0.01     0.06
## maternal_loss2530                0.00      0.01    -0.03     0.03
## maternal_loss3035                0.00      0.01    -0.02     0.02
## maternal_loss3540                0.01      0.01    -0.01     0.02
## maternal_loss4045                0.00      0.01    -0.02     0.01
## maternal_lossunclear            -0.02      0.01    -0.03    -0.01
## older_siblings1                  0.03      0.01     0.01     0.05
## older_siblings2                  0.07      0.02     0.03     0.10
## older_siblings3                  0.06      0.03     0.00     0.12
## older_siblings4                  0.08      0.06    -0.03     0.19
## older_siblings5P                 0.11      0.06     0.00     0.22
## nr.siblings                      0.05      0.00     0.04     0.05
## last_born1                       0.01      0.00     0.00     0.02
## older_siblings1:nr.siblings     -0.01      0.00    -0.02     0.00
## older_siblings2:nr.siblings     -0.02      0.01    -0.03    -0.01
## older_siblings3:nr.siblings     -0.01      0.01    -0.03     0.00
## older_siblings4:nr.siblings     -0.02      0.01    -0.04     0.00
## older_siblings5P:nr.siblings    -0.03      0.01    -0.05    -0.01
##                              Eff.Sample Rhat
## Intercept                          3000    1
## paternalage                        3000    1
## birth_cohort1950M1955              3000    1
## birth_cohort1955M1960              3000    1
## male1                              2879    1
## maternalage.factor1420             3000    1
## maternalage.factor3561             3000    1
## paternalage.mean                   3000    1
## paternal_loss01                    3000    1
## paternal_loss15                    3000    1
## paternal_loss510                   3000    1
## paternal_loss1015                  3000    1
## paternal_loss1520                  3000    1
## paternal_loss2025                  3000    1
## paternal_loss2530                  3000    1
## paternal_loss3035                  3000    1
## paternal_loss3540                  3000    1
## paternal_loss4045                  3000    1
## paternal_lossunclear               3000    1
## maternal_loss01                    3000    1
## maternal_loss15                    3000    1
## maternal_loss510                   3000    1
## maternal_loss1015                  3000    1
## maternal_loss1520                  3000    1
## maternal_loss2025                  3000    1
## maternal_loss2530                  3000    1
## maternal_loss3035                  3000    1
## maternal_loss3540                  3000    1
## maternal_loss4045                  3000    1
## maternal_lossunclear               3000    1
## older_siblings1                    3000    1
## older_siblings2                    3000    1
## older_siblings3                    3000    1
## older_siblings4                    3000    1
## older_siblings5P                   3000    1
## nr.siblings                        3000    1
## last_born1                         3000    1
## older_siblings1:nr.siblings        3000    1
## older_siblings2:nr.siblings        3000    1
## older_siblings3:nr.siblings        3000    1
## older_siblings4:nr.siblings        3000    1
## older_siblings5P:nr.siblings       3000    1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-4" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="40%" />
<col width="22%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.056</td>
<td align="center">1.994</td>
<td align="center">2.117</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9548</td>
<td align="center">0.9295</td>
<td align="center">0.9815</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9952</td>
<td align="center">0.9848</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9972</td>
<td align="center">0.9862</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9365</td>
<td align="center">0.9289</td>
<td align="center">0.9442</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.068</td>
<td align="center">1.051</td>
<td align="center">1.084</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9917</td>
<td align="center">0.9767</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1</td>
<td align="center">0.9736</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.096</td>
<td align="center">0.699</td>
<td align="center">1.667</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9833</td>
<td align="center">0.8713</td>
<td align="center">1.106</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9488</td>
<td align="center">0.8964</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9824</td>
<td align="center">0.9467</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9789</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.996</td>
<td align="center">0.9749</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9874</td>
<td align="center">0.9691</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9949</td>
<td align="center">0.9779</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9945</td>
<td align="center">0.9803</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9864</td>
<td align="center">0.9717</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9456</td>
<td align="center">0.9351</td>
<td align="center">0.9559</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7733</td>
<td align="center">0.5056</td>
<td align="center">1.125</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9403</td>
<td align="center">0.7772</td>
<td align="center">1.124</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.013</td>
<td align="center">0.9314</td>
<td align="center">1.1</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9852</td>
<td align="center">0.9349</td>
<td align="center">1.039</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9931</td>
<td align="center">0.9553</td>
<td align="center">1.032</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.026</td>
<td align="center">0.9917</td>
<td align="center">1.062</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.001</td>
<td align="center">0.9721</td>
<td align="center">1.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9789</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9859</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9963</td>
<td align="center">0.9775</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9815</td>
<td align="center">0.9714</td>
<td align="center">0.9918</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.03</td>
<td align="center">1.011</td>
<td align="center">1.051</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.068</td>
<td align="center">1.029</td>
<td align="center">1.108</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.062</td>
<td align="center">0.9988</td>
<td align="center">1.133</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.084</td>
<td align="center">0.9688</td>
<td align="center">1.212</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">1.117</td>
<td align="center">0.9954</td>
<td align="center">1.249</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.049</td>
<td align="center">1.042</td>
<td align="center">1.056</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.013</td>
<td align="center">1.004</td>
<td align="center">1.022</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1:nr.siblings</strong></td>
<td align="center">0.9892</td>
<td align="center">0.9811</td>
<td align="center">0.9975</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2:nr.siblings</strong></td>
<td align="center">0.9794</td>
<td align="center">0.9685</td>
<td align="center">0.9903</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3:nr.siblings</strong></td>
<td align="center">0.9869</td>
<td align="center">0.9719</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4:nr.siblings</strong></td>
<td align="center">0.9787</td>
<td align="center">0.957</td>
<td align="center">1.001</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P:nr.siblings</strong></td>
<td align="center">0.9691</td>
<td align="center">0.953</td>
<td align="center">0.9852</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-4" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.92</td>
<td align="center">[1.89;1.96]</td>
<td align="center">[1.9;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.8;1.87]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.52</td>
<td align="center">[-7.05;-1.85]</td>
<td align="center">[-6.24;-2.76]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-4" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-10.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-77-11.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-4" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-78-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-4" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-4" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-79-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-79-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-4" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-80-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-4" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-81-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-4" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-4" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r5_birth_order_interact_siblings.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r5_birth_order_interact_siblings.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r6_no_birth_order_control" class="section level2 tab-content">
<h2><em>r6</em>: No birth order control</h2>
<p>Paternal age and birth order are highly collinear with each other and with maternal age. Therefore, the choice to include this predictor widens standard errors for each predictor and may be disputed. Here we show what happens when we simply omit the birth order control.</p>
<div id="model-summary-5" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-5" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 20 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + nr.siblings + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.03        283 1.04
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.75      0.01     0.72     0.77       3000
## paternalage               -0.04      0.01    -0.05    -0.02       3000
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       2587
## maternalage.factor1420     0.06      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.03     0.00       3000
## paternalage.mean          -0.01      0.01    -0.02     0.01       3000
## paternal_loss01            0.08      0.23    -0.38     0.49       3000
## paternal_loss15           -0.02      0.06    -0.13     0.09       3000
## paternal_loss510          -0.06      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.06     0.02       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025         -0.01      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.00       3000
## paternal_loss3035         -0.01      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.05       3000
## maternal_loss01           -0.27      0.21    -0.70     0.12       3000
## maternal_loss15           -0.07      0.09    -0.26     0.10       3000
## maternal_loss510           0.01      0.04    -0.08     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.02     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## nr.siblings                0.04      0.00     0.04     0.04       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## nr.siblings               1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-5" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.107</td>
<td align="center">2.048</td>
<td align="center">2.167</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9629</td>
<td align="center">0.9487</td>
<td align="center">0.9771</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9954</td>
<td align="center">0.9849</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9983</td>
<td align="center">0.9866</td>
<td align="center">1.01</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9365</td>
<td align="center">0.9288</td>
<td align="center">0.9444</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.064</td>
<td align="center">1.048</td>
<td align="center">1.08</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9876</td>
<td align="center">0.9731</td>
<td align="center">1.002</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9922</td>
<td align="center">0.9775</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.087</td>
<td align="center">0.6805</td>
<td align="center">1.633</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9797</td>
<td align="center">0.8764</td>
<td align="center">1.094</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9464</td>
<td align="center">0.8963</td>
<td align="center">0.9994</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9808</td>
<td align="center">0.9462</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.003</td>
<td align="center">0.9772</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9947</td>
<td align="center">0.9747</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9862</td>
<td align="center">0.9675</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9945</td>
<td align="center">0.9783</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9943</td>
<td align="center">0.9797</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9861</td>
<td align="center">0.9715</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9449</td>
<td align="center">0.9347</td>
<td align="center">0.9554</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7639</td>
<td align="center">0.4986</td>
<td align="center">1.127</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9291</td>
<td align="center">0.7718</td>
<td align="center">1.108</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.007</td>
<td align="center">0.9253</td>
<td align="center">1.096</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9829</td>
<td align="center">0.9327</td>
<td align="center">1.036</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9906</td>
<td align="center">0.9506</td>
<td align="center">1.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.024</td>
<td align="center">0.9918</td>
<td align="center">1.057</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">0.9992</td>
<td align="center">0.9716</td>
<td align="center">1.027</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">0.9996</td>
<td align="center">0.9766</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.003</td>
<td align="center">0.9842</td>
<td align="center">1.023</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9954</td>
<td align="center">0.9765</td>
<td align="center">1.013</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9814</td>
<td align="center">0.9714</td>
<td align="center">0.9915</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.037</td>
<td align="center">1.042</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-5" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.94</td>
<td align="center">[1.92;1.97]</td>
<td align="center">[1.93;1.96]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.87</td>
<td align="center">[1.85;1.9]</td>
<td align="center">[1.86;1.89]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-3.7</td>
<td align="center">[-5.13;-2.29]</td>
<td align="center">[-4.64;-2.79]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.96</td>
<td align="center">[0.95;0.98]</td>
<td align="center">[0.95;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-5" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-88-8.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-5" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-89-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-5" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-5" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-90-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-90-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-5" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-91-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-5" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-92-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-5" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-5" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r6_no_birth_order_control.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r6_no_birth_order_control.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r7_less_parental_loss_control" class="section level2 tab-content">
<h2><em>r7</em>: Less control for parental loss</h2>
<p>We adjusted for parental loss very stringently, including covariates for parental loss up to age 45. Here we show what happens, when we only control for parental loss in the first, and the first five years of life.</p>
<div id="model-summary-6" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-6" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1000; warmup = 500; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.03        186 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.65      0.11     0.43     0.86       2607
## paternalage               -0.05      0.01    -0.07    -0.02       1326
## birth_cohort1950M1955     -0.01      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.07      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.00      0.01    -0.02     0.03       1301
## paternal_loss01            0.10      0.22    -0.35     0.52       3000
## paternal_losslater         0.01      0.06    -0.10     0.13       3000
## paternal_lossunclear      -0.04      0.06    -0.15     0.08       3000
## maternal_loss01           -0.20      0.23    -0.64     0.23       3000
## maternal_losslater         0.07      0.09    -0.11     0.26       2591
## maternal_lossunclear       0.05      0.09    -0.13     0.24       2614
## older_siblings1            0.02      0.01     0.00     0.03       1565
## older_siblings2            0.02      0.01     0.00     0.05       1250
## older_siblings3            0.03      0.02     0.00     0.07       1368
## older_siblings4            0.01      0.02    -0.03     0.05       1543
## older_siblings5P          -0.06      0.03    -0.11     0.00       1475
## nr.siblings                0.04      0.00     0.03     0.04       1397
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept              1.00
## paternalage            1.00
## birth_cohort1950M1955  1.00
## birth_cohort1955M1960  1.00
## male1                  1.00
## maternalage.factor1420 1.00
## maternalage.factor3561 1.00
## paternalage.mean       1.00
## paternal_loss01        1.00
## paternal_losslater     1.00
## paternal_lossunclear   1.00
## maternal_loss01        1.00
## maternal_losslater     1.00
## maternal_lossunclear   1.00
## older_siblings1        1.00
## older_siblings2        1.00
## older_siblings3        1.00
## older_siblings4        1.00
## older_siblings5P       1.00
## nr.siblings            1.01
## last_born1             1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-6" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">1.919</td>
<td align="center">1.536</td>
<td align="center">2.363</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9521</td>
<td align="center">0.9279</td>
<td align="center">0.9781</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9948</td>
<td align="center">0.9846</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9966</td>
<td align="center">0.986</td>
<td align="center">1.007</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9365</td>
<td align="center">0.9289</td>
<td align="center">0.9441</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.07</td>
<td align="center">1.054</td>
<td align="center">1.087</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9932</td>
<td align="center">0.9787</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.002</td>
<td align="center">0.9762</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.11</td>
<td align="center">0.702</td>
<td align="center">1.685</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_losslater</strong></td>
<td align="center">1.011</td>
<td align="center">0.9064</td>
<td align="center">1.136</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9606</td>
<td align="center">0.8601</td>
<td align="center">1.079</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8219</td>
<td align="center">0.5254</td>
<td align="center">1.265</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_losslater</strong></td>
<td align="center">1.069</td>
<td align="center">0.8986</td>
<td align="center">1.297</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">1.049</td>
<td align="center">0.8801</td>
<td align="center">1.272</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.003</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.024</td>
<td align="center">1.001</td>
<td align="center">1.046</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.034</td>
<td align="center">1.001</td>
<td align="center">1.068</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.008</td>
<td align="center">0.9661</td>
<td align="center">1.053</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9439</td>
<td align="center">0.8915</td>
<td align="center">0.9985</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.035</td>
<td align="center">1.045</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-6" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.92</td>
<td align="center">[1.89;1.95]</td>
<td align="center">[1.9;1.94]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.83</td>
<td align="center">[1.8;1.87]</td>
<td align="center">[1.81;1.85]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.84</td>
<td align="center">[-7.21;-2.19]</td>
<td align="center">[-6.39;-3.09]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-6" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-99-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-6" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-100-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-6" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-6" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-101-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-101-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-6" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-102-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-6" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-103-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-6" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-6" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r7_less_parental_loss_control.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r7_less_parental_loss_control.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r8_adjust_for_first_born_adult" class="section level2 tab-content">
<h2><em>r8</em>: Adjust for being first-/last-born adult son</h2>
<p>Inheritance is linked to birth order and being male in several of the historical populations. Here, we adjust for the anchor being the first or last born adult son in a family. This implies that we control for our outcome to a certain extent, as “adult sons” cannot have died before adulthood, but a paternal age effect on mortality could still be detected for siblings other than the first- and last-born adults.</p>
<div id="model-summary-7" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-7" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth.cohort + first_born_adult_male + last_born_adult_male + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        432 1.01
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.74      0.01     0.71     0.77       3000
## paternalage               -0.05      0.01    -0.07    -0.02       1439
## birth.cohort1950M1955     -0.01      0.01    -0.02     0.00       3000
## birth.cohort1955M1960     -0.01      0.01    -0.02     0.00       3000
## first_born_adult_male     -0.18      0.06    -0.29    -0.07       3000
## last_born_adult_male      -0.17      0.06    -0.28    -0.05       3000
## male1                     -0.05      0.00    -0.06    -0.04       3000
## maternalage.factor1420     0.07      0.01     0.06     0.09       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.00      0.01    -0.02     0.03       1472
## paternal_loss01            0.08      0.21    -0.34     0.47       3000
## paternal_loss15           -0.02      0.06    -0.14     0.10       3000
## paternal_loss510          -0.05      0.03    -0.11     0.01       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.01      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.02     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.01       3000
## paternal_loss3035          0.00      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.05       3000
## maternal_loss01           -0.23      0.21    -0.65     0.15       3000
## maternal_loss15           -0.05      0.09    -0.24     0.12       3000
## maternal_loss510           0.01      0.04    -0.07     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.02     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.01      0.01    -0.01     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.02      0.01     0.00     0.03       1944
## older_siblings2            0.02      0.01     0.00     0.05       1480
## older_siblings3            0.03      0.02     0.00     0.07       1383
## older_siblings4            0.01      0.02    -0.03     0.05       1591
## older_siblings5P          -0.06      0.03    -0.11     0.00       1779
## nr.siblings                0.04      0.00     0.03     0.04       1665
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth.cohort1950M1955     1
## birth.cohort1955M1960     1
## first_born_adult_male     1
## last_born_adult_male      1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-7" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.094</td>
<td align="center">2.034</td>
<td align="center">2.153</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9519</td>
<td align="center">0.928</td>
<td align="center">0.9758</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth.cohort1950M1955</strong></td>
<td align="center">0.9923</td>
<td align="center">0.9819</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>birth.cohort1955M1960</strong></td>
<td align="center">0.9925</td>
<td align="center">0.9812</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>first_born_adult_male</strong></td>
<td align="center">0.834</td>
<td align="center">0.7457</td>
<td align="center">0.9284</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born_adult_male</strong></td>
<td align="center">0.8453</td>
<td align="center">0.7568</td>
<td align="center">0.947</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.954</td>
<td align="center">0.9465</td>
<td align="center">0.9615</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.073</td>
<td align="center">1.057</td>
<td align="center">1.09</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9935</td>
<td align="center">0.9791</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.002</td>
<td align="center">0.9767</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.084</td>
<td align="center">0.7115</td>
<td align="center">1.605</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9833</td>
<td align="center">0.8704</td>
<td align="center">1.105</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9499</td>
<td align="center">0.8977</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9819</td>
<td align="center">0.9479</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.006</td>
<td align="center">0.9788</td>
<td align="center">1.034</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9972</td>
<td align="center">0.9766</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9879</td>
<td align="center">0.9696</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9952</td>
<td align="center">0.9788</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9949</td>
<td align="center">0.9799</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9877</td>
<td align="center">0.9731</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9444</td>
<td align="center">0.9337</td>
<td align="center">0.9549</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7915</td>
<td align="center">0.5222</td>
<td align="center">1.158</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9481</td>
<td align="center">0.7891</td>
<td align="center">1.13</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.013</td>
<td align="center">0.9336</td>
<td align="center">1.099</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.985</td>
<td align="center">0.933</td>
<td align="center">1.039</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9946</td>
<td align="center">0.956</td>
<td align="center">1.033</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.024</td>
<td align="center">0.9913</td>
<td align="center">1.059</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.004</td>
<td align="center">0.9768</td>
<td align="center">1.031</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.002</td>
<td align="center">0.98</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9863</td>
<td align="center">1.025</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9971</td>
<td align="center">0.9791</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9797</td>
<td align="center">0.9696</td>
<td align="center">0.9896</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.004</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.025</td>
<td align="center">1.003</td>
<td align="center">1.048</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.035</td>
<td align="center">1.003</td>
<td align="center">1.069</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.01</td>
<td align="center">0.9687</td>
<td align="center">1.055</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9457</td>
<td align="center">0.8945</td>
<td align="center">0.9999</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.034</td>
<td align="center">1.045</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.01</td>
<td align="center">1.001</td>
<td align="center">1.019</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-7" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:89%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.9</td>
<td align="center">[1.87;1.93]</td>
<td align="center">[1.88;1.92]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.81</td>
<td align="center">[1.77;1.84]</td>
<td align="center">[1.79;1.83]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.8</td>
<td align="center">[-7.2;-2.42]</td>
<td align="center">[-6.44;-3.18]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-7" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-10.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-11.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-110-12.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-7" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-111-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-7" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-7" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-112-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-112-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-7" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-113-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-7" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-114-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-7" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-7" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r8_adjust_for_first_born_adult.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r8_adjust_for_first_born_adult.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r9_continuous_byear_adjustment" class="section level2 tab-content">
<h2><em>r9</em>: Continuous birth year adjustment</h2>
<p>In our main model, we control for birth cohort in 5-year-bins (lumping small bins). We chose to do so, because nonlinear and even sharply spiking effects of birth cohort are plausible (due to e.g. epidemics). This decision may be disputed, as it summarises 5-year-bins. Here, we instead allow for a thin-splate spline on the continuous birth year variable. This allows for smooth nonlinear (but not spiking) birth cohort effects.</p>
<div id="model-summary-8" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-8" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 31 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + s(byear) + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1500; warmup = 1000; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## sds ~ student_t(3, 0, 10)
## 
## Smooth Terms: 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sds(sbyear_1)     0.03      0.02        0     0.09        738    1
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        251 1.01
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.01     0.70     0.76       3000
## paternalage               -0.05      0.01    -0.08    -0.02        620
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.07      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.00      0.01    -0.03     0.03        622
## paternal_loss01            0.10      0.23    -0.36     0.51       3000
## paternal_loss15           -0.02      0.06    -0.14     0.10       3000
## paternal_loss510          -0.05      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.01       3000
## paternal_loss3035          0.00      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.26      0.21    -0.68     0.14       3000
## maternal_loss15           -0.06      0.09    -0.25     0.11       3000
## maternal_loss510           0.01      0.04    -0.07     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.01     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.02      0.01     0.00     0.03        746
## older_siblings2            0.02      0.01     0.00     0.05        618
## older_siblings3            0.03      0.02     0.00     0.07        676
## older_siblings4            0.01      0.02    -0.04     0.05        669
## older_siblings5P          -0.06      0.03    -0.12     0.00        683
## nr.siblings                0.04      0.00     0.03     0.04        646
## last_born1                 0.01      0.00     0.00     0.02       3000
## sbyear_1                  -0.01      0.01    -0.03     0.02       1042
##                        Rhat
## Intercept              1.00
## paternalage            1.01
## male1                  1.00
## maternalage.factor1420 1.00
## maternalage.factor3561 1.00
## paternalage.mean       1.01
## paternal_loss01        1.00
## paternal_loss15        1.00
## paternal_loss510       1.00
## paternal_loss1015      1.00
## paternal_loss1520      1.00
## paternal_loss2025      1.00
## paternal_loss2530      1.00
## paternal_loss3035      1.00
## paternal_loss3540      1.00
## paternal_loss4045      1.00
## paternal_lossunclear   1.00
## maternal_loss01        1.00
## maternal_loss15        1.00
## maternal_loss510       1.00
## maternal_loss1015      1.00
## maternal_loss1520      1.00
## maternal_loss2025      1.00
## maternal_loss2530      1.00
## maternal_loss3035      1.00
## maternal_loss3540      1.00
## maternal_loss4045      1.00
## maternal_lossunclear   1.00
## older_siblings1        1.01
## older_siblings2        1.01
## older_siblings3        1.01
## older_siblings4        1.01
## older_siblings5P       1.01
## nr.siblings            1.01
## last_born1             1.00
## sbyear_1               1.01
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-8" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.07</td>
<td align="center">2.012</td>
<td align="center">2.128</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9538</td>
<td align="center">0.9276</td>
<td align="center">0.9802</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9364</td>
<td align="center">0.9287</td>
<td align="center">0.9442</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.071</td>
<td align="center">1.055</td>
<td align="center">1.087</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9935</td>
<td align="center">0.9792</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.002</td>
<td align="center">0.9736</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.101</td>
<td align="center">0.6954</td>
<td align="center">1.666</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9846</td>
<td align="center">0.8717</td>
<td align="center">1.107</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9491</td>
<td align="center">0.8977</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9823</td>
<td align="center">0.9486</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9768</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9963</td>
<td align="center">0.9751</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9873</td>
<td align="center">0.9689</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9954</td>
<td align="center">0.9793</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9948</td>
<td align="center">0.9803</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9866</td>
<td align="center">0.9721</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9464</td>
<td align="center">0.936</td>
<td align="center">0.9568</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7718</td>
<td align="center">0.5069</td>
<td align="center">1.145</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9378</td>
<td align="center">0.7772</td>
<td align="center">1.121</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.01</td>
<td align="center">0.9286</td>
<td align="center">1.094</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9841</td>
<td align="center">0.933</td>
<td align="center">1.037</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9927</td>
<td align="center">0.9554</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.025</td>
<td align="center">0.9919</td>
<td align="center">1.059</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1</td>
<td align="center">0.9736</td>
<td align="center">1.028</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9777</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.986</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9962</td>
<td align="center">0.9779</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9817</td>
<td align="center">0.972</td>
<td align="center">0.9918</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.003</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.024</td>
<td align="center">1.001</td>
<td align="center">1.048</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.034</td>
<td align="center">1.001</td>
<td align="center">1.068</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.008</td>
<td align="center">0.9629</td>
<td align="center">1.053</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9438</td>
<td align="center">0.8912</td>
<td align="center">1.002</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.034</td>
<td align="center">1.045</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.02</td>
</tr>
<tr class="even">
<td align="center"><strong>sbyear_1</strong></td>
<td align="center">0.9933</td>
<td align="center">0.9662</td>
<td align="center">1.015</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-8" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.92</td>
<td align="center">[1.89;1.95]</td>
<td align="center">[1.9;1.94]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.83</td>
<td align="center">[1.79;1.87]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.6</td>
<td align="center">[-7.24;-1.98]</td>
<td align="center">[-6.31;-2.93]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-8" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-121-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-8" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-122-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-8" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-8" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-123-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-123-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-8" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-124-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-8" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-125-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-8" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-8" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r9_continuous_byear_adjustment.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r9_continuous_byear_adjustment.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r10_add_random_slope" class="section level2 tab-content">
<h2><em>r10</em>: Group-level slope added</h2>
<p>Paternal age effects may vary between different families. Although we did not explore between-family moderators of paternal age effects in our study, we tested whether modelling an additional group-level slope for paternal age differences within the family, would change the results by allowing for shrinkage and to examine the amount of inter-family differences to be explained for potential future moderator analysis.</p>
<div id="model-summary-9" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-9" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 164 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 + paternalage | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 3500; warmup = 1500; thin = 5; 
##          total post-warmup samples = 2400
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## L ~ lkj_corr_cholesky(1)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##                            Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## sd(Intercept)                  0.02      0.01     0.00     0.05        310
## sd(paternalage)                0.01      0.00     0.00     0.02        175
## cor(Intercept,paternalage)    -0.38      0.55    -0.99     0.86        494
##                            Rhat
## sd(Intercept)              1.02
## sd(paternalage)            1.04
## cor(Intercept,paternalage) 1.01
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.01     0.70     0.76       1802
## paternalage               -0.05      0.01    -0.07    -0.02       1291
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       1106
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       1265
## male1                     -0.07      0.00    -0.07    -0.06        808
## maternalage.factor1420     0.07      0.01     0.05     0.08        843
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       1809
## paternalage.mean           0.00      0.01    -0.03     0.03       1264
## paternal_loss01            0.08      0.22    -0.35     0.47       1611
## paternal_loss15           -0.02      0.06    -0.14     0.09       1591
## paternal_loss510          -0.05      0.03    -0.11     0.01       1564
## paternal_loss1015         -0.02      0.02    -0.05     0.02       1532
## paternal_loss1520          0.00      0.01    -0.02     0.03       1550
## paternal_loss2025          0.00      0.01    -0.02     0.02       1680
## paternal_loss2530         -0.01      0.01    -0.03     0.00       1188
## paternal_loss3035          0.00      0.01    -0.02     0.01        977
## paternal_loss3540         -0.01      0.01    -0.02     0.01       1845
## paternal_loss4045         -0.01      0.01    -0.03     0.00       1666
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       2039
## maternal_loss01           -0.26      0.21    -0.69     0.15       1130
## maternal_loss15           -0.07      0.09    -0.24     0.10       1841
## maternal_loss510           0.01      0.04    -0.07     0.09       2239
## maternal_loss1015         -0.02      0.03    -0.07     0.04       1545
## maternal_loss1520         -0.01      0.02    -0.05     0.03       1669
## maternal_loss2025          0.03      0.02    -0.01     0.06       1895
## maternal_loss2530          0.00      0.01    -0.03     0.03       1836
## maternal_loss3035          0.00      0.01    -0.02     0.02       1839
## maternal_loss3540          0.00      0.01    -0.01     0.02       1912
## maternal_loss4045          0.00      0.01    -0.02     0.01       1032
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01        856
## older_siblings1            0.02      0.01     0.00     0.03        907
## older_siblings2            0.02      0.01     0.00     0.05       1082
## older_siblings3            0.03      0.02     0.00     0.07       1184
## older_siblings4            0.01      0.02    -0.04     0.05       1469
## older_siblings5P          -0.06      0.03    -0.11     0.00       1450
## nr.siblings                0.04      0.00     0.03     0.04       1432
## last_born1                 0.01      0.00     0.00     0.02       1674
##                        Rhat
## Intercept              1.00
## paternalage            1.00
## birth_cohort1950M1955  1.00
## birth_cohort1955M1960  1.00
## male1                  1.00
## maternalage.factor1420 1.01
## maternalage.factor3561 1.00
## paternalage.mean       1.00
## paternal_loss01        1.00
## paternal_loss15        1.00
## paternal_loss510       1.00
## paternal_loss1015      1.00
## paternal_loss1520      1.00
## paternal_loss2025      1.00
## paternal_loss2530      1.00
## paternal_loss3035      1.00
## paternal_loss3540      1.00
## paternal_loss4045      1.00
## paternal_lossunclear   1.00
## maternal_loss01        1.00
## maternal_loss15        1.00
## maternal_loss510       1.00
## maternal_loss1015      1.00
## maternal_loss1520      1.00
## maternal_loss2025      1.00
## maternal_loss2530      1.00
## maternal_loss3035      1.00
## maternal_loss3540      1.00
## maternal_loss4045      1.00
## maternal_lossunclear   1.00
## older_siblings1        1.01
## older_siblings2        1.01
## older_siblings3        1.00
## older_siblings4        1.00
## older_siblings5P       1.00
## nr.siblings            1.00
## last_born1             1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-9" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.076</td>
<td align="center">2.021</td>
<td align="center">2.138</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9538</td>
<td align="center">0.9285</td>
<td align="center">0.9789</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9953</td>
<td align="center">0.9847</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9975</td>
<td align="center">0.9861</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9366</td>
<td align="center">0.9288</td>
<td align="center">0.9445</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.071</td>
<td align="center">1.055</td>
<td align="center">1.087</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9935</td>
<td align="center">0.9789</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.001</td>
<td align="center">0.9747</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.084</td>
<td align="center">0.7042</td>
<td align="center">1.596</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9838</td>
<td align="center">0.8732</td>
<td align="center">1.1</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.951</td>
<td align="center">0.8977</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9819</td>
<td align="center">0.9483</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9771</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.996</td>
<td align="center">0.9757</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9869</td>
<td align="center">0.9697</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9951</td>
<td align="center">0.979</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9944</td>
<td align="center">0.9798</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9864</td>
<td align="center">0.9714</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.946</td>
<td align="center">0.9356</td>
<td align="center">0.956</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7741</td>
<td align="center">0.5016</td>
<td align="center">1.166</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9369</td>
<td align="center">0.7835</td>
<td align="center">1.11</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.012</td>
<td align="center">0.9317</td>
<td align="center">1.097</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9843</td>
<td align="center">0.9316</td>
<td align="center">1.04</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9922</td>
<td align="center">0.9548</td>
<td align="center">1.032</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.025</td>
<td align="center">0.9928</td>
<td align="center">1.058</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1</td>
<td align="center">0.9725</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9785</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9854</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9792</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9815</td>
<td align="center">0.9715</td>
<td align="center">0.9913</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.003</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.023</td>
<td align="center">1.001</td>
<td align="center">1.047</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.033</td>
<td align="center">1.001</td>
<td align="center">1.067</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.008</td>
<td align="center">0.9641</td>
<td align="center">1.051</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9437</td>
<td align="center">0.8923</td>
<td align="center">0.9971</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.035</td>
<td align="center">1.045</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-9" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.9;1.96]</td>
<td align="center">[1.91;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.8;1.88]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.57</td>
<td align="center">[-7.15;-2.11]</td>
<td align="center">[-6.31;-2.92]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-9" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-132-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-9" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-133-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-9" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-9" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-134-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-134-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-9" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-135-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-9" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-136-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-9" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-9" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r10_add_random_slope.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r10_add_random_slope.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r11_separate_random_effects_for_parents" class="section level2 tab-content">
<h2><em>r11</em>: Separate group-level effects for each parent</h2>
<p>Most anchors in our sample are full biological siblings and especially in the historical populations, divorce and remarriage was rare. Therefore, we chose to include only one group-level effect, for the parent couple (i.e. one group-level effect per father-mother-dyad). Including one intercept per parent is potentially a better way to adjust for genetic propensities inherited from either parent and allows estimating this propensity also from half-siblings, while half-sibling relationships were ignored in our main models. This comes at the cost of modelling complexity.</p>
<div id="model-summary-10" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-10" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idMere) + (1 | idPere) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 10000; warmup = 4000; thin = 5; 
##          total post-warmup samples = 7200
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idMere (Number of levels: 79781) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.03       3611    1
## 
## ~idPere (Number of levels: 79757) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.03       3490    1
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.01     0.70     0.76       7200
## paternalage               -0.05      0.01    -0.07    -0.02       6992
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       7200
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       7200
## male1                     -0.07      0.00    -0.07    -0.06       7200
## maternalage.factor1420     0.07      0.01     0.05     0.08       7200
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       6991
## paternalage.mean           0.00      0.01    -0.03     0.03       6813
## paternal_loss01            0.09      0.22    -0.37     0.50       7200
## paternal_loss15           -0.02      0.06    -0.13     0.10       7200
## paternal_loss510          -0.05      0.03    -0.11     0.00       7200
## paternal_loss1015         -0.02      0.02    -0.05     0.02       7200
## paternal_loss1520          0.00      0.01    -0.02     0.03       7200
## paternal_loss2025          0.00      0.01    -0.03     0.02       7200
## paternal_loss2530         -0.01      0.01    -0.03     0.01       7200
## paternal_loss3035          0.00      0.01    -0.02     0.01       7200
## paternal_loss3540         -0.01      0.01    -0.02     0.01       7200
## paternal_loss4045         -0.01      0.01    -0.03     0.00       7200
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       7200
## maternal_loss01           -0.26      0.21    -0.69     0.12       7200
## maternal_loss15           -0.07      0.09    -0.25     0.12       7200
## maternal_loss510           0.01      0.04    -0.07     0.09       7200
## maternal_loss1015         -0.02      0.03    -0.07     0.04       7200
## maternal_loss1520         -0.01      0.02    -0.05     0.03       7200
## maternal_loss2025          0.02      0.02    -0.01     0.06       7200
## maternal_loss2530          0.00      0.01    -0.03     0.03       7200
## maternal_loss3035          0.00      0.01    -0.02     0.02       7200
## maternal_loss3540          0.00      0.01    -0.01     0.02       7200
## maternal_loss4045          0.00      0.01    -0.02     0.01       7200
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       6713
## older_siblings1            0.02      0.01     0.00     0.03       6995
## older_siblings2            0.02      0.01     0.00     0.05       6885
## older_siblings3            0.03      0.02     0.00     0.07       6733
## older_siblings4            0.01      0.02    -0.04     0.05       6877
## older_siblings5P          -0.06      0.03    -0.12     0.00       6949
## nr.siblings                0.04      0.00     0.03     0.04       6765
## last_born1                 0.01      0.00     0.00     0.02       7200
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-10" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.076</td>
<td align="center">2.016</td>
<td align="center">2.137</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9539</td>
<td align="center">0.9286</td>
<td align="center">0.981</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9951</td>
<td align="center">0.9847</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9975</td>
<td align="center">0.9863</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9364</td>
<td align="center">0.9289</td>
<td align="center">0.944</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.071</td>
<td align="center">1.055</td>
<td align="center">1.087</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9935</td>
<td align="center">0.9793</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.001</td>
<td align="center">0.9743</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.094</td>
<td align="center">0.6919</td>
<td align="center">1.645</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9828</td>
<td align="center">0.8758</td>
<td align="center">1.101</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9494</td>
<td align="center">0.8963</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9818</td>
<td align="center">0.9481</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9786</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9959</td>
<td align="center">0.975</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.987</td>
<td align="center">0.9689</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9951</td>
<td align="center">0.9788</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9946</td>
<td align="center">0.98</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9865</td>
<td align="center">0.9718</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9459</td>
<td align="center">0.9356</td>
<td align="center">0.9565</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.768</td>
<td align="center">0.5013</td>
<td align="center">1.128</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9354</td>
<td align="center">0.7768</td>
<td align="center">1.123</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.011</td>
<td align="center">0.9278</td>
<td align="center">1.097</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9849</td>
<td align="center">0.9347</td>
<td align="center">1.039</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.993</td>
<td align="center">0.9548</td>
<td align="center">1.033</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.025</td>
<td align="center">0.9931</td>
<td align="center">1.059</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.001</td>
<td align="center">0.9729</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9776</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9858</td>
<td align="center">1.025</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9779</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9816</td>
<td align="center">0.9718</td>
<td align="center">0.9919</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.003</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.024</td>
<td align="center">1</td>
<td align="center">1.047</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.033</td>
<td align="center">0.9997</td>
<td align="center">1.068</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.008</td>
<td align="center">0.9636</td>
<td align="center">1.054</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9437</td>
<td align="center">0.8912</td>
<td align="center">0.999</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.034</td>
<td align="center">1.046</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-10" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:89%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.89;1.96]</td>
<td align="center">[1.91;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.8;1.88]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.61</td>
<td align="center">[-7.14;-1.9]</td>
<td align="center">[-6.28;-2.91]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-10" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-143-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-10" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-144-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-10" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-10" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-145-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-145-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-10" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-146-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-10" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-147-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-10" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-10" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r11_separate_random_effects_for_parents.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r11_separate_random_effects_for_parents.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r12_sex_moderation" class="section level2 tab-content">
<h2><em>r12</em>: Sex moderation</h2>
<p>It need not be the case that paternal age has the same effect on male and female children. For example, male children inherit only the small Y chromosome from the father, but female children inherit the larger X chromosome, so that paternal age predicts X-chromosomal de novo mutations in females but not in males (Francioli et al., 2016). At the same time, the autism literature suggests that males are less robust to heritable and de novo autism risk variants and that these effects are not simply due to having only one X chromosome (Werling &amp; Geschwind, 2015). Here we let a dummy variable for being male moderate the paternal age effect.</p>
<div id="model-summary-11" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-11" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 7 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage * male + birth_cohort + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1500; warmup = 1000; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.03        376 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.71      0.02     0.67     0.74       3000
## paternalage               -0.04      0.01    -0.07    -0.01       1652
## male1                     -0.02      0.02    -0.06     0.02       3000
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## maternalage.factor1420     0.07      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.00      0.01    -0.03     0.03       1528
## paternal_loss01            0.09      0.22    -0.39     0.50       3000
## paternal_loss15           -0.02      0.06    -0.13     0.10       3000
## paternal_loss510          -0.05      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.01       3000
## paternal_loss3035         -0.01      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.26      0.21    -0.69     0.13       3000
## maternal_loss15           -0.07      0.09    -0.25     0.12       3000
## maternal_loss510           0.01      0.04    -0.08     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.02     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.02      0.01     0.00     0.03       1931
## older_siblings2            0.02      0.01     0.00     0.05       1521
## older_siblings3            0.03      0.02     0.00     0.07       1661
## older_siblings4            0.01      0.02    -0.04     0.05       1693
## older_siblings5P          -0.06      0.03    -0.12     0.00       1644
## nr.siblings                0.04      0.00     0.03     0.04       1695
## last_born1                 0.01      0.00     0.00     0.02       3000
## paternalage:male1         -0.01      0.01    -0.03     0.00       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## male1                     1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## paternalage:male1         1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-11" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.03</td>
<td align="center">1.963</td>
<td align="center">2.1</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9608</td>
<td align="center">0.9339</td>
<td align="center">0.9882</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9787</td>
<td align="center">0.9428</td>
<td align="center">1.016</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9952</td>
<td align="center">0.9849</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9976</td>
<td align="center">0.9867</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.071</td>
<td align="center">1.055</td>
<td align="center">1.087</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9933</td>
<td align="center">0.9788</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.001</td>
<td align="center">0.9741</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.094</td>
<td align="center">0.6797</td>
<td align="center">1.656</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.983</td>
<td align="center">0.8753</td>
<td align="center">1.104</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9498</td>
<td align="center">0.8965</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9823</td>
<td align="center">0.947</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9787</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9958</td>
<td align="center">0.9735</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.987</td>
<td align="center">0.9684</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9949</td>
<td align="center">0.9794</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9946</td>
<td align="center">0.9806</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9865</td>
<td align="center">0.9713</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9459</td>
<td align="center">0.9348</td>
<td align="center">0.9568</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7707</td>
<td align="center">0.5029</td>
<td align="center">1.139</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9361</td>
<td align="center">0.7784</td>
<td align="center">1.123</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.011</td>
<td align="center">0.9267</td>
<td align="center">1.097</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9844</td>
<td align="center">0.934</td>
<td align="center">1.04</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9927</td>
<td align="center">0.9537</td>
<td align="center">1.031</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.025</td>
<td align="center">0.9921</td>
<td align="center">1.061</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1</td>
<td align="center">0.972</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9787</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9851</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.996</td>
<td align="center">0.9779</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9816</td>
<td align="center">0.972</td>
<td align="center">0.9916</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.016</td>
<td align="center">1.003</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.023</td>
<td align="center">0.9994</td>
<td align="center">1.047</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.033</td>
<td align="center">1</td>
<td align="center">1.068</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.008</td>
<td align="center">0.9632</td>
<td align="center">1.053</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9438</td>
<td align="center">0.8899</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.034</td>
<td align="center">1.046</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.001</td>
<td align="center">1.02</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage:male1</strong></td>
<td align="center">0.9861</td>
<td align="center">0.9746</td>
<td align="center">0.9977</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-11" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.92</td>
<td align="center">[1.88;1.95]</td>
<td align="center">[1.9;1.94]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.81;1.88]</td>
<td align="center">[1.82;1.87]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-3.94</td>
<td align="center">[-6.61;-1.18]</td>
<td align="center">[-5.62;-2.1]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.96</td>
<td align="center">[0.93;0.99]</td>
<td align="center">[0.94;0.98]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-11" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-10.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-154-11.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-11" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-155-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-11" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-11" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-156-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-156-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-11" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-157-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-11" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-158-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-11" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-11" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r12_sex_moderation.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r12_sex_moderation.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r13_control_paternal_afb" class="section level2 tab-content">
<h2><em>r13</em>: Control paternal age at first birth</h2>
<p>We already control for the average paternal age at which the children in a family were born. The mean is a more complete summary of the reproductive timing of the father than the age at first birth. However, far more literature has examined age at first birth and it has the advantage of never being censored (although we of course try to rule out censoring by choosing appropriate subsets). Therefore, we added age at first birth as a covariate in this model.</p>
<div id="model-summary-12" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-12" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 4 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage_at_1st_sib + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1500; warmup = 1000; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        301 1.03
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.75      0.02     0.72     0.78       3000
## paternalage               -0.04      0.01    -0.07    -0.02       1013
## birth_cohort1950M1955     -0.01      0.01    -0.02     0.00       3000
## birth_cohort1955M1960     -0.01      0.01    -0.02     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.07      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.00       3000
## paternalage_at_1st_sib    -0.07      0.01    -0.09    -0.05       3000
## paternalage.mean           0.06      0.02     0.03     0.09       1239
## paternal_loss01            0.09      0.22    -0.37     0.50       3000
## paternal_loss15           -0.02      0.06    -0.13     0.10       3000
## paternal_loss510          -0.05      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.01       3000
## paternal_loss3035         -0.01      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.05      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.26      0.21    -0.69     0.13       3000
## maternal_loss15           -0.07      0.09    -0.25     0.11       3000
## maternal_loss510           0.01      0.04    -0.07     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.01     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.01      0.01     0.00     0.03       1300
## older_siblings2            0.02      0.01     0.00     0.04       1082
## older_siblings3            0.03      0.02     0.00     0.06        921
## older_siblings4            0.01      0.02    -0.04     0.05       1149
## older_siblings5P          -0.05      0.03    -0.10     0.01        977
## nr.siblings                0.03      0.00     0.03     0.04       1136
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept              1.00
## paternalage            1.01
## birth_cohort1950M1955  1.00
## birth_cohort1955M1960  1.00
## male1                  1.00
## maternalage.factor1420 1.00
## maternalage.factor3561 1.00
## paternalage_at_1st_sib 1.00
## paternalage.mean       1.01
## paternal_loss01        1.00
## paternal_loss15        1.00
## paternal_loss510       1.00
## paternal_loss1015      1.00
## paternal_loss1520      1.00
## paternal_loss2025      1.00
## paternal_loss2530      1.00
## paternal_loss3035      1.00
## paternal_loss3540      1.00
## paternal_loss4045      1.00
## paternal_lossunclear   1.00
## maternal_loss01        1.00
## maternal_loss15        1.00
## maternal_loss510       1.00
## maternal_loss1015      1.00
## maternal_loss1520      1.00
## maternal_loss2025      1.00
## maternal_loss2530      1.00
## maternal_loss3035      1.00
## maternal_loss3540      1.00
## maternal_loss4045      1.00
## maternal_lossunclear   1.00
## older_siblings1        1.01
## older_siblings2        1.01
## older_siblings3        1.01
## older_siblings4        1.01
## older_siblings5P       1.01
## nr.siblings            1.01
## last_born1             1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-12" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.109</td>
<td align="center">2.048</td>
<td align="center">2.175</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9585</td>
<td align="center">0.9335</td>
<td align="center">0.9835</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9936</td>
<td align="center">0.9828</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9945</td>
<td align="center">0.983</td>
<td align="center">1.006</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9366</td>
<td align="center">0.9288</td>
<td align="center">0.9443</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.068</td>
<td align="center">1.051</td>
<td align="center">1.084</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9897</td>
<td align="center">0.9762</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage_at_1st_sib</strong></td>
<td align="center">0.9344</td>
<td align="center">0.9183</td>
<td align="center">0.9519</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.059</td>
<td align="center">1.027</td>
<td align="center">1.092</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.097</td>
<td align="center">0.6918</td>
<td align="center">1.648</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9811</td>
<td align="center">0.8759</td>
<td align="center">1.101</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.947</td>
<td align="center">0.8961</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9815</td>
<td align="center">0.9479</td>
<td align="center">1.016</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9787</td>
<td align="center">1.032</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9957</td>
<td align="center">0.9752</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.987</td>
<td align="center">0.969</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9948</td>
<td align="center">0.9784</td>
<td align="center">1.012</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9943</td>
<td align="center">0.98</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.986</td>
<td align="center">0.9717</td>
<td align="center">1.001</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9469</td>
<td align="center">0.9362</td>
<td align="center">0.9574</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7686</td>
<td align="center">0.5001</td>
<td align="center">1.142</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9361</td>
<td align="center">0.7778</td>
<td align="center">1.121</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.009</td>
<td align="center">0.9304</td>
<td align="center">1.096</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9845</td>
<td align="center">0.9354</td>
<td align="center">1.037</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.991</td>
<td align="center">0.9534</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.024</td>
<td align="center">0.9924</td>
<td align="center">1.058</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">0.9999</td>
<td align="center">0.9736</td>
<td align="center">1.026</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1</td>
<td align="center">0.9772</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.004</td>
<td align="center">0.9852</td>
<td align="center">1.024</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.996</td>
<td align="center">0.9777</td>
<td align="center">1.015</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9821</td>
<td align="center">0.9723</td>
<td align="center">0.9919</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.013</td>
<td align="center">1</td>
<td align="center">1.027</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.019</td>
<td align="center">0.9964</td>
<td align="center">1.042</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.029</td>
<td align="center">0.9971</td>
<td align="center">1.063</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.007</td>
<td align="center">0.9649</td>
<td align="center">1.052</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9506</td>
<td align="center">0.9004</td>
<td align="center">1.006</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.033</td>
<td align="center">1.027</td>
<td align="center">1.039</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.009</td>
<td align="center">1</td>
<td align="center">1.018</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-12" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.95</td>
<td align="center">[1.92;1.98]</td>
<td align="center">[1.93;1.97]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.87</td>
<td align="center">[1.83;1.91]</td>
<td align="center">[1.84;1.89]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.15</td>
<td align="center">[-6.65;-1.65]</td>
<td align="center">[-5.8;-2.52]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.96</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-12" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-10.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-165-11.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-12" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-166-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-12" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-12" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-167-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-167-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-12" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-168-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-12" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-169-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-12" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-12" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r13_control_paternal_afb.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r13_control_paternal_afb.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r14_compare_lfe" class="section level2 tab-content">
<h2><em>r14</em>: Compare lfe</h2>
<p>Most of the previous literature has not used multilevel modelling, but linear group fixed effects (essentially dummy variables on the many thousands of families in the model). We believe our multilevel modelling approach has the advantage of allowing us to examine the effect of including predictors at the level of the family in the same model.</p>
<p>This allows us to<br />
a) appropriately model a zero-inflated outcome such as number of children including those who died young (we’re not aware of a linear group fixed effect approach that handles hurdle or zero-inflated models)<br />
b) examine group-level slopes for paternal age and potentially to examine moderators at the level of the family (though we did not do this)<br />
c) explicitly model confounders at the level of the family (e.g. number of siblings).</p>
<p>Nevertheless, the prevalence of this approach in the literature mandates that we show how our approach compares. We fit this model using the R package “<a href="https://cran.r-project.org/web/packages/lfe/">lfe</a>” and the function felm. All covariates that were not estimable in principle were removed (i.e. number of siblings, paternalage.mean).</p>
<pre><code>## 
## Call:
##    felm(formula = children ~ paternalage + birth_cohort + male +      maternalage.factor + paternal_loss + maternal_loss + older_siblings +      last_born | idParents, data = model_data) 
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.554 -0.094  0.000  0.098 10.556 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## paternalage               -0.049562   0.057658   -0.86   0.3900    
## birth_cohort1950-1955      0.021454   0.021372    1.00   0.3155    
## birth_cohort1955-1960      0.053001   0.038154    1.39   0.1648    
## male1                     -0.124342   0.011099  -11.20   &lt;2e-16 ***
## maternalage.factor(14,20]  0.031807   0.025515    1.25   0.2125    
## maternalage.factor(35,61] -0.014914   0.026926   -0.55   0.5797    
## paternal_loss[0,1]         1.766907   0.853856    2.07   0.0385 *  
## paternal_loss(1,5]         0.113027   0.235945    0.48   0.6319    
## paternal_loss(5,10]       -0.288204   0.152810   -1.89   0.0593 .  
## paternal_loss(10,15]      -0.215138   0.121585   -1.77   0.0768 .  
## paternal_loss(15,20]      -0.069973   0.098897   -0.71   0.4792    
## paternal_loss(20,25]      -0.020554   0.081351   -0.25   0.8005    
## paternal_loss(25,30]      -0.055293   0.066102   -0.84   0.4029    
## paternal_loss(30,35]      -0.057376   0.051661   -1.11   0.2667    
## paternal_loss(35,40]      -0.044389   0.037796   -1.17   0.2402    
## paternal_loss(40,45]      -0.042005   0.027412   -1.53   0.1254    
## paternal_lossunclear             NA         NA      NA       NA    
## maternal_loss[0,1]        -1.800020   1.254087   -1.44   0.1512    
## maternal_loss(1,5]        -0.387045   0.340402   -1.14   0.2555    
## maternal_loss(5,10]       -0.116220   0.204045   -0.57   0.5690    
## maternal_loss(10,15]      -0.432018   0.164399   -2.63   0.0086 ** 
## maternal_loss(15,20]      -0.221439   0.133350   -1.66   0.0968 .  
## maternal_loss(20,25]      -0.222986   0.108839   -2.05   0.0405 *  
## maternal_loss(25,30]      -0.120767   0.086222   -1.40   0.1613    
## maternal_loss(30,35]      -0.056786   0.066186   -0.86   0.3909    
## maternal_loss(35,40]      -0.027403   0.046777   -0.59   0.5580    
## maternal_loss(40,45]      -0.027129   0.033004   -0.82   0.4111    
## maternal_lossunclear             NA         NA      NA       NA    
## older_siblings1           -0.028957   0.015712   -1.84   0.0653 .  
## older_siblings2           -0.035176   0.027560   -1.28   0.2018    
## older_siblings3            0.000161   0.040179    0.00   0.9968    
## older_siblings4           -0.081790   0.054792   -1.49   0.1355    
## older_siblings5+          -0.188366   0.073146   -2.58   0.0100 *  
## last_born1                 0.013869   0.009533    1.45   0.1457    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.21 on 47252 degrees of freedom
## Multiple R-squared(full model): 0.665   Adjusted R-squared: 0.0981 
## Multiple R-squared(proj model): 0.00452   Adjusted R-squared: -1.68 
## F-statistic(full model):1.17 on 80031 and 47252 DF, p-value: &lt;2e-16 
## F-statistic(proj model): 6.31 on 34 and 47252 DF, p-value: &lt;2e-16</code></pre>
</div>
<div id="r15_region_moderator_parish_ranef" class="section level2 tab-content">
<h2><em>r15</em>: Using a moderator by region, group-level effects by parish</h2>
<p>In this model we attempted allow for regional variation in paternal age effects and attempted to better control residual variation. Our approach was two-fold: to moderate paternal age by region and to add a random effect for the church parish in which the individual was born. However, for the modern Swedish data, we had no geographic data and no regional information, so this model was not fit.</p>
</div>
<div id="r16_restrict_to_skelleftea" class="section level2 tab-content">
<h2><em>r16</em>: Restrict to Skellefteå</h2>
<p>Only in the DDB (historical Swedish data), parishes in some of the regions were still unlinked. This means that individuals could occur in more than one parish and not be linked. However, the region of Skellefteå was fully linked. Here, we test what happens when we restrict our dataset to Skellefteå.</p>
</div>
<div id="r17_simulate_downs" class="section level2 tab-content">
<h2><em>r17</em>: Simulating Down syndrome cases</h2>
<ol style="list-style-type: decimal">
<li>We assume that 4 in 1000 births are children with Down syndrome (four times the actual rate).</li>
<li>We randomly excluded 33% of all children who had a mother older than 40 and had no children (many times the actual rate at that age).</li>
</ol>
<div id="model-summary-13" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-13" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 126969) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 79823) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        355 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.72      0.02     0.69     0.75       3000
## paternalage               -0.04      0.01    -0.07    -0.01        868
## birth_cohort1950M1955      0.00      0.01    -0.01     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.07      0.01     0.05     0.09       3000
## maternalage.factor3561     0.01      0.01    -0.01     0.02       3000
## paternalage.mean           0.00      0.01    -0.03     0.03        920
## paternal_loss01            0.10      0.22    -0.35     0.50       3000
## paternal_loss15           -0.01      0.06    -0.13     0.10       3000
## paternal_loss510          -0.05      0.03    -0.10     0.01       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.01      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.01       3000
## paternal_loss3035         -0.01      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.05      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.26      0.21    -0.69     0.13       3000
## maternal_loss15           -0.07      0.09    -0.25     0.10       3000
## maternal_loss510           0.02      0.04    -0.07     0.10       3000
## maternal_loss1015         -0.02      0.03    -0.07     0.03       3000
## maternal_loss1520          0.00      0.02    -0.04     0.04       3000
## maternal_loss2025          0.03      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.02     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.03       3000
## maternal_loss3540          0.01      0.01    -0.01     0.03       3000
## maternal_loss4045          0.00      0.01    -0.02     0.02       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.01      0.01     0.00     0.03        960
## older_siblings2            0.02      0.01     0.00     0.04        833
## older_siblings3            0.03      0.02    -0.01     0.06        868
## older_siblings4            0.00      0.02    -0.04     0.05        913
## older_siblings5P          -0.06      0.03    -0.12     0.00        891
## nr.siblings                0.04      0.00     0.03     0.05        909
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept              1.00
## paternalage            1.01
## birth_cohort1950M1955  1.00
## birth_cohort1955M1960  1.00
## male1                  1.00
## maternalage.factor1420 1.00
## maternalage.factor3561 1.00
## paternalage.mean       1.01
## paternal_loss01        1.00
## paternal_loss15        1.00
## paternal_loss510       1.00
## paternal_loss1015      1.00
## paternal_loss1520      1.00
## paternal_loss2025      1.00
## paternal_loss2530      1.00
## paternal_loss3035      1.00
## paternal_loss3540      1.00
## paternal_loss4045      1.00
## paternal_lossunclear   1.00
## maternal_loss01        1.00
## maternal_loss15        1.00
## maternal_loss510       1.00
## maternal_loss1015      1.00
## maternal_loss1520      1.00
## maternal_loss2025      1.00
## maternal_loss2530      1.00
## maternal_loss3035      1.00
## maternal_loss3540      1.00
## maternal_loss4045      1.00
## maternal_lossunclear   1.00
## older_siblings1        1.01
## older_siblings2        1.01
## older_siblings3        1.01
## older_siblings4        1.00
## older_siblings5P       1.01
## nr.siblings            1.01
## last_born1             1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-13" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.057</td>
<td align="center">1.996</td>
<td align="center">2.119</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9593</td>
<td align="center">0.9334</td>
<td align="center">0.9876</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9954</td>
<td align="center">0.9854</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9975</td>
<td align="center">0.9867</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.937</td>
<td align="center">0.9297</td>
<td align="center">0.9446</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.072</td>
<td align="center">1.056</td>
<td align="center">1.089</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">1.007</td>
<td align="center">0.9926</td>
<td align="center">1.022</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9984</td>
<td align="center">0.9709</td>
<td align="center">1.026</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.101</td>
<td align="center">0.7015</td>
<td align="center">1.642</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9853</td>
<td align="center">0.8796</td>
<td align="center">1.104</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9549</td>
<td align="center">0.9018</td>
<td align="center">1.011</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9827</td>
<td align="center">0.9484</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.006</td>
<td align="center">0.9805</td>
<td align="center">1.033</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9967</td>
<td align="center">0.975</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9881</td>
<td align="center">0.9689</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9947</td>
<td align="center">0.9788</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9944</td>
<td align="center">0.98</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9871</td>
<td align="center">0.9724</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9471</td>
<td align="center">0.9365</td>
<td align="center">0.9579</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7685</td>
<td align="center">0.501</td>
<td align="center">1.133</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9346</td>
<td align="center">0.7819</td>
<td align="center">1.104</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.017</td>
<td align="center">0.9369</td>
<td align="center">1.105</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9838</td>
<td align="center">0.9331</td>
<td align="center">1.035</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9965</td>
<td align="center">0.9582</td>
<td align="center">1.036</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.027</td>
<td align="center">0.993</td>
<td align="center">1.061</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.005</td>
<td align="center">0.978</td>
<td align="center">1.033</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.003</td>
<td align="center">0.9805</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.008</td>
<td align="center">0.9875</td>
<td align="center">1.028</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9995</td>
<td align="center">0.9817</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9826</td>
<td align="center">0.9726</td>
<td align="center">0.9924</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.015</td>
<td align="center">1</td>
<td align="center">1.029</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.02</td>
<td align="center">0.9966</td>
<td align="center">1.044</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.029</td>
<td align="center">0.9949</td>
<td align="center">1.064</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.004</td>
<td align="center">0.96</td>
<td align="center">1.052</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.939</td>
<td align="center">0.886</td>
<td align="center">0.9961</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.035</td>
<td align="center">1.046</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.01</td>
<td align="center">1.001</td>
<td align="center">1.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-13" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.92</td>
<td align="center">[1.89;1.95]</td>
<td align="center">[1.9;1.94]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.81;1.88]</td>
<td align="center">[1.82;1.87]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.09</td>
<td align="center">[-6.66;-1.24]</td>
<td align="center">[-5.86;-2.26]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.96</td>
<td align="center">[0.93;0.99]</td>
<td align="center">[0.94;0.98]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-13" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-176-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-13" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-177-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-13" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-13" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-178-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-178-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-13" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-179-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-13" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-180-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-13" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-13" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r17_simulate_downs.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r17_simulate_downs.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r18_hurdle_poisson" class="section level2 tab-content">
<h2><em>r18</em>: Reversing hurdle_poisson and poisson</h2>
<p>To make models computationally feasible and because early mortality was negligible, we fit the very large modern Swedish dataset with a <code>poisson()</code> family distribution. All historical datasets had high early mortality, so we thought a <code>hurdle_poisson()</code> was more appropriate. Here, we show what happens when we reverse this. The <code>hurdle_poisson()</code> model can be fit to the modern Swedish data here, because we only use a subset.</p>
<div id="model-summary-14" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-14" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: hurdle_poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##          hu ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents)
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1500; warmup = 1000; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## b_hu ~ normal(0,5)
## sd_hu ~ student_t(3, 0, 10)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##                  Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0.00      0.00     0.00     0.01       1909 1.00
## sd(hu_Intercept)     0.91      0.02     0.87     0.96        453 1.01
## 
## Population-Level Effects: 
##                           Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                     0.58      0.02     0.55     0.62       3000
## paternalage                  -0.01      0.02    -0.04     0.02        679
## birth_cohort1950M1955         0.02      0.01     0.00     0.03       3000
## birth_cohort1955M1960         0.04      0.01     0.02     0.05       3000
## male1                         0.03      0.00     0.02     0.04       3000
## maternalage.factor1420        0.04      0.01     0.02     0.06       3000
## maternalage.factor3561        0.00      0.01    -0.02     0.02       3000
## paternalage.mean              0.01      0.02    -0.02     0.04        670
## paternal_loss01              -0.17      0.28    -0.77     0.32       3000
## paternal_loss15               0.00      0.07    -0.15     0.13       3000
## paternal_loss510             -0.01      0.04    -0.08     0.06       3000
## paternal_loss1015            -0.01      0.02    -0.06     0.03       3000
## paternal_loss1520             0.02      0.02    -0.01     0.05       3000
## paternal_loss2025            -0.02      0.01    -0.04     0.01       3000
## paternal_loss2530            -0.01      0.01    -0.04     0.01       3000
## paternal_loss3035             0.00      0.01    -0.02     0.02       3000
## paternal_loss3540            -0.01      0.01    -0.03     0.01       3000
## paternal_loss4045            -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear          0.01      0.01    -0.01     0.02       3000
## maternal_loss01              -0.01      0.25    -0.53     0.46       3000
## maternal_loss15              -0.03      0.12    -0.26     0.19       3000
## maternal_loss510              0.00      0.05    -0.10     0.10       3000
## maternal_loss1015             0.01      0.03    -0.06     0.07       3000
## maternal_loss1520             0.00      0.02    -0.05     0.05       3000
## maternal_loss2025             0.03      0.02    -0.01     0.07       3000
## maternal_loss2530             0.02      0.02    -0.02     0.05       3000
## maternal_loss3035             0.02      0.01    -0.01     0.05       3000
## maternal_loss3540             0.01      0.01    -0.01     0.04       3000
## maternal_loss4045             0.00      0.01    -0.02     0.02       3000
## maternal_lossunclear          0.01      0.01    -0.01     0.02       3000
## older_siblings1              -0.01      0.01    -0.03     0.00        815
## older_siblings2              -0.02      0.01    -0.04     0.01        728
## older_siblings3              -0.01      0.02    -0.05     0.03        718
## older_siblings4              -0.04      0.03    -0.09     0.02        764
## older_siblings5P             -0.12      0.03    -0.19    -0.05        748
## nr.siblings                   0.04      0.00     0.03     0.05        731
## last_born1                    0.00      0.01    -0.01     0.02       3000
## hu_Intercept                 -2.73      0.06    -2.84    -2.61       1950
## hu_paternalage                0.22      0.06     0.11     0.33        708
## hu_birth_cohort1950M1955      0.10      0.02     0.06     0.14       3000
## hu_birth_cohort1955M1960      0.16      0.02     0.12     0.20       2414
## hu_male1                      0.48      0.02     0.45     0.51       3000
## hu_maternalage.factor1420    -0.24      0.03    -0.30    -0.18       3000
## hu_maternalage.factor3561     0.04      0.03    -0.02     0.10       3000
## hu_paternalage.mean           0.04      0.06    -0.07     0.15        733
## hu_paternal_loss01           -4.79      2.93   -11.75    -0.48       3000
## hu_paternal_loss15            0.07      0.22    -0.36     0.51       3000
## hu_paternal_loss510           0.22      0.11     0.02     0.44       3000
## hu_paternal_loss1015          0.05      0.07    -0.08     0.19       3000
## hu_paternal_loss1520          0.05      0.05    -0.05     0.15       3000
## hu_paternal_loss2025         -0.04      0.04    -0.13     0.05       3000
## hu_paternal_loss2530          0.02      0.04    -0.05     0.09       3000
## hu_paternal_loss3035          0.02      0.03    -0.04     0.09       3000
## hu_paternal_loss3540          0.00      0.03    -0.06     0.06       3000
## hu_paternal_loss4045          0.03      0.03    -0.03     0.09       3000
## hu_paternal_lossunclear       0.35      0.02     0.30     0.39       2232
## hu_maternal_loss01            1.14      0.62    -0.09     2.26       3000
## hu_maternal_loss15            0.26      0.34    -0.39     0.90       3000
## hu_maternal_loss510          -0.06      0.17    -0.40     0.26       3000
## hu_maternal_loss1015          0.13      0.10    -0.08     0.33       3000
## hu_maternal_loss1520          0.05      0.08    -0.11     0.20       3000
## hu_maternal_loss2025         -0.01      0.07    -0.14     0.12       3000
## hu_maternal_loss2530          0.06      0.05    -0.04     0.17       3000
## hu_maternal_loss3035          0.08      0.05    -0.01     0.17       3000
## hu_maternal_loss3540          0.03      0.04    -0.04     0.11       3000
## hu_maternal_loss4045          0.03      0.04    -0.05     0.10       3000
## hu_maternal_lossunclear       0.14      0.02     0.10     0.18       2524
## hu_older_siblings1           -0.12      0.03    -0.17    -0.07        840
## hu_older_siblings2           -0.17      0.05    -0.26    -0.08        735
## hu_older_siblings3           -0.21      0.07    -0.34    -0.07        720
## hu_older_siblings4           -0.13      0.09    -0.31     0.05        805
## hu_older_siblings5P          -0.08      0.12    -0.31     0.14        733
## hu_nr.siblings               -0.08      0.01    -0.10    -0.06        723
## hu_last_born1                -0.04      0.02    -0.07    -0.01       3000
##                           Rhat
## Intercept                 1.00
## paternalage               1.01
## birth_cohort1950M1955     1.00
## birth_cohort1955M1960     1.00
## male1                     1.00
## maternalage.factor1420    1.00
## maternalage.factor3561    1.00
## paternalage.mean          1.01
## paternal_loss01           1.00
## paternal_loss15           1.00
## paternal_loss510          1.00
## paternal_loss1015         1.00
## paternal_loss1520         1.00
## paternal_loss2025         1.00
## paternal_loss2530         1.00
## paternal_loss3035         1.00
## paternal_loss3540         1.00
## paternal_loss4045         1.00
## paternal_lossunclear      1.00
## maternal_loss01           1.00
## maternal_loss15           1.00
## maternal_loss510          1.00
## maternal_loss1015         1.00
## maternal_loss1520         1.00
## maternal_loss2025         1.00
## maternal_loss2530         1.00
## maternal_loss3035         1.00
## maternal_loss3540         1.00
## maternal_loss4045         1.00
## maternal_lossunclear      1.00
## older_siblings1           1.01
## older_siblings2           1.01
## older_siblings3           1.01
## older_siblings4           1.01
## older_siblings5P          1.01
## nr.siblings               1.01
## last_born1                1.00
## hu_Intercept              1.00
## hu_paternalage            1.00
## hu_birth_cohort1950M1955  1.00
## hu_birth_cohort1955M1960  1.00
## hu_male1                  1.00
## hu_maternalage.factor1420 1.00
## hu_maternalage.factor3561 1.00
## hu_paternalage.mean       1.00
## hu_paternal_loss01        1.00
## hu_paternal_loss15        1.00
## hu_paternal_loss510       1.00
## hu_paternal_loss1015      1.00
## hu_paternal_loss1520      1.00
## hu_paternal_loss2025      1.00
## hu_paternal_loss2530      1.00
## hu_paternal_loss3035      1.00
## hu_paternal_loss3540      1.00
## hu_paternal_loss4045      1.00
## hu_paternal_lossunclear   1.00
## hu_maternal_loss01        1.00
## hu_maternal_loss15        1.00
## hu_maternal_loss510       1.00
## hu_maternal_loss1015      1.00
## hu_maternal_loss1520      1.00
## hu_maternal_loss2025      1.00
## hu_maternal_loss2530      1.00
## hu_maternal_loss3035      1.00
## hu_maternal_loss3540      1.00
## hu_maternal_loss4045      1.00
## hu_maternal_lossunclear   1.00
## hu_older_siblings1        1.00
## hu_older_siblings2        1.00
## hu_older_siblings3        1.00
## hu_older_siblings4        1.00
## hu_older_siblings5P       1.00
## hu_nr.siblings            1.00
## hu_last_born1             1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-14" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="38%" />
<col width="23%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">1.79</td>
<td align="center">1.727</td>
<td align="center">1.853</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9892</td>
<td align="center">0.9578</td>
<td align="center">1.023</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.017</td>
<td align="center">1.004</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.038</td>
<td align="center">1.024</td>
<td align="center">1.052</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">1.026</td>
<td align="center">1.016</td>
<td align="center">1.036</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.04</td>
<td align="center">1.021</td>
<td align="center">1.059</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">1.002</td>
<td align="center">0.9828</td>
<td align="center">1.02</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.011</td>
<td align="center">0.9771</td>
<td align="center">1.043</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">0.8427</td>
<td align="center">0.4643</td>
<td align="center">1.38</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9966</td>
<td align="center">0.8592</td>
<td align="center">1.144</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9896</td>
<td align="center">0.9237</td>
<td align="center">1.058</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.987</td>
<td align="center">0.9462</td>
<td align="center">1.028</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.021</td>
<td align="center">0.9902</td>
<td align="center">1.052</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9843</td>
<td align="center">0.9591</td>
<td align="center">1.01</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9859</td>
<td align="center">0.9642</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9983</td>
<td align="center">0.9792</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9919</td>
<td align="center">0.9751</td>
<td align="center">1.011</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9863</td>
<td align="center">0.9683</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">1.008</td>
<td align="center">0.9948</td>
<td align="center">1.022</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.9925</td>
<td align="center">0.586</td>
<td align="center">1.577</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9737</td>
<td align="center">0.7712</td>
<td align="center">1.209</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1</td>
<td align="center">0.9012</td>
<td align="center">1.105</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">1.008</td>
<td align="center">0.9437</td>
<td align="center">1.075</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9986</td>
<td align="center">0.9515</td>
<td align="center">1.046</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.032</td>
<td align="center">0.9926</td>
<td align="center">1.072</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.018</td>
<td align="center">0.9835</td>
<td align="center">1.053</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.02</td>
<td align="center">0.992</td>
<td align="center">1.05</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.014</td>
<td align="center">0.9903</td>
<td align="center">1.039</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">1.001</td>
<td align="center">0.9785</td>
<td align="center">1.023</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">1.007</td>
<td align="center">0.9945</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">0.9886</td>
<td align="center">0.9726</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">0.9841</td>
<td align="center">0.9576</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">0.9894</td>
<td align="center">0.9511</td>
<td align="center">1.028</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">0.9654</td>
<td align="center">0.9145</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.8876</td>
<td align="center">0.8279</td>
<td align="center">0.9506</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.041</td>
<td align="center">1.034</td>
<td align="center">1.047</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.004</td>
<td align="center">0.9928</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_Intercept</strong></td>
<td align="center">0.06541</td>
<td align="center">0.05825</td>
<td align="center">0.07377</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternalage</strong></td>
<td align="center">1.24</td>
<td align="center">1.115</td>
<td align="center">1.385</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_birth_cohort1950M1955</strong></td>
<td align="center">1.106</td>
<td align="center">1.062</td>
<td align="center">1.154</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_birth_cohort1955M1960</strong></td>
<td align="center">1.176</td>
<td align="center">1.126</td>
<td align="center">1.228</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_male1</strong></td>
<td align="center">1.62</td>
<td align="center">1.57</td>
<td align="center">1.672</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternalage.factor1420</strong></td>
<td align="center">0.7862</td>
<td align="center">0.7392</td>
<td align="center">0.8365</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_maternalage.factor3561</strong></td>
<td align="center">1.041</td>
<td align="center">0.9833</td>
<td align="center">1.103</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternalage.mean</strong></td>
<td align="center">1.039</td>
<td align="center">0.9331</td>
<td align="center">1.161</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_paternal_loss01</strong></td>
<td align="center">0.008336</td>
<td align="center">7.876e-06</td>
<td align="center">0.6176</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternal_loss15</strong></td>
<td align="center">1.078</td>
<td align="center">0.6944</td>
<td align="center">1.664</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_paternal_loss510</strong></td>
<td align="center">1.251</td>
<td align="center">1.017</td>
<td align="center">1.546</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternal_loss1015</strong></td>
<td align="center">1.054</td>
<td align="center">0.9222</td>
<td align="center">1.21</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_paternal_loss1520</strong></td>
<td align="center">1.051</td>
<td align="center">0.9506</td>
<td align="center">1.166</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternal_loss2025</strong></td>
<td align="center">0.963</td>
<td align="center">0.882</td>
<td align="center">1.051</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_paternal_loss2530</strong></td>
<td align="center">1.019</td>
<td align="center">0.9479</td>
<td align="center">1.096</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternal_loss3035</strong></td>
<td align="center">1.023</td>
<td align="center">0.9591</td>
<td align="center">1.09</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_paternal_loss3540</strong></td>
<td align="center">1.002</td>
<td align="center">0.9434</td>
<td align="center">1.062</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_paternal_loss4045</strong></td>
<td align="center">1.029</td>
<td align="center">0.9702</td>
<td align="center">1.092</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_paternal_lossunclear</strong></td>
<td align="center">1.413</td>
<td align="center">1.35</td>
<td align="center">1.479</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternal_loss01</strong></td>
<td align="center">3.118</td>
<td align="center">0.913</td>
<td align="center">9.613</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_maternal_loss15</strong></td>
<td align="center">1.298</td>
<td align="center">0.6761</td>
<td align="center">2.456</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternal_loss510</strong></td>
<td align="center">0.9401</td>
<td align="center">0.6732</td>
<td align="center">1.301</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_maternal_loss1015</strong></td>
<td align="center">1.144</td>
<td align="center">0.9245</td>
<td align="center">1.395</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternal_loss1520</strong></td>
<td align="center">1.049</td>
<td align="center">0.8929</td>
<td align="center">1.223</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_maternal_loss2025</strong></td>
<td align="center">0.9948</td>
<td align="center">0.8717</td>
<td align="center">1.13</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternal_loss2530</strong></td>
<td align="center">1.065</td>
<td align="center">0.9563</td>
<td align="center">1.187</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_maternal_loss3035</strong></td>
<td align="center">1.084</td>
<td align="center">0.9916</td>
<td align="center">1.182</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternal_loss3540</strong></td>
<td align="center">1.034</td>
<td align="center">0.9562</td>
<td align="center">1.118</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_maternal_loss4045</strong></td>
<td align="center">1.028</td>
<td align="center">0.9557</td>
<td align="center">1.105</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_maternal_lossunclear</strong></td>
<td align="center">1.146</td>
<td align="center">1.101</td>
<td align="center">1.193</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_older_siblings1</strong></td>
<td align="center">0.8855</td>
<td align="center">0.8415</td>
<td align="center">0.933</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_older_siblings2</strong></td>
<td align="center">0.8424</td>
<td align="center">0.7699</td>
<td align="center">0.9218</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_older_siblings3</strong></td>
<td align="center">0.8138</td>
<td align="center">0.7136</td>
<td align="center">0.9307</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_older_siblings4</strong></td>
<td align="center">0.8783</td>
<td align="center">0.7348</td>
<td align="center">1.049</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_older_siblings5P</strong></td>
<td align="center">0.9196</td>
<td align="center">0.7356</td>
<td align="center">1.155</td>
</tr>
<tr class="odd">
<td align="center"><strong>hu_nr.siblings</strong></td>
<td align="center">0.924</td>
<td align="center">0.9027</td>
<td align="center">0.9452</td>
</tr>
<tr class="even">
<td align="center"><strong>hu_last_born1</strong></td>
<td align="center">0.9594</td>
<td align="center">0.9282</td>
<td align="center">0.9914</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-14" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.98</td>
<td align="center">[1.95;2.01]</td>
<td align="center">[1.96;2]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.92</td>
<td align="center">[1.88;1.96]</td>
<td align="center">[1.9;1.94]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-3.14</td>
<td align="center">[-5.48;-0.71]</td>
<td align="center">[-4.7;-1.53]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.99</td>
<td align="center">[0.96;1.02]</td>
<td align="center">[0.97;1.01]</td>
</tr>
<tr class="odd">
<td align="center">OR hurdle</td>
<td align="center">1.24</td>
<td align="center">[1.12;1.38]</td>
<td align="center">[1.15;1.33]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-14" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-187-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-14" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-188-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-14" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-14" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-189-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-189-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-14" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-190-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-14" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-191-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-14" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-14" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r18_hurdle_poisson.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r18_hurdle_poisson.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r19_normal_distribution" class="section level2 tab-content">
<h2><em>r19</em>: Normal distribution</h2>
<p>Previous analysts sometimes decided to use the normal distribution to predict (potentially zero-inflated) count data. Here, we refit our models using a normal distribution for the outcome. We show that estimates for the paternal age effect can be estimated to have a substantially different magnitude, because of this, but did not change direction.</p>
<div id="model-summary-15" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-15" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: gaussian(identity) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## sigma ~ student_t(3, 0, 10)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.41      0.01      0.4     0.43        491 1.01
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  2.06      0.03     2.01     2.12       3000
## paternalage               -0.07      0.02    -0.12    -0.03        916
## birth_cohort1950M1955     -0.01      0.01    -0.03     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.02     0.02       3000
## male1                     -0.12      0.01    -0.14    -0.11       3000
## maternalage.factor1420     0.12      0.01     0.10     0.15       3000
## maternalage.factor3561    -0.01      0.01    -0.04     0.01       3000
## paternalage.mean          -0.01      0.02    -0.06     0.04        938
## paternal_loss01            0.29      0.40    -0.50     1.07       3000
## paternal_loss15           -0.01      0.10    -0.20     0.18       3000
## paternal_loss510          -0.09      0.05    -0.19     0.01       3000
## paternal_loss1015         -0.03      0.03    -0.09     0.03       3000
## paternal_loss1520          0.01      0.02    -0.04     0.06       3000
## paternal_loss2025          0.00      0.02    -0.04     0.03       3000
## paternal_loss2530         -0.02      0.02    -0.05     0.01       3000
## paternal_loss3035         -0.01      0.01    -0.04     0.02       3000
## paternal_loss3540         -0.01      0.01    -0.04     0.02       3000
## paternal_loss4045         -0.02      0.01    -0.05     0.00       3000
## paternal_lossunclear      -0.10      0.01    -0.12    -0.08       3000
## maternal_loss01           -0.42      0.32    -1.04     0.21       3000
## maternal_loss15           -0.11      0.15    -0.41     0.19       3000
## maternal_loss510           0.03      0.07    -0.11     0.18       3000
## maternal_loss1015         -0.03      0.05    -0.12     0.06       3000
## maternal_loss1520         -0.01      0.03    -0.08     0.05       3000
## maternal_loss2025          0.04      0.03    -0.01     0.10       3000
## maternal_loss2530          0.00      0.02    -0.04     0.05       3000
## maternal_loss3035          0.00      0.02    -0.04     0.04       3000
## maternal_loss3540          0.01      0.02    -0.03     0.04       3000
## maternal_loss4045          0.00      0.02    -0.04     0.03       3000
## maternal_lossunclear      -0.03      0.01    -0.05    -0.02       3000
## older_siblings1            0.02      0.01    -0.01     0.04       1095
## older_siblings2            0.02      0.02    -0.02     0.06       1048
## older_siblings3            0.04      0.03    -0.02     0.09        966
## older_siblings4           -0.02      0.04    -0.10     0.06       1191
## older_siblings5P          -0.15      0.05    -0.25    -0.05       1071
## nr.siblings                0.08      0.01     0.07     0.09       1076
## last_born1                 0.02      0.01     0.00     0.03       3000
##                        Rhat
## Intercept              1.00
## paternalage            1.01
## birth_cohort1950M1955  1.00
## birth_cohort1955M1960  1.00
## male1                  1.00
## maternalage.factor1420 1.00
## maternalage.factor3561 1.00
## paternalage.mean       1.01
## paternal_loss01        1.00
## paternal_loss15        1.00
## paternal_loss510       1.00
## paternal_loss1015      1.00
## paternal_loss1520      1.00
## paternal_loss2025      1.00
## paternal_loss2530      1.00
## paternal_loss3035      1.00
## paternal_loss3540      1.00
## paternal_loss4045      1.00
## paternal_lossunclear   1.00
## maternal_loss01        1.00
## maternal_loss15        1.00
## maternal_loss510       1.00
## maternal_loss1015      1.00
## maternal_loss1520      1.00
## maternal_loss2025      1.00
## maternal_loss2530      1.00
## maternal_loss3035      1.00
## maternal_loss3540      1.00
## maternal_loss4045      1.00
## maternal_lossunclear   1.00
## older_siblings1        1.01
## older_siblings2        1.01
## older_siblings3        1.01
## older_siblings4        1.01
## older_siblings5P       1.01
## nr.siblings            1.01
## last_born1             1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.19         0     1.19      1.2        757    1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-15" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">7.88</td>
<td align="center">7.467</td>
<td align="center">8.309</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9302</td>
<td align="center">0.8873</td>
<td align="center">0.9736</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9914</td>
<td align="center">0.9739</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9962</td>
<td align="center">0.9771</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.8854</td>
<td align="center">0.8733</td>
<td align="center">0.8979</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.129</td>
<td align="center">1.1</td>
<td align="center">1.16</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9883</td>
<td align="center">0.9633</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9881</td>
<td align="center">0.9419</td>
<td align="center">1.036</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.331</td>
<td align="center">0.6044</td>
<td align="center">2.924</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9932</td>
<td align="center">0.8178</td>
<td align="center">1.2</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9106</td>
<td align="center">0.8251</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.968</td>
<td align="center">0.9101</td>
<td align="center">1.031</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.011</td>
<td align="center">0.9654</td>
<td align="center">1.059</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9599</td>
<td align="center">1.036</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9794</td>
<td align="center">0.9506</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9925</td>
<td align="center">0.9653</td>
<td align="center">1.022</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9908</td>
<td align="center">0.9653</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9758</td>
<td align="center">0.952</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9014</td>
<td align="center">0.8836</td>
<td align="center">0.9191</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.6597</td>
<td align="center">0.3546</td>
<td align="center">1.237</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.8944</td>
<td align="center">0.6647</td>
<td align="center">1.21</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.034</td>
<td align="center">0.8945</td>
<td align="center">1.199</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9663</td>
<td align="center">0.8832</td>
<td align="center">1.057</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9852</td>
<td align="center">0.921</td>
<td align="center">1.054</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.043</td>
<td align="center">0.9863</td>
<td align="center">1.105</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.002</td>
<td align="center">0.9568</td>
<td align="center">1.05</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1</td>
<td align="center">0.9597</td>
<td align="center">1.042</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.009</td>
<td align="center">0.9743</td>
<td align="center">1.042</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.995</td>
<td align="center">0.9624</td>
<td align="center">1.028</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9662</td>
<td align="center">0.9496</td>
<td align="center">0.9832</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">0.9931</td>
<td align="center">1.041</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.021</td>
<td align="center">0.9805</td>
<td align="center">1.062</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.038</td>
<td align="center">0.9794</td>
<td align="center">1.098</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">0.98</td>
<td align="center">0.9066</td>
<td align="center">1.058</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.8579</td>
<td align="center">0.7757</td>
<td align="center">0.9488</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.084</td>
<td align="center">1.074</td>
<td align="center">1.095</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.017</td>
<td align="center">1.002</td>
<td align="center">1.032</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-15" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:89%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.9;1.96]</td>
<td align="center">[1.91;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.86</td>
<td align="center">[1.82;1.89]</td>
<td align="center">[1.83;1.88]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-3.73</td>
<td align="center">[-6.14;-1.4]</td>
<td align="center">[-5.33;-2.2]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.93</td>
<td align="center">[0.89;0.97]</td>
<td align="center">[0.9;0.96]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-15" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-198-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-15" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-199-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-15" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-15" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-200-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-200-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-15" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-201-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-15" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-202-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-15" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-15" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r19_normal_distribution.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r19_normal_distribution.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r20_no_maternalage_control" class="section level2 tab-content">
<h2><em>r20</em>: No adjustment for maternal age</h2>
<p>In this model, we test what happens when we do not adjust for maternal age, because it is highly collinear with paternal age.</p>
<div id="model-summary-16" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-16" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 7 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 1000; warmup = 500; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.03        249 1.03
## 
## Population-Level Effects: 
##                       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept                 0.77      0.01     0.74     0.80       3000    1
## paternalage              -0.05      0.01    -0.08    -0.03       1132    1
## birth_cohort1950M1955     0.00      0.01    -0.01     0.01       3000    1
## birth_cohort1955M1960     0.00      0.01    -0.01     0.01       3000    1
## male1                    -0.07      0.00    -0.07    -0.06       3000    1
## paternalage.mean          0.00      0.01    -0.03     0.02        930    1
## paternal_loss01           0.09      0.22    -0.34     0.49       3000    1
## paternal_loss15          -0.01      0.06    -0.13     0.11       3000    1
## paternal_loss510         -0.05      0.03    -0.11     0.01       3000    1
## paternal_loss1015        -0.01      0.02    -0.05     0.02       3000    1
## paternal_loss1520         0.01      0.01    -0.02     0.03       3000    1
## paternal_loss2025         0.00      0.01    -0.02     0.02       3000    1
## paternal_loss2530        -0.01      0.01    -0.03     0.01       3000    1
## paternal_loss3035         0.00      0.01    -0.02     0.01       3000    1
## paternal_loss3540         0.00      0.01    -0.02     0.01       3000    1
## paternal_loss4045        -0.01      0.01    -0.03     0.00       3000    1
## paternal_lossunclear     -0.05      0.01    -0.07    -0.04       3000    1
## maternal_loss01          -0.23      0.20    -0.65     0.14       3000    1
## maternal_loss15          -0.06      0.09    -0.23     0.11       3000    1
## maternal_loss510          0.01      0.04    -0.07     0.09       3000    1
## maternal_loss1015        -0.02      0.03    -0.07     0.04       3000    1
## maternal_loss1520        -0.01      0.02    -0.05     0.03       3000    1
## maternal_loss2025         0.03      0.02    -0.01     0.06       3000    1
## maternal_loss2530         0.00      0.01    -0.03     0.03       3000    1
## maternal_loss3035         0.00      0.01    -0.02     0.02       3000    1
## maternal_loss3540         0.01      0.01    -0.01     0.02       3000    1
## maternal_loss4045         0.00      0.01    -0.02     0.02       3000    1
## maternal_lossunclear     -0.02      0.01    -0.03    -0.01       3000    1
## older_siblings1           0.01      0.01    -0.01     0.02       1443    1
## older_siblings2           0.01      0.01    -0.01     0.04       1225    1
## older_siblings3           0.02      0.02    -0.01     0.05       1216    1
## older_siblings4          -0.01      0.02    -0.05     0.04       1332    1
## older_siblings5P         -0.07      0.03    -0.13    -0.02       1308    1
## nr.siblings               0.04      0.00     0.04     0.05       1249    1
## last_born1                0.01      0.00     0.00     0.02       3000    1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-16" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.16</td>
<td align="center">2.101</td>
<td align="center">2.221</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9471</td>
<td align="center">0.9235</td>
<td align="center">0.9702</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9953</td>
<td align="center">0.9855</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9976</td>
<td align="center">0.987</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9364</td>
<td align="center">0.9288</td>
<td align="center">0.9442</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.998</td>
<td align="center">0.9731</td>
<td align="center">1.025</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.092</td>
<td align="center">0.7092</td>
<td align="center">1.629</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9914</td>
<td align="center">0.8791</td>
<td align="center">1.114</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.953</td>
<td align="center">0.9</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9854</td>
<td align="center">0.951</td>
<td align="center">1.021</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.008</td>
<td align="center">0.9806</td>
<td align="center">1.035</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9984</td>
<td align="center">0.9766</td>
<td align="center">1.02</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9889</td>
<td align="center">0.9716</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9966</td>
<td align="center">0.9801</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9955</td>
<td align="center">0.9808</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9871</td>
<td align="center">0.973</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9469</td>
<td align="center">0.9367</td>
<td align="center">0.9573</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.791</td>
<td align="center">0.5247</td>
<td align="center">1.148</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.945</td>
<td align="center">0.7955</td>
<td align="center">1.12</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.012</td>
<td align="center">0.9344</td>
<td align="center">1.096</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9849</td>
<td align="center">0.9297</td>
<td align="center">1.04</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9927</td>
<td align="center">0.9539</td>
<td align="center">1.033</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.026</td>
<td align="center">0.9923</td>
<td align="center">1.059</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1</td>
<td align="center">0.9732</td>
<td align="center">1.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.002</td>
<td align="center">0.9788</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9863</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9969</td>
<td align="center">0.9792</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9843</td>
<td align="center">0.9747</td>
<td align="center">0.9943</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.007</td>
<td align="center">0.9945</td>
<td align="center">1.02</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.012</td>
<td align="center">0.9906</td>
<td align="center">1.036</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.021</td>
<td align="center">0.9895</td>
<td align="center">1.054</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">0.995</td>
<td align="center">0.9539</td>
<td align="center">1.038</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9293</td>
<td align="center">0.8802</td>
<td align="center">0.9812</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.042</td>
<td align="center">1.036</td>
<td align="center">1.047</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.009</td>
<td align="center">1</td>
<td align="center">1.017</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-16" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.95</td>
<td align="center">[1.92;1.99]</td>
<td align="center">[1.93;1.97]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.85</td>
<td align="center">[1.81;1.88]</td>
<td align="center">[1.83;1.87]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-5.28</td>
<td align="center">[-7.65;-2.98]</td>
<td align="center">[-6.84;-3.73]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.92;0.97]</td>
<td align="center">[0.93;0.96]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-16" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-209-9.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-16" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-210-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-16" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-16" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-211-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-211-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-16" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-212-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-16" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-213-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-16" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-16" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r20_no_maternalage_control.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r20_no_maternalage_control.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r21_continuous_maternalage" class="section level2 tab-content">
<h2><em>r21</em>: Continuous adjustment for maternal age</h2>
<p>In this model, we adjust for maternal age using a continuous variable instead of three bins. This does not allow for nonlinear effects, but also does not aggregate the predictor. We cannot compare full siblings, test the effects of maternal and paternal age and adjust for average maternal and paternal age in the family (because the predictors are redundant), so that it is not perfectly possible to disentangle the contribution of maternal and paternal age and compare full siblings.</p>
<div id="model-summary-17" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-17" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + maternalage + birth_cohort + male + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 1408212) 
## Samples: 6 chains, each with iter = 1000; warmup = 500; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 885003) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01        182 1.04
## 
## Population-Level Effects: 
##                       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept                 0.82      0.00     0.82     0.83       3000    1
## paternalage              -0.01      0.00    -0.02     0.00       2365    1
## maternalage              -0.05      0.00    -0.05    -0.04       3000    1
## birth_cohort1950M1955     0.00      0.00     0.00     0.00       3000    1
## birth_cohort1955M1960     0.00      0.00     0.00     0.01       3000    1
## male1                    -0.06      0.00    -0.07    -0.06       3000    1
## paternalage.mean         -0.02      0.00    -0.03    -0.01       2282    1
## paternal_loss01           0.12      0.05     0.01     0.22       3000    1
## paternal_loss15           0.03      0.02    -0.01     0.07       3000    1
## paternal_loss510         -0.02      0.01    -0.03     0.00       3000    1
## paternal_loss1015         0.00      0.01    -0.01     0.01       3000    1
## paternal_loss1520         0.01      0.00     0.00     0.01       3000    1
## paternal_loss2025         0.00      0.00    -0.01     0.01       3000    1
## paternal_loss2530         0.00      0.00     0.00     0.01       3000    1
## paternal_loss3035         0.00      0.00     0.00     0.01       3000    1
## paternal_loss3540         0.00      0.00    -0.01     0.00       3000    1
## paternal_loss4045        -0.01      0.00    -0.01     0.00       3000    1
## paternal_lossunclear     -0.05      0.00    -0.06    -0.05       3000    1
## maternal_loss01          -0.21      0.07    -0.35    -0.08       3000    1
## maternal_loss15          -0.06      0.03    -0.12     0.00       3000    1
## maternal_loss510         -0.01      0.01    -0.03     0.02       3000    1
## maternal_loss1015         0.00      0.01    -0.02     0.01       3000    1
## maternal_loss1520         0.00      0.01    -0.01     0.01       3000    1
## maternal_loss2025         0.01      0.01     0.00     0.02       3000    1
## maternal_loss2530         0.01      0.00     0.00     0.02       3000    1
## maternal_loss3035         0.01      0.00     0.00     0.02       3000    1
## maternal_loss3540         0.00      0.00    -0.01     0.01       3000    1
## maternal_loss4045         0.00      0.00     0.00     0.01       3000    1
## maternal_lossunclear     -0.03      0.00    -0.03    -0.02       3000    1
## older_siblings1           0.01      0.00     0.01     0.01       3000    1
## older_siblings2           0.01      0.00     0.01     0.02       2383    1
## older_siblings3           0.01      0.01     0.00     0.02       2408    1
## older_siblings4          -0.01      0.01    -0.02     0.00       2425    1
## older_siblings5P         -0.06      0.01    -0.08    -0.05       2174    1
## nr.siblings               0.04      0.00     0.04     0.04       2348    1
## last_born1                0.01      0.00     0.01     0.01       2971    1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-17" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.281</td>
<td align="center">2.259</td>
<td align="center">2.301</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9906</td>
<td align="center">0.9826</td>
<td align="center">0.9987</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage</strong></td>
<td align="center">0.953</td>
<td align="center">0.9498</td>
<td align="center">0.9565</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.001</td>
<td align="center">0.9978</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.002</td>
<td align="center">0.9987</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.9361</td>
<td align="center">0.9406</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9792</td>
<td align="center">0.9712</td>
<td align="center">0.987</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.122</td>
<td align="center">1.007</td>
<td align="center">1.243</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.031</td>
<td align="center">0.9937</td>
<td align="center">1.07</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9831</td>
<td align="center">0.9658</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9962</td>
<td align="center">0.9861</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.005</td>
<td align="center">0.9974</td>
<td align="center">1.014</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9992</td>
<td align="center">0.9929</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1.004</td>
<td align="center">0.9988</td>
<td align="center">1.01</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9963</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9969</td>
<td align="center">0.9925</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9921</td>
<td align="center">0.9876</td>
<td align="center">0.9965</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.947</td>
<td align="center">0.9438</td>
<td align="center">0.9501</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8112</td>
<td align="center">0.7043</td>
<td align="center">0.9265</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.944</td>
<td align="center">0.8911</td>
<td align="center">0.9981</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9923</td>
<td align="center">0.9675</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9978</td>
<td align="center">0.9832</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9989</td>
<td align="center">0.9871</td>
<td align="center">1.011</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.021</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.009</td>
<td align="center">1.001</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.009</td>
<td align="center">1.002</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.9995</td>
<td align="center">0.9936</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">1.002</td>
<td align="center">0.9967</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9744</td>
<td align="center">0.9714</td>
<td align="center">0.9774</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.01</td>
<td align="center">1.006</td>
<td align="center">1.014</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.014</td>
<td align="center">1.007</td>
<td align="center">1.02</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.006</td>
<td align="center">0.9964</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">0.9904</td>
<td align="center">0.9772</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9378</td>
<td align="center">0.9219</td>
<td align="center">0.9534</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.039</td>
<td align="center">1.038</td>
<td align="center">1.041</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.009</td>
<td align="center">1.006</td>
<td align="center">1.012</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-17" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.9</td>
<td align="center">[1.89;1.91]</td>
<td align="center">[1.89;1.9]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.88</td>
<td align="center">[1.87;1.89]</td>
<td align="center">[1.87;1.89]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-0.94</td>
<td align="center">[-1.74;-0.13]</td>
<td align="center">[-1.49;-0.39]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.99</td>
<td align="center">[0.98;1]</td>
<td align="center">[0.99;1]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-17" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-220-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-17" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-221-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-17" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-17" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-222-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-222-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-17" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-223-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-17" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-224-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-17" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-17" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r21_continuous_maternalage.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r21_continuous_maternalage.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r22_relaxed_exclusion_censoring" class="section level2 tab-content">
<h2><em>r22</em>: Relaxed exclusion and censoring criteria</h2>
<p>Like <em>r1</em>, but we use a 30-years-later cutoff year for our birth cohorts, relaxing our censoring requirements.</p>
</div>
<div id="r23_student_cauchy_priors" class="section level2 tab-content">
<h2><em>r23</em>: Student’s t and half-Cauchy priors</h2>
<p>To demonstrate the robustness of our prior choice we use Student’s t priors (fatter tails than normal priors) for our population-level effects and a half-Cauchy prior for our group-level effect for the family.</p>
<div id="model-summary-18" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-18" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 2 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ student_t(5,0,10)
## sd ~ cauchy(0,5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        313 1.01
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.01     0.70     0.76       3000
## paternalage               -0.05      0.01    -0.08    -0.02       1350
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.07      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.00      0.01    -0.03     0.03       1386
## paternal_loss01            0.09      0.23    -0.37     0.51       3000
## paternal_loss15           -0.02      0.06    -0.13     0.10       3000
## paternal_loss510          -0.05      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.01       3000
## paternal_loss3035          0.00      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.26      0.21    -0.68     0.13       3000
## maternal_loss15           -0.06      0.10    -0.25     0.12       3000
## maternal_loss510           0.01      0.04    -0.07     0.10       3000
## maternal_loss1015         -0.01      0.03    -0.07     0.04       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.03      0.02     0.00     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.02     0.03       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.02      0.01     0.00     0.03       1513
## older_siblings2            0.02      0.01     0.00     0.05       1406
## older_siblings3            0.03      0.02     0.00     0.07       1562
## older_siblings4            0.01      0.02    -0.04     0.05       1498
## older_siblings5P          -0.06      0.03    -0.11     0.00       1482
## nr.siblings                0.04      0.00     0.03     0.04       1568
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-18" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.076</td>
<td align="center">2.016</td>
<td align="center">2.136</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9536</td>
<td align="center">0.9274</td>
<td align="center">0.9797</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9952</td>
<td align="center">0.9847</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9976</td>
<td align="center">0.9863</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9363</td>
<td align="center">0.9286</td>
<td align="center">0.9439</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.071</td>
<td align="center">1.055</td>
<td align="center">1.087</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9937</td>
<td align="center">0.9789</td>
<td align="center">1.008</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.002</td>
<td align="center">0.9752</td>
<td align="center">1.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.095</td>
<td align="center">0.6913</td>
<td align="center">1.673</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9838</td>
<td align="center">0.8748</td>
<td align="center">1.103</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9498</td>
<td align="center">0.898</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9822</td>
<td align="center">0.9482</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.9778</td>
<td align="center">1.031</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9963</td>
<td align="center">0.974</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9869</td>
<td align="center">0.9694</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9952</td>
<td align="center">0.979</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9943</td>
<td align="center">0.9795</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9865</td>
<td align="center">0.9714</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9459</td>
<td align="center">0.9349</td>
<td align="center">0.9565</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7712</td>
<td align="center">0.5081</td>
<td align="center">1.144</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9377</td>
<td align="center">0.7773</td>
<td align="center">1.125</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.012</td>
<td align="center">0.9278</td>
<td align="center">1.105</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9851</td>
<td align="center">0.9349</td>
<td align="center">1.039</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9921</td>
<td align="center">0.9528</td>
<td align="center">1.033</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.026</td>
<td align="center">0.9951</td>
<td align="center">1.058</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.001</td>
<td align="center">0.9739</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.978</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.984</td>
<td align="center">1.026</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9781</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9818</td>
<td align="center">0.9719</td>
<td align="center">0.9919</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.003</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.024</td>
<td align="center">1.001</td>
<td align="center">1.049</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.034</td>
<td align="center">1.001</td>
<td align="center">1.069</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.008</td>
<td align="center">0.9654</td>
<td align="center">1.056</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9443</td>
<td align="center">0.8928</td>
<td align="center">1.001</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.034</td>
<td align="center">1.045</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-18" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.89;1.96]</td>
<td align="center">[1.91;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.8;1.88]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.6</td>
<td align="center">[-7.26;-2.03]</td>
<td align="center">[-6.4;-2.97]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-18" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-231-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-18" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-232-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-18" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-18" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-233-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-233-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-18" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-234-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-18" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-235-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-18" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-18" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r23_student_cauchy_priors.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r23_student_cauchy_priors.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r24_uniform_priors" class="section level2 tab-content">
<h2><em>r24</em>: Improper flat priors</h2>
<p>To demonstrate the robustness of our prior choice we use improper flat priors. These priors should make the model’s results comparable to a frequentist maximum likelihood approach.</p>
<div id="model-summary-19" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-19" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 127284) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## sd ~ student_t(3, 0, 10)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 80000) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.01      0.01        0     0.02        200 1.03
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.02     0.70     0.76       3000
## paternalage               -0.05      0.01    -0.07    -0.02        990
## birth_cohort1950M1955      0.00      0.01    -0.02     0.01       3000
## birth_cohort1955M1960      0.00      0.01    -0.01     0.01       3000
## male1                     -0.07      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.07      0.01     0.05     0.08       3000
## maternalage.factor3561    -0.01      0.01    -0.02     0.01       3000
## paternalage.mean           0.00      0.01    -0.03     0.03       1053
## paternal_loss01            0.09      0.22    -0.35     0.49       3000
## paternal_loss15           -0.02      0.06    -0.13     0.10       3000
## paternal_loss510          -0.05      0.03    -0.11     0.00       3000
## paternal_loss1015         -0.02      0.02    -0.05     0.02       3000
## paternal_loss1520          0.00      0.01    -0.02     0.03       3000
## paternal_loss2025          0.00      0.01    -0.03     0.02       3000
## paternal_loss2530         -0.01      0.01    -0.03     0.00       3000
## paternal_loss3035          0.00      0.01    -0.02     0.01       3000
## paternal_loss3540         -0.01      0.01    -0.02     0.01       3000
## paternal_loss4045         -0.01      0.01    -0.03     0.00       3000
## paternal_lossunclear      -0.06      0.01    -0.07    -0.04       3000
## maternal_loss01           -0.26      0.21    -0.69     0.12       3000
## maternal_loss15           -0.07      0.09    -0.25     0.12       3000
## maternal_loss510           0.01      0.04    -0.07     0.09       3000
## maternal_loss1015         -0.02      0.03    -0.06     0.03       3000
## maternal_loss1520         -0.01      0.02    -0.05     0.03       3000
## maternal_loss2025          0.02      0.02    -0.01     0.06       3000
## maternal_loss2530          0.00      0.01    -0.03     0.03       3000
## maternal_loss3035          0.00      0.01    -0.02     0.02       3000
## maternal_loss3540          0.00      0.01    -0.01     0.02       3000
## maternal_loss4045          0.00      0.01    -0.02     0.01       3000
## maternal_lossunclear      -0.02      0.01    -0.03    -0.01       3000
## older_siblings1            0.02      0.01     0.00     0.03       1251
## older_siblings2            0.02      0.01     0.00     0.05       1086
## older_siblings3            0.03      0.02     0.00     0.07       1097
## older_siblings4            0.01      0.02    -0.04     0.05       1207
## older_siblings5P          -0.06      0.03    -0.11     0.00       1142
## nr.siblings                0.04      0.00     0.03     0.04       1117
## last_born1                 0.01      0.00     0.00     0.02       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-19" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.076</td>
<td align="center">2.015</td>
<td align="center">2.138</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9531</td>
<td align="center">0.9287</td>
<td align="center">0.9793</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9952</td>
<td align="center">0.985</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9976</td>
<td align="center">0.9867</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9365</td>
<td align="center">0.929</td>
<td align="center">0.9438</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.071</td>
<td align="center">1.054</td>
<td align="center">1.086</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9936</td>
<td align="center">0.9785</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.002</td>
<td align="center">0.9753</td>
<td align="center">1.028</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.097</td>
<td align="center">0.7049</td>
<td align="center">1.637</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">0.9829</td>
<td align="center">0.8744</td>
<td align="center">1.102</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9489</td>
<td align="center">0.8977</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9823</td>
<td align="center">0.9482</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.005</td>
<td align="center">0.9777</td>
<td align="center">1.032</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9957</td>
<td align="center">0.9742</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">0.9869</td>
<td align="center">0.9696</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9952</td>
<td align="center">0.979</td>
<td align="center">1.012</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9944</td>
<td align="center">0.9795</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9864</td>
<td align="center">0.9717</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9458</td>
<td align="center">0.9353</td>
<td align="center">0.9568</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.7722</td>
<td align="center">0.5028</td>
<td align="center">1.132</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9334</td>
<td align="center">0.7799</td>
<td align="center">1.122</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">1.011</td>
<td align="center">0.9287</td>
<td align="center">1.099</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9839</td>
<td align="center">0.9372</td>
<td align="center">1.034</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9919</td>
<td align="center">0.9531</td>
<td align="center">1.034</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.025</td>
<td align="center">0.9901</td>
<td align="center">1.061</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.001</td>
<td align="center">0.9717</td>
<td align="center">1.029</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9776</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">1.005</td>
<td align="center">0.9852</td>
<td align="center">1.024</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9962</td>
<td align="center">0.9774</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9817</td>
<td align="center">0.9716</td>
<td align="center">0.9915</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.017</td>
<td align="center">1.002</td>
<td align="center">1.03</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.024</td>
<td align="center">1.001</td>
<td align="center">1.047</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.034</td>
<td align="center">1.001</td>
<td align="center">1.068</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.009</td>
<td align="center">0.9651</td>
<td align="center">1.054</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.945</td>
<td align="center">0.8926</td>
<td align="center">0.9985</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.04</td>
<td align="center">1.035</td>
<td align="center">1.046</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.002</td>
<td align="center">1.019</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-19" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.9;1.96]</td>
<td align="center">[1.91;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.84</td>
<td align="center">[1.8;1.88]</td>
<td align="center">[1.81;1.86]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.71</td>
<td align="center">[-7.13;-2.07]</td>
<td align="center">[-6.32;-2.97]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.93;0.98]</td>
<td align="center">[0.94;0.97]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-19" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-242-10.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-19" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-243-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-19" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-19" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-244-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-244-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-19" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-245-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-19" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-246-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-19" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-19" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r24_uniform_priors.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r24_uniform_priors.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="r25_migration_status" class="section level2 tab-content">
<h2><em>r25</em>: Adjust for migration status</h2>
<p>In the three historical populations, records were kept in the parish. Although records were linked between parishes in all populations, except three out of four provinces in historical Sweden, migration might sometimes lead to censoring of records. Adjusting for migration may however constitute a partial adjustment for the outcome, as lower offspring fitness might make them more likely to migrate. Hence, we show the results of doing so as a robustness analysis. In all analyses, we adjusted for a “migrated”-dummy variable. Migration was differently defined depending on the population. In Québec, we had flags denoting immigrants and emigrants. Few immigrants were included in our analyses anyway, as we needed parental information for our analyses. Emigrants were people who left Québec. In historical Sweden, migration was logged as migration from the parish of birth. In the Krummhörn, we set migrated to true, when the parish of death/burial differed from the parish of birth/baptism.<br />
No migration information was available in 20th-century Sweden, but records there weren’t kept in parishes, so this should not pose a problem.</p>
</div>
<div id="r26_separate_parental_age_contributions" class="section level2 tab-content">
<h2><em>r26</em>: Separate parental age contributions</h2>
<p>In this model, we adjust for maternal age using a continuous variable. We also adjust for a dummy variable for teenage motherhood, to account for the nonlinearity of the maternal age effect. Moreover, we use separate random intercepts for mothers and fathers and adjust for the mother’s mean age at birth and the father’s mean age at birth. This model only converges in the 20th-century Sweden data, because there are sufficient numbers of divorces and remarriages and enough data to separate the parents’ contributions.</p>
<div id="model-summary-20" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-20" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + maternalage + young_mother + paternalage.mean + birth_cohort + male + maternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idPere) + (1 | idMere) 
##    Data: model_data (Number of observations: 1408212) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##    WAIC: Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idMere (Number of levels: 861310) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01        343 1.01
## 
## ~idPere (Number of levels: 859618) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01        199 1.02
## 
## Population-Level Effects: 
##                       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept                 0.79      0.00     0.78     0.80       3000    1
## paternalage              -0.02      0.01    -0.04     0.00       2937    1
## maternalage              -0.05      0.01    -0.06    -0.03       2929    1
## young_mother              0.05      0.00     0.04     0.05       2950    1
## paternalage.mean         -0.01      0.01    -0.03     0.01       2928    1
## birth_cohort1950M1955     0.00      0.00     0.00     0.00       3000    1
## birth_cohort1955M1960     0.00      0.00     0.00     0.01       3000    1
## male1                    -0.06      0.00    -0.07    -0.06       2713    1
## maternalage.mean          0.01      0.01    -0.01     0.02       2927    1
## paternal_loss01           0.11      0.05     0.01     0.22       3000    1
## paternal_loss15           0.03      0.02    -0.01     0.07       3000    1
## paternal_loss510         -0.02      0.01    -0.03     0.00       3000    1
## paternal_loss1015         0.00      0.01    -0.02     0.01       3000    1
## paternal_loss1520         0.00      0.00     0.00     0.01       3000    1
## paternal_loss2025         0.00      0.00    -0.01     0.00       3000    1
## paternal_loss2530         0.00      0.00     0.00     0.01       3000    1
## paternal_loss3035         0.00      0.00     0.00     0.01       3000    1
## paternal_loss3540         0.00      0.00    -0.01     0.00       3000    1
## paternal_loss4045        -0.01      0.00    -0.01     0.00       3000    1
## paternal_lossunclear     -0.05      0.00    -0.06    -0.05       2973    1
## maternal_loss01          -0.21      0.07    -0.35    -0.07       3000    1
## maternal_loss15          -0.06      0.03    -0.12     0.00       3000    1
## maternal_loss510         -0.01      0.01    -0.03     0.02       3000    1
## maternal_loss1015         0.00      0.01    -0.02     0.01       3000    1
## maternal_loss1520         0.00      0.01    -0.01     0.01       3000    1
## maternal_loss2025         0.01      0.01     0.00     0.02       3000    1
## maternal_loss2530         0.01      0.00     0.00     0.02       3000    1
## maternal_loss3035         0.01      0.00     0.00     0.02       2971    1
## maternal_loss3540         0.00      0.00    -0.01     0.00       2995    1
## maternal_loss4045         0.00      0.00     0.00     0.01       3000    1
## maternal_lossunclear     -0.03      0.00    -0.03    -0.02       3000    1
## older_siblings1           0.02      0.00     0.02     0.02       3000    1
## older_siblings2           0.03      0.00     0.02     0.03       3000    1
## older_siblings3           0.02      0.00     0.02     0.03       3000    1
## older_siblings4           0.01      0.01     0.00     0.02       3000    1
## older_siblings5P         -0.04      0.01    -0.05    -0.02       3000    1
## nr.siblings               0.04      0.00     0.03     0.04       3000    1
## last_born1                0.01      0.00     0.01     0.01       3000    1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-20" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="25%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.211</td>
<td align="center">2.191</td>
<td align="center">2.231</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9779</td>
<td align="center">0.9612</td>
<td align="center">0.9956</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage</strong></td>
<td align="center">0.9557</td>
<td align="center">0.9384</td>
<td align="center">0.9729</td>
</tr>
<tr class="even">
<td align="center"><strong>young_mother</strong></td>
<td align="center">1.046</td>
<td align="center">1.041</td>
<td align="center">1.052</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9922</td>
<td align="center">0.9745</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.001</td>
<td align="center">0.9976</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.002</td>
<td align="center">0.9977</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.9361</td>
<td align="center">0.9407</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.mean</strong></td>
<td align="center">1.007</td>
<td align="center">0.989</td>
<td align="center">1.025</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.121</td>
<td align="center">1.01</td>
<td align="center">1.242</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.03</td>
<td align="center">0.9924</td>
<td align="center">1.068</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9825</td>
<td align="center">0.966</td>
<td align="center">0.9999</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9953</td>
<td align="center">0.9849</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.004</td>
<td align="center">0.997</td>
<td align="center">1.012</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9984</td>
<td align="center">0.992</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1.004</td>
<td align="center">0.9981</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">1.001</td>
<td align="center">0.9956</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9964</td>
<td align="center">0.9921</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9918</td>
<td align="center">0.9873</td>
<td align="center">0.9962</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9465</td>
<td align="center">0.9434</td>
<td align="center">0.9497</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8105</td>
<td align="center">0.7019</td>
<td align="center">0.9313</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9438</td>
<td align="center">0.8888</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9918</td>
<td align="center">0.9662</td>
<td align="center">1.018</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9971</td>
<td align="center">0.981</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9982</td>
<td align="center">0.9866</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.011</td>
<td align="center">1.001</td>
<td align="center">1.021</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.008</td>
<td align="center">1</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.009</td>
<td align="center">1.002</td>
<td align="center">1.016</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.9988</td>
<td align="center">0.9929</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">1.002</td>
<td align="center">0.9963</td>
<td align="center">1.007</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9747</td>
<td align="center">0.972</td>
<td align="center">0.9775</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.019</td>
<td align="center">1.015</td>
<td align="center">1.022</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.028</td>
<td align="center">1.022</td>
<td align="center">1.033</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.024</td>
<td align="center">1.016</td>
<td align="center">1.032</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.012</td>
<td align="center">1.001</td>
<td align="center">1.023</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.964</td>
<td align="center">0.952</td>
<td align="center">0.9769</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.037</td>
<td align="center">1.035</td>
<td align="center">1.038</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.009</td>
<td align="center">1.007</td>
<td align="center">1.012</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-20" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.9</td>
<td align="center">[1.88;1.92]</td>
<td align="center">[1.89;1.92]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.86</td>
<td align="center">[1.84;1.88]</td>
<td align="center">[1.85;1.87]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-2.22</td>
<td align="center">[-3.88;-0.44]</td>
<td align="center">[-3.33;-1.11]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.98</td>
<td align="center">[0.96;1]</td>
<td align="center">[0.97;0.99]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-20" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-1.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-2.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-3.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-4.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-5.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-6.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-7.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-8.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-9.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-10.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-11.png" width="1440px" height="900px" /><img src="5_swed_robustness_files/figure-html/unnamed-chunk-253-12.png" width="1440px" height="900px" /></p>
</div>
<div id="coefficient-plot-20" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-254-1.png" width="1440px" height="900px" /></p>
</div>
<div id="diagnostics-20" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-20" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-255-1.png" width="1440px" height="900px" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-255-2.png" width="1440px" height="900px" /></p>
</div>
<div id="rhat-20" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-256-1.png" width="1440px" height="900px" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-20" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-257-1.png" width="1440px" height="900px" /></p>
</div>
<div id="trace-plots-20" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-20" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/r26_separate_parental_age_contributions.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="r26_separate_parental_age_contributions.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="robustness-check-comparison" class="section level2">
<h2>Robustness check comparison</h2>
<p>Here we show the effect of paternal age for each episode.</p>
<div id="legend" class="section level3">
<h3>Legend</h3>
<p>In reference to <em>m3</em>, the main reported model, the robustness models were implemented as follows: <em>r1</em> relaxed exclusion criteria (not in 20th-century Sweden), <em>r2</em> had only birth cohort as a covariate, <em>r3</em> adjusted for birth order as a continuous variable, <em>r4</em> adjusted for number of dependent siblings instead of birth order, <em>r5</em> interacted birth order with number of siblings, <em>r6</em> did not adjust for birth order, <em>r7</em> adjusted only for parental loss in the first 5 years, <em>r8</em> adjusted for being the first-/last-born adult son, <em>r9</em> adjusted for a continuous nonlinear thin-splate spline for birth year instead of 5-year bins, <em>r10</em> added a group-level slope for paternal age, <em>r11</em> included separate group-level effects for each parent instead of one per marriage, <em>r12</em> added a moderation by anchor sex, <em>r13</em> adjusted for paternal age at first birth, <em>r14</em> compared a model with linear group fixed effects, <em>r15</em> added a moderator by region and group-level effects by church parish (not in 20th-century Sweden), <em>r16</em> was restricted to Skellefteå (only in historical Sweden), <em>r17</em> simulated Down syndrome cases, <em>r18</em> reversed hurdle Poisson and Poisson distribution for the respective populations, <em>r19</em> used a normal distribution, <em>r20</em> did not adjust for maternal age, <em>r21</em> adjusted for maternal age as a continuous variable, <em>r22</em> relaxed exclusion criteria and included 30 more years of birth cohorts, allowing for more potential censoring, <em>r23</em> used Student’s t distributions for population-level priors and half-Cauchy priors for the family variance component, <em>r24</em> used noninformative priors, which should lead to results comparable with maximum likelihood, <em>r25</em> controlled for migration status (not in 20th-century Sweden), <em>r26</em> separate parental age contributions (only in 20th-century Sweden).</p>
<p>Points show median estimates, the lines show 80% and 95% credibility intervals respectively.</p>
<p><img src="5_swed_robustness_files/figure-html/unnamed-chunk-28-1.png" width="1440px" height="900px" /></p>
</div>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>
</body>
</html>
