<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Modern Sweden Main Models</title>

<script src="library/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="library/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>


<script src="library/auto_tab_first_section.js"></script>

</head>

<body>
<div style="width:100%;height:200px;background-image:url('library/header/swed.jpg');background-size:cover;"></div>
<div class="container-fluid main-container"><div class="row"><div class="col-md-4"><a href="index.html"><i class="glyphicon glyphicon-th-list"></i> Back to index</a></div></div></div>

<div class="container-fluid main-container">


<div id="sweden-1947-2000-main-models" class="section level1 tab-content">
<h1>Sweden (1947-2000), main models</h1>
<div id="loading-details" class="section level3 accordion">
<h3>Loading details</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;0__helpers.R&quot;</span>)
opts_chunk$<span class="kw">set</span>(<span class="dt">warning=</span><span class="ot">TRUE</span>, <span class="dt">cache=</span>F,<span class="dt">tidy=</span><span class="ot">FALSE</span>,<span class="dt">dev=</span><span class="kw">c</span>(<span class="st">&#39;png&#39;</span>),<span class="dt">fig.width=</span><span class="dv">20</span>,<span class="dt">fig.height=</span><span class="fl">12.5</span>)

make_path =<span class="st"> </span>function(file) {
    <span class="kw">get_coefficient_path</span>(file, <span class="st">&quot;swed&quot;</span>)
} 
<span class="co"># options for each chunk calling knit_child</span>
opts_chunk$<span class="kw">set</span>(<span class="dt">warning=</span><span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>, <span class="dt">echo =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="analysis-description" class="section level2">
<h2>Analysis description</h2>
<div id="data-subset" class="section level3">
<h3>Data subset</h3>
<p>The <code>swed_subset_survival.1</code> dataset contains only those participants where paternal age is known and birth years are from 1969 to 2000. We use it for the analyses pertaining to survival. We randomly sampled 100,000 families from the whole dataset.</p>
<p>The <code>swed.1</code> dataset contains all those participants where paternal age is known and birth years are from 1947 to 1959. We use it for the analyses pertaining to marriage, divorce and reproductive success.</p>
</div>
<div id="model-description" class="section level3">
<h3>Model description</h3>
<p>All of the following models have the following in common:</p>
<div id="estimation" class="section level4">
<h4>Estimation</h4>
<p>We fit all models using <code>brms</code> v. 1.2.0, a Bayesian regression analysis statistical package. <code>brms</code> uses <code>Stan</code>, a probabilistic programming langugage to fit models using Hamiltonian Monte Carlo.</p>
</div>
<div id="covariates" class="section level4">
<h4>Covariates</h4>
<p>In our main models we adjust for average paternal age in the family, birth cohort (birth years in five equally large bins), for male sex, for age at paternal and maternal loss (0-1, 2-5, 6-10, …, 41-45, 45+, unknown), for maternal age (bins of 14-20, 20-35 and 35-50), for the number of siblings, for the number of older siblings (0-5, 5+) and for being last born.</p>
</div>
<div id="model-stratification" class="section level4">
<h4>Model stratification</h4>
<p>We added random intercepts for each family (father-mother dyad). We then controlled for the average paternal age in the family. Hence, the paternal age effects in the plot are split into those between families and those within families or between siblings. We are interested in the effect of paternal age between siblings, as this effect cannot be explained by e.g. genetic propensities of the father to reproduce late.</p>
</div>
</div>
</div>
<div id="m1_children_linear_noranef" class="section level2 tab-content">
<h2><em>m1</em>: No sibling comparison</h2>
<p>Here, we ignore the pedigree structure of the data to see whether it matters for the estimation of the paternal age effect.</p>
<div id="model-summary" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born 
##    Data: model_data (Number of observations: 1408177) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##     ICs: LOO = Not computed; WAIC = Not computed
##  
## Priors: 
## b ~ normal(0,5)
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.00     0.72     0.74       3000
## paternalage               -0.05      0.00    -0.05    -0.04       3000
## birth_cohort1950M1955      0.00      0.00     0.00     0.00       3000
## birth_cohort1955M1960      0.00      0.00     0.00     0.01       3000
## male1                     -0.06      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.06      0.00     0.05     0.06       3000
## maternalage.factor3561     0.00      0.00    -0.01     0.00       3000
## paternal_loss01            0.11      0.05     0.00     0.22       1327
## paternal_loss15            0.03      0.02     0.00     0.07       1893
## paternal_loss510          -0.02      0.01    -0.03     0.00       2062
## paternal_loss1015          0.00      0.01    -0.01     0.01       3000
## paternal_loss1520          0.00      0.00     0.00     0.01       3000
## paternal_loss2025          0.00      0.00    -0.01     0.00       3000
## paternal_loss2530          0.00      0.00     0.00     0.01       3000
## paternal_loss3035          0.00      0.00     0.00     0.00       3000
## paternal_loss3540          0.00      0.00    -0.01     0.00       3000
## paternal_loss4045         -0.01      0.00    -0.01     0.00       3000
## paternal_lossunclear      -0.06      0.00    -0.06    -0.05       3000
## maternal_loss01           -0.20      0.07    -0.34    -0.06       1665
## maternal_loss15           -0.06      0.03    -0.11     0.00       1497
## maternal_loss510          -0.01      0.01    -0.04     0.02       1759
## maternal_loss1015         -0.01      0.01    -0.02     0.01       2587
## maternal_loss1520          0.00      0.01    -0.02     0.01       2838
## maternal_loss2025          0.01      0.00     0.00     0.02       3000
## maternal_loss2530          0.01      0.00     0.00     0.01       3000
## maternal_loss3035          0.01      0.00     0.00     0.01       3000
## maternal_loss3540          0.00      0.00    -0.01     0.00       3000
## maternal_loss4045          0.00      0.00    -0.01     0.01       3000
## maternal_lossunclear      -0.02      0.00    -0.02    -0.02       3000
## older_siblings1            0.02      0.00     0.01     0.02       3000
## older_siblings2            0.02      0.00     0.01     0.02       3000
## older_siblings3            0.01      0.00     0.00     0.02       3000
## older_siblings4           -0.01      0.00    -0.02     0.00       3000
## older_siblings5P          -0.06      0.01    -0.07    -0.05       2350
## nr.siblings                0.04      0.00     0.04     0.04       2470
## last_born1                 0.01      0.00     0.01     0.01       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.08</td>
<td align="center">2.062</td>
<td align="center">2.098</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.954</td>
<td align="center">0.9517</td>
<td align="center">0.9564</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.001</td>
<td align="center">0.9975</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.002</td>
<td align="center">0.9983</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.9361</td>
<td align="center">0.9406</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.059</td>
<td align="center">1.054</td>
<td align="center">1.063</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9987</td>
<td align="center">0.9944</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.121</td>
<td align="center">1.003</td>
<td align="center">1.244</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.032</td>
<td align="center">0.9957</td>
<td align="center">1.07</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9834</td>
<td align="center">0.9665</td>
<td align="center">1.001</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9855</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.005</td>
<td align="center">0.997</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9983</td>
<td align="center">0.9916</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1.003</td>
<td align="center">0.998</td>
<td align="center">1.009</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">1</td>
<td align="center">0.9954</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.996</td>
<td align="center">0.9915</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9915</td>
<td align="center">0.9871</td>
<td align="center">0.9957</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9462</td>
<td align="center">0.943</td>
<td align="center">0.9495</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8221</td>
<td align="center">0.7097</td>
<td align="center">0.9435</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9462</td>
<td align="center">0.893</td>
<td align="center">0.9998</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9905</td>
<td align="center">0.9641</td>
<td align="center">1.017</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9939</td>
<td align="center">0.9786</td>
<td align="center">1.01</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9953</td>
<td align="center">0.9827</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.009</td>
<td align="center">0.9988</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.006</td>
<td align="center">0.9973</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.006</td>
<td align="center">0.9985</td>
<td align="center">1.013</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.996</td>
<td align="center">0.9903</td>
<td align="center">1.002</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9994</td>
<td align="center">0.9936</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9798</td>
<td align="center">0.9768</td>
<td align="center">0.9829</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.016</td>
<td align="center">1.012</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.019</td>
<td align="center">1.015</td>
<td align="center">1.023</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.011</td>
<td align="center">1.004</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">0.9943</td>
<td align="center">0.9849</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9402</td>
<td align="center">0.9301</td>
<td align="center">0.9506</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.039</td>
<td align="center">1.038</td>
<td align="center">1.04</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.009</td>
<td align="center">1.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.92</td>
<td align="center">[1.91;1.93]</td>
<td align="center">[1.92;1.93]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.83</td>
<td align="center">[1.83;1.84]</td>
<td align="center">[1.83;1.84]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-4.60</td>
<td align="center">[-4.83;-4.36]</td>
<td align="center">[-4.75;-4.44]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.95;0.96]</td>
<td align="center">[0.95;0.96]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-1.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-2.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-3.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-4.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-5.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-6.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-7.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-8.png" alt="plot of chunk unnamed-chunk-12" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-12-9.png" alt="plot of chunk unnamed-chunk-12" /></p>
</div>
<div id="coefficient-plot" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-13-1.png" alt="plot of chunk unnamed-chunk-13" /></p>
</div>
<div id="diagnostics" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-14-1.png" alt="plot of chunk unnamed-chunk-14" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-14-2.png" alt="plot of chunk unnamed-chunk-14" /></p>
</div>
<div id="rhat" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-15-1.png" alt="plot of chunk unnamed-chunk-15" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-16-1.png" alt="plot of chunk unnamed-chunk-16" /></p>
</div>
<div id="trace-plots" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/m1_children_linear_noranef.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="m1_children_linear_noranef.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="m2_children_linear_no_diff" class="section level2 tab-content">
<h2><em>m2</em>: Sibling comparison, no paternal age effect</h2>
<p>Here, we compared siblings by including a random intercept for the family, but we modelled no effect for paternal age differences among siblings.</p>
<div id="model-summary-1" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-1" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 1408177) 
## Samples: 6 chains, each with iter = 1500; warmup = 1000; thin = 1; 
##          total post-warmup samples = 3000
##     ICs: LOO = Not computed; WAIC = Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 884975) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01         67 1.07
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.00     0.72     0.74       3000
## birth_cohort1950M1955      0.00      0.00     0.00     0.00       3000
## birth_cohort1955M1960      0.00      0.00     0.00     0.00       3000
## male1                     -0.06      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.06      0.00     0.05     0.06       3000
## maternalage.factor3561    -0.01      0.00    -0.01    -0.01       3000
## paternalage.mean          -0.04      0.00    -0.05    -0.04       3000
## paternal_loss01            0.11      0.05     0.02     0.21       3000
## paternal_loss15            0.03      0.02    -0.01     0.06       3000
## paternal_loss510          -0.02      0.01    -0.04     0.00       3000
## paternal_loss1015         -0.01      0.01    -0.02     0.00       3000
## paternal_loss1520          0.00      0.00    -0.01     0.01       3000
## paternal_loss2025          0.00      0.00    -0.01     0.00       3000
## paternal_loss2530          0.00      0.00     0.00     0.01       3000
## paternal_loss3035          0.00      0.00    -0.01     0.00       3000
## paternal_loss3540         -0.01      0.00    -0.01     0.00       3000
## paternal_loss4045         -0.01      0.00    -0.01     0.00       3000
## paternal_lossunclear      -0.05      0.00    -0.06    -0.05       3000
## maternal_loss01           -0.20      0.07    -0.34    -0.06       3000
## maternal_loss15           -0.06      0.03    -0.11     0.00       3000
## maternal_loss510          -0.01      0.01    -0.04     0.01       3000
## maternal_loss1015         -0.01      0.01    -0.02     0.01       3000
## maternal_loss1520          0.00      0.01    -0.02     0.01       3000
## maternal_loss2025          0.01      0.01     0.00     0.02       3000
## maternal_loss2530          0.01      0.00     0.00     0.01       3000
## maternal_loss3035          0.01      0.00     0.00     0.01       3000
## maternal_loss3540          0.00      0.00    -0.01     0.00       3000
## maternal_loss4045          0.00      0.00    -0.01     0.00       3000
## maternal_lossunclear      -0.02      0.00    -0.02    -0.02       3000
## older_siblings1            0.00      0.00     0.00     0.00       3000
## older_siblings2           -0.01      0.00    -0.02    -0.01       3000
## older_siblings3           -0.03      0.00    -0.04    -0.03       3000
## older_siblings4           -0.06      0.00    -0.07    -0.05       3000
## older_siblings5P          -0.14      0.01    -0.15    -0.12       3000
## nr.siblings                0.05      0.00     0.04     0.05       2555
## last_born1                 0.01      0.00     0.01     0.02       2871
##                        Rhat
## Intercept                 1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-1" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.067</td>
<td align="center">2.049</td>
<td align="center">2.086</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">0.9999</td>
<td align="center">0.9968</td>
<td align="center">1.003</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">0.9999</td>
<td align="center">0.9965</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.936</td>
<td align="center">0.9407</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.06</td>
<td align="center">1.056</td>
<td align="center">1.065</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9907</td>
<td align="center">0.9867</td>
<td align="center">0.9949</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">0.9565</td>
<td align="center">0.9541</td>
<td align="center">0.9588</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.122</td>
<td align="center">1.015</td>
<td align="center">1.24</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.029</td>
<td align="center">0.9913</td>
<td align="center">1.067</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9805</td>
<td align="center">0.9632</td>
<td align="center">0.9976</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9937</td>
<td align="center">0.9832</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.003</td>
<td align="center">0.9947</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9964</td>
<td align="center">0.99</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1.001</td>
<td align="center">0.9959</td>
<td align="center">1.007</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9989</td>
<td align="center">0.9941</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9949</td>
<td align="center">0.9905</td>
<td align="center">0.9994</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9906</td>
<td align="center">0.9863</td>
<td align="center">0.9951</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9469</td>
<td align="center">0.9437</td>
<td align="center">0.95</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8222</td>
<td align="center">0.7143</td>
<td align="center">0.945</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9445</td>
<td align="center">0.8925</td>
<td align="center">0.9979</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9893</td>
<td align="center">0.9641</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9936</td>
<td align="center">0.9782</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9952</td>
<td align="center">0.9835</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.008</td>
<td align="center">0.9979</td>
<td align="center">1.019</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.005</td>
<td align="center">0.9968</td>
<td align="center">1.014</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.005</td>
<td align="center">0.9981</td>
<td align="center">1.012</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.9957</td>
<td align="center">0.99</td>
<td align="center">1.002</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.999</td>
<td align="center">0.9936</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9809</td>
<td align="center">0.978</td>
<td align="center">0.9838</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">0.9999</td>
<td align="center">0.9969</td>
<td align="center">1.003</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">0.9884</td>
<td align="center">0.984</td>
<td align="center">0.9926</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">0.9681</td>
<td align="center">0.9619</td>
<td align="center">0.9742</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">0.9417</td>
<td align="center">0.9331</td>
<td align="center">0.9507</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.8737</td>
<td align="center">0.8643</td>
<td align="center">0.8833</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.046</td>
<td align="center">1.045</td>
<td align="center">1.047</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.015</td>
<td align="center">1.012</td>
<td align="center">1.017</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-1" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
</div>
<div id="marginal-effect-plots-1" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-1.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-2.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-3.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-4.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-5.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-6.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-7.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-8.png" alt="plot of chunk unnamed-chunk-23" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-23-9.png" alt="plot of chunk unnamed-chunk-23" /></p>
</div>
<div id="coefficient-plot-1" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-24-1.png" alt="plot of chunk unnamed-chunk-24" /></p>
</div>
<div id="diagnostics-1" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-1" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-25-1.png" alt="plot of chunk unnamed-chunk-25" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-25-2.png" alt="plot of chunk unnamed-chunk-25" /></p>
</div>
<div id="rhat-1" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-26-1.png" alt="plot of chunk unnamed-chunk-26" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-1" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-27-1.png" alt="plot of chunk unnamed-chunk-27" /></p>
</div>
<div id="trace-plots-1" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-1" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/m2_children_linear_no_diff.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="m2_children_linear_no_diff.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="m3_children_linear" class="section level2 tab-content">
<h2><em>m3</em>: Sibling comparison, linear paternal age effect</h2>
<p>Here, we compared siblings by including a random intercept for the family, and we modelled a linear effect for paternal age differences among siblings.</p>
<div id="model-summary-2" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-2" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 2 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help.
## See http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ paternalage + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 1408177) 
## Samples: 6 chains, each with iter = 800; warmup = 300; thin = 1; 
##          total post-warmup samples = 3000
##     ICs: LOO = Not computed; WAIC = Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 884975) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01        169 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.73      0.00     0.72     0.74       3000
## paternalage               -0.05      0.00    -0.06    -0.05       3000
## birth_cohort1950M1955      0.00      0.00     0.00     0.00       3000
## birth_cohort1955M1960      0.00      0.00     0.00     0.01       3000
## male1                     -0.06      0.00    -0.07    -0.06       3000
## maternalage.factor1420     0.06      0.00     0.05     0.06       3000
## maternalage.factor3561     0.00      0.00    -0.01     0.00       3000
## paternalage.mean           0.01      0.00     0.00     0.01       3000
## paternal_loss01            0.11      0.05     0.01     0.22       3000
## paternal_loss15            0.03      0.02    -0.01     0.07       3000
## paternal_loss510          -0.02      0.01    -0.03     0.00       3000
## paternal_loss1015          0.00      0.01    -0.01     0.01       3000
## paternal_loss1520          0.00      0.00     0.00     0.01       3000
## paternal_loss2025          0.00      0.00    -0.01     0.00       3000
## paternal_loss2530          0.00      0.00     0.00     0.01       3000
## paternal_loss3035          0.00      0.00     0.00     0.01       3000
## paternal_loss3540          0.00      0.00    -0.01     0.00       3000
## paternal_loss4045         -0.01      0.00    -0.01     0.00       3000
## paternal_lossunclear      -0.06      0.00    -0.06    -0.05       3000
## maternal_loss01           -0.20      0.07    -0.34    -0.06       3000
## maternal_loss15           -0.06      0.03    -0.11     0.00       3000
## maternal_loss510          -0.01      0.01    -0.04     0.02       3000
## maternal_loss1015         -0.01      0.01    -0.02     0.01       3000
## maternal_loss1520          0.00      0.01    -0.02     0.01       3000
## maternal_loss2025          0.01      0.01     0.00     0.02       3000
## maternal_loss2530          0.01      0.00     0.00     0.01       3000
## maternal_loss3035          0.01      0.00     0.00     0.01       3000
## maternal_loss3540          0.00      0.00    -0.01     0.00       3000
## maternal_loss4045          0.00      0.00    -0.01     0.00       3000
## maternal_lossunclear      -0.02      0.00    -0.02    -0.02       3000
## older_siblings1            0.02      0.00     0.01     0.02       3000
## older_siblings2            0.02      0.00     0.02     0.03       3000
## older_siblings3            0.02      0.00     0.01     0.03       3000
## older_siblings4            0.00      0.01    -0.01     0.01       3000
## older_siblings5P          -0.05      0.01    -0.07    -0.04       3000
## nr.siblings                0.04      0.00     0.04     0.04       3000
## last_born1                 0.01      0.00     0.01     0.01       3000
##                        Rhat
## Intercept                 1
## paternalage               1
## birth_cohort1950M1955     1
## birth_cohort1955M1960     1
## male1                     1
## maternalage.factor1420    1
## maternalage.factor3561    1
## paternalage.mean          1
## paternal_loss01           1
## paternal_loss15           1
## paternal_loss510          1
## paternal_loss1015         1
## paternal_loss1520         1
## paternal_loss2025         1
## paternal_loss2530         1
## paternal_loss3035         1
## paternal_loss3540         1
## paternal_loss4045         1
## paternal_lossunclear      1
## maternal_loss01           1
## maternal_loss15           1
## maternal_loss510          1
## maternal_loss1015         1
## maternal_loss1520         1
## maternal_loss2025         1
## maternal_loss2530         1
## maternal_loss3035         1
## maternal_loss3540         1
## maternal_loss4045         1
## maternal_lossunclear      1
## older_siblings1           1
## older_siblings2           1
## older_siblings3           1
## older_siblings4           1
## older_siblings5P          1
## nr.siblings               1
## last_born1                1
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-2" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">2.077</td>
<td align="center">2.06</td>
<td align="center">2.096</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage</strong></td>
<td align="center">0.9485</td>
<td align="center">0.941</td>
<td align="center">0.9558</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.001</td>
<td align="center">0.9977</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.002</td>
<td align="center">0.9985</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.9361</td>
<td align="center">0.9407</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.059</td>
<td align="center">1.054</td>
<td align="center">1.063</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9994</td>
<td align="center">0.9948</td>
<td align="center">1.004</td>
</tr>
<tr class="even">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.006</td>
<td align="center">0.9981</td>
<td align="center">1.014</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.122</td>
<td align="center">1.011</td>
<td align="center">1.241</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.032</td>
<td align="center">0.9945</td>
<td align="center">1.071</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9835</td>
<td align="center">0.9663</td>
<td align="center">1.001</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9961</td>
<td align="center">0.986</td>
<td align="center">1.006</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">1.005</td>
<td align="center">0.9968</td>
<td align="center">1.012</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.9983</td>
<td align="center">0.9919</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1.003</td>
<td align="center">0.9978</td>
<td align="center">1.009</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">1</td>
<td align="center">0.9953</td>
<td align="center">1.005</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.996</td>
<td align="center">0.9916</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9915</td>
<td align="center">0.9869</td>
<td align="center">0.9961</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9462</td>
<td align="center">0.943</td>
<td align="center">0.9493</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.8195</td>
<td align="center">0.7099</td>
<td align="center">0.9387</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9455</td>
<td align="center">0.8936</td>
<td align="center">0.9998</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9906</td>
<td align="center">0.9648</td>
<td align="center">1.017</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9942</td>
<td align="center">0.9784</td>
<td align="center">1.01</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.9955</td>
<td align="center">0.9837</td>
<td align="center">1.007</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.009</td>
<td align="center">0.9988</td>
<td align="center">1.019</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.006</td>
<td align="center">0.9972</td>
<td align="center">1.014</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.006</td>
<td align="center">0.9986</td>
<td align="center">1.013</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.9961</td>
<td align="center">0.9903</td>
<td align="center">1.002</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9993</td>
<td align="center">0.994</td>
<td align="center">1.005</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9798</td>
<td align="center">0.9769</td>
<td align="center">0.9826</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.018</td>
<td align="center">1.013</td>
<td align="center">1.022</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.023</td>
<td align="center">1.016</td>
<td align="center">1.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.016</td>
<td align="center">1.007</td>
<td align="center">1.026</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.001</td>
<td align="center">0.988</td>
<td align="center">1.014</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.949</td>
<td align="center">0.9335</td>
<td align="center">0.9652</td>
</tr>
<tr class="even">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.038</td>
<td align="center">1.036</td>
<td align="center">1.04</td>
</tr>
<tr class="odd">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.008</td>
<td align="center">1.014</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-2" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.93</td>
<td align="center">[1.92;1.94]</td>
<td align="center">[1.92;1.93]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.83</td>
<td align="center">[1.82;1.84]</td>
<td align="center">[1.82;1.83]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-5.14</td>
<td align="center">[-5.90;-4.42]</td>
<td align="center">[-5.63;-4.66]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.95</td>
<td align="center">[0.94;0.96]</td>
<td align="center">[0.94;0.95]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-2" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-1.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-2.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-3.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-4.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-5.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-6.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-7.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-8.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-9.png" alt="plot of chunk unnamed-chunk-34" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-34-10.png" alt="plot of chunk unnamed-chunk-34" /></p>
</div>
<div id="coefficient-plot-2" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-35-1.png" alt="plot of chunk unnamed-chunk-35" /></p>
</div>
<div id="diagnostics-2" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-2" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-36-1.png" alt="plot of chunk unnamed-chunk-36" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-36-2.png" alt="plot of chunk unnamed-chunk-36" /></p>
</div>
<div id="rhat-2" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-37-1.png" alt="plot of chunk unnamed-chunk-37" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-2" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-38-1.png" alt="plot of chunk unnamed-chunk-38" /></p>
</div>
<div id="trace-plots-2" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-2" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/m3_children_linear.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="m3_children_linear.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="m4_children_nonlinear" class="section level2 tab-content">
<h2><em>m4</em>: Sibling comparison, nonlinear paternal age effect</h2>
<p>Here, we compared siblings by including a random intercept for the family, and we modelled a possibly nonlinear effect for paternal age differences among siblings.</p>
<div id="model-summary-3" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="full-summary-3" class="section level4">
<h4>Full summary</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_summary =<span class="st"> </span><span class="kw">summary</span>(model, <span class="dt">use_cache =</span> <span class="ot">FALSE</span>, <span class="dt">priors =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning: There were 89 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help.
## See http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(model_summary)</code></pre></div>
<pre><code>##  Family: poisson(log) 
## Formula: children ~ s(paternalage) + birth_cohort + male + maternalage.factor + paternalage.mean + paternal_loss + maternal_loss + older_siblings + nr.siblings + last_born + (1 | idParents) 
##    Data: model_data (Number of observations: 1408177) 
## Samples: 6 chains, each with iter = 900; warmup = 450; thin = 1; 
##          total post-warmup samples = 2700
##     ICs: LOO = Not computed; WAIC = Not computed
##  
## Priors: 
## b ~ normal(0,5)
## sd ~ student_t(3, 0, 5)
## sds ~ student_t(3, 0, 10)
## 
## Smooth Terms: 
##                     Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sds(spaternalage_1)     0.13      0.06     0.06      0.3        175 1.03
## 
## Group-Level Effects: 
## ~idParents (Number of levels: 884975) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)        0         0        0     0.01        214 1.02
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Eff.Sample
## Intercept                  0.56      0.01     0.53     0.59       1892
## birth_cohort1950M1955      0.00      0.00     0.00     0.00       2700
## birth_cohort1955M1960      0.00      0.00     0.00     0.01       2700
## male1                     -0.06      0.00    -0.07    -0.06       1576
## maternalage.factor1420     0.05      0.00     0.04     0.05       2700
## maternalage.factor3561    -0.01      0.00    -0.01     0.00       2700
## paternalage.mean           0.01      0.00     0.00     0.02       1924
## paternal_loss01            0.10      0.05    -0.01     0.21       2700
## paternal_loss15            0.02      0.02    -0.01     0.06       2700
## paternal_loss510          -0.02      0.01    -0.04    -0.01       2700
## paternal_loss1015         -0.01      0.01    -0.02     0.00       2700
## paternal_loss1520          0.00      0.00    -0.01     0.01       2700
## paternal_loss2025         -0.01      0.00    -0.01     0.00       2700
## paternal_loss2530          0.00      0.00    -0.01     0.01       2700
## paternal_loss3035          0.00      0.00    -0.01     0.00       2700
## paternal_loss3540          0.00      0.00    -0.01     0.00       2700
## paternal_loss4045         -0.01      0.00    -0.01     0.00       2700
## paternal_lossunclear      -0.06      0.00    -0.06    -0.06       2700
## maternal_loss01           -0.20      0.07    -0.35    -0.05       2700
## maternal_loss15           -0.06      0.03    -0.12     0.00       2700
## maternal_loss510          -0.01      0.01    -0.04     0.01       2700
## maternal_loss1015         -0.01      0.01    -0.02     0.01       2700
## maternal_loss1520         -0.01      0.01    -0.02     0.01       2700
## maternal_loss2025          0.01      0.01     0.00     0.02       2700
## maternal_loss2530          0.00      0.00     0.00     0.01       2700
## maternal_loss3035          0.00      0.00     0.00     0.01       2700
## maternal_loss3540          0.00      0.00    -0.01     0.00       2700
## maternal_loss4045          0.00      0.00    -0.01     0.00       2700
## maternal_lossunclear      -0.02      0.00    -0.02    -0.02       2700
## older_siblings1            0.02      0.00     0.02     0.03       1799
## older_siblings2            0.03      0.00     0.02     0.04       1411
## older_siblings3            0.02      0.01     0.01     0.03       1872
## older_siblings4            0.01      0.01    -0.01     0.02       1342
## older_siblings5P          -0.05      0.01    -0.07    -0.03       1829
## nr.siblings                0.04      0.00     0.04     0.04       1829
## last_born1                 0.01      0.00     0.01     0.01       2166
## spaternalage_1            -0.04      0.02    -0.09     0.00        631
##                        Rhat
## Intercept              1.00
## birth_cohort1950M1955  1.00
## birth_cohort1955M1960  1.00
## male1                  1.00
## maternalage.factor1420 1.01
## maternalage.factor3561 1.00
## paternalage.mean       1.00
## paternal_loss01        1.00
## paternal_loss15        1.00
## paternal_loss510       1.00
## paternal_loss1015      1.01
## paternal_loss1520      1.01
## paternal_loss2025      1.00
## paternal_loss2530      1.00
## paternal_loss3035      1.00
## paternal_loss3540      1.00
## paternal_loss4045      1.01
## paternal_lossunclear   1.01
## maternal_loss01        1.00
## maternal_loss15        1.00
## maternal_loss510       1.00
## maternal_loss1015      1.01
## maternal_loss1520      1.00
## maternal_loss2025      1.00
## maternal_loss2530      1.00
## maternal_loss3035      1.00
## maternal_loss3540      1.00
## maternal_loss4045      1.00
## maternal_lossunclear   1.00
## older_siblings1        1.00
## older_siblings2        1.00
## older_siblings3        1.00
## older_siblings4        1.00
## older_siblings5P       1.00
## nr.siblings            1.00
## last_born1             1.00
## spaternalage_1         1.01
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="table-of-fixed-effects-3" class="section level4">
<h4>Table of fixed effects</h4>
<p>Estimates are <code>exp(b)</code>. When they are referring to the hurdle (hu) component, or a dichotomous outcome, they are odds ratios, when they are referring to a Poisson component, they are hazard ratios. In both cases, they are presented with 95% credibility intervals. To see the effects on the response scale (probability or number of children), consult the marginal effect plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fixed_eff =<span class="st"> </span><span class="kw">data.frame</span>(model_summary$fixed, <span class="dt">check.names =</span> F)
fixed_eff$Est.Error =<span class="st"> </span>fixed_eff$Eff.Sample =<span class="st"> </span>fixed_eff$Rhat =<span class="st"> </span><span class="ot">NULL</span>
fixed_eff$<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$Estimate)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span>)
fixed_eff$<span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(fixed_eff$<span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span>)
fixed_eff =<span class="st"> </span>fixed_eff %&gt;%<span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Odds/hazard ratio</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR low 95%</span><span class="st">`</span>, <span class="st">`</span><span class="dt">OR/HR high 95%</span><span class="st">`</span>)
pander::<span class="kw">pander</span>(fixed_eff)</code></pre></div>
<table>
<colgroup>
<col width="35%" />
<col width="24%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Odds/hazard ratio</th>
<th align="center">OR/HR low 95%</th>
<th align="center">OR/HR high 95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Intercept</strong></td>
<td align="center">1.751</td>
<td align="center">1.703</td>
<td align="center">1.798</td>
</tr>
<tr class="even">
<td align="center"><strong>birth_cohort1950M1955</strong></td>
<td align="center">1.001</td>
<td align="center">0.9982</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>birth_cohort1955M1960</strong></td>
<td align="center">1.003</td>
<td align="center">0.9995</td>
<td align="center">1.006</td>
</tr>
<tr class="even">
<td align="center"><strong>male1</strong></td>
<td align="center">0.9384</td>
<td align="center">0.9362</td>
<td align="center">0.9406</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternalage.factor1420</strong></td>
<td align="center">1.046</td>
<td align="center">1.04</td>
<td align="center">1.051</td>
</tr>
<tr class="even">
<td align="center"><strong>maternalage.factor3561</strong></td>
<td align="center">0.9919</td>
<td align="center">0.9873</td>
<td align="center">0.9965</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternalage.mean</strong></td>
<td align="center">1.008</td>
<td align="center">0.9997</td>
<td align="center">1.016</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss01</strong></td>
<td align="center">1.105</td>
<td align="center">0.9922</td>
<td align="center">1.233</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss15</strong></td>
<td align="center">1.025</td>
<td align="center">0.9859</td>
<td align="center">1.063</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss510</strong></td>
<td align="center">0.9766</td>
<td align="center">0.9599</td>
<td align="center">0.993</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss1015</strong></td>
<td align="center">0.9895</td>
<td align="center">0.9796</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss1520</strong></td>
<td align="center">0.9994</td>
<td align="center">0.9912</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss2025</strong></td>
<td align="center">0.994</td>
<td align="center">0.9875</td>
<td align="center">1.001</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss2530</strong></td>
<td align="center">1</td>
<td align="center">0.9949</td>
<td align="center">1.006</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss3035</strong></td>
<td align="center">0.9984</td>
<td align="center">0.9935</td>
<td align="center">1.003</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_loss3540</strong></td>
<td align="center">0.9954</td>
<td align="center">0.9909</td>
<td align="center">0.9996</td>
</tr>
<tr class="odd">
<td align="center"><strong>paternal_loss4045</strong></td>
<td align="center">0.9915</td>
<td align="center">0.987</td>
<td align="center">0.996</td>
</tr>
<tr class="even">
<td align="center"><strong>paternal_lossunclear</strong></td>
<td align="center">0.9423</td>
<td align="center">0.9393</td>
<td align="center">0.9456</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss01</strong></td>
<td align="center">0.818</td>
<td align="center">0.7053</td>
<td align="center">0.9485</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss15</strong></td>
<td align="center">0.9428</td>
<td align="center">0.8905</td>
<td align="center">0.9974</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss510</strong></td>
<td align="center">0.9886</td>
<td align="center">0.9638</td>
<td align="center">1.015</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss1015</strong></td>
<td align="center">0.9935</td>
<td align="center">0.9779</td>
<td align="center">1.008</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss1520</strong></td>
<td align="center">0.995</td>
<td align="center">0.983</td>
<td align="center">1.007</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss2025</strong></td>
<td align="center">1.008</td>
<td align="center">0.9977</td>
<td align="center">1.018</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss2530</strong></td>
<td align="center">1.005</td>
<td align="center">0.9963</td>
<td align="center">1.013</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss3035</strong></td>
<td align="center">1.004</td>
<td align="center">0.9972</td>
<td align="center">1.011</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_loss3540</strong></td>
<td align="center">0.9953</td>
<td align="center">0.9895</td>
<td align="center">1.002</td>
</tr>
<tr class="even">
<td align="center"><strong>maternal_loss4045</strong></td>
<td align="center">0.9987</td>
<td align="center">0.9932</td>
<td align="center">1.004</td>
</tr>
<tr class="odd">
<td align="center"><strong>maternal_lossunclear</strong></td>
<td align="center">0.9788</td>
<td align="center">0.976</td>
<td align="center">0.9817</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings1</strong></td>
<td align="center">1.022</td>
<td align="center">1.018</td>
<td align="center">1.026</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings2</strong></td>
<td align="center">1.029</td>
<td align="center">1.021</td>
<td align="center">1.036</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings3</strong></td>
<td align="center">1.022</td>
<td align="center">1.012</td>
<td align="center">1.033</td>
</tr>
<tr class="odd">
<td align="center"><strong>older_siblings4</strong></td>
<td align="center">1.006</td>
<td align="center">0.9932</td>
<td align="center">1.021</td>
</tr>
<tr class="even">
<td align="center"><strong>older_siblings5P</strong></td>
<td align="center">0.9521</td>
<td align="center">0.9358</td>
<td align="center">0.9686</td>
</tr>
<tr class="odd">
<td align="center"><strong>nr.siblings</strong></td>
<td align="center">1.037</td>
<td align="center">1.036</td>
<td align="center">1.039</td>
</tr>
<tr class="even">
<td align="center"><strong>last_born1</strong></td>
<td align="center">1.011</td>
<td align="center">1.009</td>
<td align="center">1.014</td>
</tr>
<tr class="odd">
<td align="center"><strong>spaternalage_1</strong></td>
<td align="center">0.9599</td>
<td align="center">0.9169</td>
<td align="center">0.9952</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="paternal-age-effect-3" class="section level3">
<h3>Paternal age effect</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pander</span>(<span class="kw">paternal_age_10y_effect</span>(model))</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">effect</th>
<th align="center">median_estimate</th>
<th align="center">ci_95</th>
<th align="center">ci_80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">estimate father 25y</td>
<td align="center">1.94</td>
<td align="center">[1.93;1.95]</td>
<td align="center">[1.94;1.95]</td>
</tr>
<tr class="even">
<td align="center">estimate father 35y</td>
<td align="center">1.81</td>
<td align="center">[1.80;1.82]</td>
<td align="center">[1.80;1.82]</td>
</tr>
<tr class="odd">
<td align="center">percentage change</td>
<td align="center">-6.84</td>
<td align="center">[-7.66;-6.03]</td>
<td align="center">[-7.37;-6.31]</td>
</tr>
<tr class="even">
<td align="center">OR/IRR</td>
<td align="center">0.96</td>
<td align="center">[0.92;1.00]</td>
<td align="center">[0.94;0.98]</td>
</tr>
</tbody>
</table>
</div>
<div id="marginal-effect-plots-3" class="section level3">
<h3>Marginal effect plots</h3>
<p>In these marginal effect plots, we set all predictors except the one shown on the X axis to their mean and in the case of factors to their reference level. We then plot the estimated association between the X axis predictor and the outcome on the response scale (e.g. probability of survival/marriage or number of children).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.brmsMarginalEffects_shades</span>(
    <span class="dt">x =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>)),
    <span class="dt">y =</span> <span class="kw">marginal_effects</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>)), 
    <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-1.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-2.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-3.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-4.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-5.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-6.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-7.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-8.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-9.png" alt="plot of chunk unnamed-chunk-45" /><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-45-10.png" alt="plot of chunk unnamed-chunk-45" /></p>
</div>
<div id="coefficient-plot-3" class="section level3">
<h3>Coefficient plot</h3>
<p>Here, we plotted the 95% posterior densities for the unexponentiated model coefficients (<code>b_</code>). The darkly shaded area represents the 50% credibility interval, the dark line represent the posterior mean estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.matrix</span>(model$fit), <span class="dt">regex_pars =</span> <span class="st">&quot;b_[^I]&quot;</span>, <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.50</span>, <span class="dt">prob_outer =</span> <span class="fl">0.95</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior densities with means and 50% intervals&quot;</span>) +<span class="st"> </span>analysis_theme +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Coefficient size&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-46-1.png" alt="plot of chunk unnamed-chunk-46" /></p>
</div>
<div id="diagnostics-3" class="section level3 tab-content">
<h3>Diagnostics</h3>
<p>These plots were made to diagnose misfit and nonconvergence.</p>
<div id="posterior-predictive-checks-3" class="section level4">
<h4>Posterior predictive checks</h4>
<p>In posterior predictive checks, we test whether we can approximately reproduce the real data distribution from our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;dens_overlay&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-47-1.png" alt="plot of chunk unnamed-chunk-47" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brms::<span class="kw">pp_check</span>(model, <span class="dt">re_formula =</span> <span class="ot">NA</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-47-2.png" alt="plot of chunk unnamed-chunk-47" /></p>
</div>
<div id="rhat-3" class="section level4">
<h4>Rhat</h4>
<p>Did the 6 chains converge?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b_[^I]&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;rhat&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-48-1.png" alt="plot of chunk unnamed-chunk-48" /></p>
</div>
<div id="effective-sample-size-over-average-sample-size-3" class="section level4">
<h4>Effective sample size over average sample size</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanplot</span>(model, <span class="dt">pars =</span> <span class="st">&quot;^b&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;neff_hist&#39;</span>)</code></pre></div>
<p><img src="/Volumes/jet/paternal_age_genealogies/2_swed_main_models/figure/unnamed-chunk-49-1.png" alt="plot of chunk unnamed-chunk-49" /></p>
</div>
<div id="trace-plots-3" class="section level4">
<h4>Trace plots</h4>
<p>Trace plots are only shown in the case of nonconvergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">any</span>( <span class="kw">summary</span>(model)$fixed[,<span class="st">&quot;Rhat&quot;</span>] &gt;<span class="st"> </span><span class="fl">1.1</span>)) { <span class="co"># only do traceplots if not converged</span>
    <span class="kw">plot</span>(model, <span class="dt">N =</span> <span class="dv">3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)
}</code></pre></div>
</div>
<div id="filecluster-script-name-3" class="section level4">
<h4>File/cluster script name</h4>
<p>This model was stored in the file: coefs/swed/m4_children_nonlinear.rds.</p>
<p>Click the following link to see the script used to generate this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opts_chunk$<span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">FALSE</span>)
clusterscript =<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">basename</span>(model_filename), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.rds&quot;</span>,<span class="st">&quot;.html&quot;</span>)
<span class="kw">cat</span>(<span class="st">&quot;[Cluster script](&quot;</span> , clusterscript, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><a href="m4_children_nonlinear.html">Cluster script</a></p>
</div>
</div>
</div>
<div id="model-comparison" class="section level2">
<h2>Model comparison</h2>
<p>We compare the four models using an approximate leave-one-out cross-validation information criterion as implemented in <code>brms</code> and <code>loo</code> and the Watanabe-Akaike information criterion.</p>
<div id="approximate-leave-one-out-loo-cross-validation" class="section level3">
<h3>Approximate leave-one-out (LOO) cross-validation</h3>
<table style="width:38%;">
<colgroup>
<col width="19%" />
<col width="11%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">LOOIC</th>
<th align="center">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>m1</strong></td>
<td align="center">415187</td>
<td align="center">388.2</td>
</tr>
<tr class="even">
<td align="center"><strong>m2</strong></td>
<td align="center">415196</td>
<td align="center">388</td>
</tr>
<tr class="odd">
<td align="center"><strong>m3</strong></td>
<td align="center">415186</td>
<td align="center">388.1</td>
</tr>
<tr class="even">
<td align="center"><strong>m4</strong></td>
<td align="center">415165</td>
<td align="center">387.9</td>
</tr>
<tr class="odd">
<td align="center"><strong>m1 - m2</strong></td>
<td align="center">-9.13</td>
<td align="center">6.31</td>
</tr>
<tr class="even">
<td align="center"><strong>m1 - m3</strong></td>
<td align="center">0.93</td>
<td align="center">0.42</td>
</tr>
<tr class="odd">
<td align="center"><strong>m1 - m4</strong></td>
<td align="center">22.09</td>
<td align="center">9.37</td>
</tr>
<tr class="even">
<td align="center"><strong>m2 - m3</strong></td>
<td align="center">10.07</td>
<td align="center">6.47</td>
</tr>
<tr class="odd">
<td align="center"><strong>m2 - m4</strong></td>
<td align="center">31.22</td>
<td align="center">11.3</td>
</tr>
<tr class="even">
<td align="center"><strong>m3 - m4</strong></td>
<td align="center">21.15</td>
<td align="center">9.36</td>
</tr>
</tbody>
</table>
</div>
<div id="watanabe-akaike-information-criterion" class="section level3">
<h3>Watanabe-Akaike information criterion</h3>
<table style="width:39%;">
<colgroup>
<col width="19%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">WAIC</th>
<th align="center">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>m1</strong></td>
<td align="center">415187</td>
<td align="center">388.2</td>
</tr>
<tr class="even">
<td align="center"><strong>m2</strong></td>
<td align="center">415196</td>
<td align="center">388</td>
</tr>
<tr class="odd">
<td align="center"><strong>m3</strong></td>
<td align="center">415186</td>
<td align="center">388.1</td>
</tr>
<tr class="even">
<td align="center"><strong>m4</strong></td>
<td align="center">415165</td>
<td align="center">387.9</td>
</tr>
<tr class="odd">
<td align="center"><strong>m1 - m2</strong></td>
<td align="center">-9.1</td>
<td align="center">6.31</td>
</tr>
<tr class="even">
<td align="center"><strong>m1 - m3</strong></td>
<td align="center">0.89</td>
<td align="center">0.42</td>
</tr>
<tr class="odd">
<td align="center"><strong>m1 - m4</strong></td>
<td align="center">22.04</td>
<td align="center">9.37</td>
</tr>
<tr class="even">
<td align="center"><strong>m2 - m3</strong></td>
<td align="center">9.98</td>
<td align="center">6.47</td>
</tr>
<tr class="odd">
<td align="center"><strong>m2 - m4</strong></td>
<td align="center">31.14</td>
<td align="center">11.3</td>
</tr>
<tr class="even">
<td align="center"><strong>m3 - m4</strong></td>
<td align="center">21.16</td>
<td align="center">9.36</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>
</body>
</html>
