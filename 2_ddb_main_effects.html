<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Historical Sweden Main Effects</title>

<script src="library/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.1/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<script src="library/auto_tab_first_section.js"></script>
</head>

<body>
<div style="width:100%;height:200px;background-image:url('library/header/ddb.jpg');background-size:cover;"></div>
<div class="container-fluid main-container"><div class="row"><div class="col-md-4"><a href="index.html"><i class="glyphicon glyphicon-th-list"></i> Back to index</a></div></div></div>

<div class="container-fluid main-container">


<div id="header">
</div>


<div id="demographic-data-base-ancient-sweden-main-effects" class="section level1 tab-content">
<h1>Demographic data base (ancient Sweden) main effects</h1>
<div id="loading-details" class="section level3 accordion">
<h3>Loading details</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(data.table); <span class="kw">library</span>(ggplot2); <span class="kw">library</span>(knitr); <span class="kw">library</span>(lme4);   

opts_chunk$<span class="kw">set</span>(<span class="dt">warning=</span><span class="ot">TRUE</span>, <span class="dt">cache=</span><span class="ot">TRUE</span>,<span class="dt">tidy=</span><span class="ot">FALSE</span>,<span class="dt">autodep=</span><span class="ot">TRUE</span>,<span class="dt">dev=</span><span class="kw">c</span>(<span class="st">&#39;png&#39;</span>,<span class="st">&#39;pdf&#39;</span>),<span class="dt">fig.width=</span><span class="dv">20</span>,<span class="dt">fig.height=</span><span class="fl">12.5</span>,<span class="dt">out.width=</span><span class="st">&#39;1440px&#39;</span>,<span class="dt">out.height=</span><span class="st">&#39;900px&#39;</span>,<span class="dt">cache.extra=</span><span class="kw">file.info</span>(<span class="st">&#39;ddb.rdata&#39;</span>)[, <span class="st">&#39;mtime&#39;</span>])

<span class="kw">source</span>(<span class="st">&quot;0__helpers.R&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ddb.rdata&quot;</span>)</code></pre>
</div>
<div id="analysis-description" class="section level2">
<h2>Analysis description</h2>
<div id="data-subset" class="section level3">
<h3>Data subset</h3>
<p>The <code>ddb.1</code> dataset contains only those participants where paternal age is known, the birthdate is between 1760 and 1880 and the marriage is known (meaning we know when it started and how it ended by spousal death). In known marriages we can assume that missing death dates for the kids mean that they migrated out.</p>
</div>
<div id="model-description" class="section level3">
<h3>Model description</h3>
<p>All of the following models have the following in common:</p>
<div id="optimizer-settings" class="section level4">
<h4>Optimizer settings</h4>
<p>Bobyqa is fairly robust to convergence failures. In addition to using Bobyqa, we center some variables that otherwise lead to large eigenvalues.</p>
<pre class="sourceCode r"><code class="sourceCode r">control_defaults =<span class="st"> </span><span class="kw">glmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>)</code></pre>
</div>
<div id="covariates" class="section level4">
<h4>Covariates</h4>
<p>We control for birth.cohort (birth years in five equally large bins), male sex and region.</p>
</div>
<div id="model-stratification" class="section level4">
<h4>Model stratification</h4>
<p>We added random intercepts for each family (father-mother dyad). We then controlled for the average paternal age in the family. Hence, the paternal age effects in the plot are split into those between families and those within families or between siblings. The relevant effect for our hypothesized mechanism, de novo mutations, is paternal age between siblings.</p>
</div>
<div id="episodes-of-selection" class="section level4">
<h4>Episodes of selection</h4>
<p>Here, episodes of selection refers to survival, mating success, reproductive success. To steer clear of sacrificial pseudo-replication, we make sure that each effect cannot be explained by the episode of selection preceding it. At its simplest, we check for effect on survival to reproduction only among those who lived to their first birthday. In later models, we look for an effect on number of children only among those who married and control their number of spouses.</p>
</div>
</div>
</div>
<div id="survival-to-first-year" class="section level2">
<h2>Survival to first year</h2>
<pre class="sourceCode r"><code class="sourceCode r">Survive_infancy &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    survive1y ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults )
<span class="kw">summary</span>(Survive_infancy)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## survive1y ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     region + (1 | idParents)
##    Data: ddb.1
## Control: control_defaults
## 
##      AIC      BIC   logLik deviance df.resid 
##   134032   134153   -67004   134008   179363 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.698  0.234  0.281  0.347  1.632 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 1.05     1.02    
## Number of obs: 179375, groups:  idParents, 49321
## 
## Fixed effects:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              2.215408   0.032251    68.7  &lt; 2e-16 ***
## birth.cohort(1824,1845]  0.266370   0.026670    10.0  &lt; 2e-16 ***
## birth.cohort(1845,1860]  0.469544   0.028564    16.4  &lt; 2e-16 ***
## birth.cohort(1860,1872]  0.425733   0.027945    15.2  &lt; 2e-16 ***
## birth.cohort(1872,1880]  0.442295   0.029173    15.2  &lt; 2e-16 ***
## male                    -0.214666   0.015554   -13.8  &lt; 2e-16 ***
## paternalage.mean         0.001801   0.014612     0.1     0.90    
## paternalage.diff        -0.526433   0.016529   -31.8  &lt; 2e-16 ***
## regionLinkopings        -0.000367   0.029137     0.0     0.99    
## regionNorra inlands     -0.239586   0.031726    -7.6  4.3e-14 ***
## regionSundsvalls        -0.271492   0.027598    -9.8  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(182 b.(184 b.(186 b.(187 male   ptrnlg.m ptrnlg.d
## b.(1824,184 -0.485                                                     
## b.(1845,186 -0.484  0.516                                              
## b.(1860,187 -0.498  0.502  0.554                                       
## b.(1872,188 -0.470  0.483  0.499  0.572                                
## male        -0.270 -0.001 -0.004 -0.005 -0.003                         
## paternlg.mn -0.084  0.073  0.064  0.054  0.059  0.001                  
## patrnlg.dff  0.046 -0.083 -0.064 -0.104 -0.122  0.009 -0.013           
## regnLnkpngs -0.652  0.142  0.163  0.181  0.180 -0.001  0.048   -0.039  
## rgnNrrinlnd -0.582  0.119  0.116  0.126  0.109  0.002 -0.026   -0.019  
## rgnSndsvlls -0.564  0.038  0.031 -0.007 -0.044  0.003  0.055    0.022  
##             rgnLnk rgnNri
## b.(1824,184              
## b.(1845,186              
## b.(1860,187              
## b.(1872,188              
## male                     
## paternlg.mn              
## patrnlg.dff              
## regnLnkpngs              
## rgnNrrinlnd  0.567       
## rgnSndsvlls  0.619  0.568</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Survive_infancy_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Survive_infancy)
<span class="kw">plot_fortified_mer</span>(Survive_infancy_coefs, <span class="st">&quot;Surviving infancy / first year&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Survive_1y-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Survive_infancy)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Survive_1y-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
<div id="survival-to-reproductive-age" class="section level2">
<h2>Survival to reproductive age</h2>
<pre class="sourceCode r"><code class="sourceCode r">Survive_reproductive &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    surviveR ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff  +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>, <span class="dt">subset =</span> survive1y ==<span class="st"> </span><span class="ot">TRUE</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults)
<span class="kw">summary</span>(Survive_reproductive)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## surviveR ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     region + (1 | idParents)
##    Data: ddb.1
## Control: control_defaults
##  Subset: survive1y == TRUE
## 
##      AIC      BIC   logLik deviance df.resid 
##    96507    96623   -48242    96483   115951 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.975  0.274  0.337  0.400  1.087 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 0.692    0.832   
## Number of obs: 115963, groups:  idParents, 35494
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               2.3279     0.0349    66.7  &lt; 2e-16 ***
## birth.cohort(1824,1845]   0.1963     0.0312     6.3  3.1e-10 ***
## birth.cohort(1845,1860]  -0.1186     0.0313    -3.8  0.00015 ***
## birth.cohort(1860,1872]  -0.4097     0.0308   -13.3  &lt; 2e-16 ***
## birth.cohort(1872,1880]  -0.5396     0.0330   -16.4  &lt; 2e-16 ***
## male                     -0.1314     0.0178    -7.4  1.4e-13 ***
## paternalage.mean          0.0966     0.0164     5.9  3.5e-09 ***
## paternalage.diff         -0.2425     0.0181   -13.4  &lt; 2e-16 ***
## regionLinkopings         -0.5683     0.0299   -19.0  &lt; 2e-16 ***
## regionNorra inlands      -0.1392     0.0312    -4.5  8.2e-06 ***
## regionSundsvalls         -0.0698     0.0284    -2.5  0.01401 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(182 b.(184 b.(186 b.(187 male   ptrnlg.m ptrnlg.d
## b.(1824,184 -0.528                                                     
## b.(1845,186 -0.577  0.540                                              
## b.(1860,187 -0.593  0.533  0.598                                       
## b.(1872,188 -0.568  0.500  0.540  0.595                                
## male        -0.274 -0.003 -0.002  0.003  0.004                         
## paternlg.mn -0.068  0.063  0.054  0.035  0.027 -0.003                  
## patrnlg.dff  0.068 -0.059 -0.037 -0.081 -0.088  0.001  0.003           
## regnLnkpngs -0.625  0.140  0.195  0.212  0.225  0.007  0.007   -0.043  
## rgnNrrinlnd -0.518  0.110  0.120  0.120  0.111  0.001 -0.036   -0.019  
## rgnSndsvlls -0.479  0.039  0.043 -0.005 -0.004  0.002  0.038    0.011  
##             rgnLnk rgnNri
## b.(1824,184              
## b.(1845,186              
## b.(1860,187              
## b.(1872,188              
## male                     
## paternlg.mn              
## patrnlg.dff              
## regnLnkpngs              
## rgnNrrinlnd  0.522       
## rgnSndsvlls  0.538  0.515</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Survive_reproductive_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Survive_reproductive)
<span class="kw">plot_fortified_mer</span>(Survive_reproductive_coefs, <span class="st">&quot;Surviving to reproductive age / 15 years&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Survive_reproductive-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Survive_reproductive)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Survive_reproductive-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
<div id="ever-married" class="section level2">
<h2>Ever married</h2>
<pre class="sourceCode r"><code class="sourceCode r">Ever_married &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    ever_married ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff  +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>, <span class="dt">subset =</span> surviveR ==<span class="st"> </span>T &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1850</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults )
<span class="kw">summary</span>(Ever_married)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## ever_married ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     region + (1 | idParents)
##    Data: ddb.1
## Control: control_defaults
##  Subset: surviveR == T &amp; byear &lt; 1850
## 
##      AIC      BIC   logLik deviance df.resid 
##    60959    61047   -30470    60939    48697 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -2.535 -0.849  0.495  0.648  1.984 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 0.739    0.86    
## Number of obs: 48707, groups:  idParents, 17347
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               1.0711     0.0364    29.4  &lt; 2e-16 ***
## birth.cohort(1824,1845]  -0.0812     0.0262    -3.1    0.002 ** 
## birth.cohort(1845,1860]  -0.2662     0.0399    -6.7  2.6e-11 ***
## male                     -0.2296     0.0217   -10.6  &lt; 2e-16 ***
## paternalage.mean         -0.0456     0.0193    -2.4    0.018 *  
## paternalage.diff         -0.2110     0.0226    -9.3  &lt; 2e-16 ***
## regionLinkopings         -1.2236     0.0373   -32.8  &lt; 2e-16 ***
## regionNorra inlands       0.0783     0.0394     2.0    0.047 *  
## regionSundsvalls         -0.0389     0.0379    -1.0    0.305    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(182 b.(184 male   ptrnlg.m ptrnlg.d rgnLnk rgnNri
## b.(1824,184 -0.523                                                     
## b.(1845,186 -0.387  0.430                                              
## male        -0.302  0.000 -0.001                                       
## paternlg.mn -0.124  0.094  0.062  0.000                                
## patrnlg.dff  0.139 -0.125 -0.100  0.009  0.003                         
## regnLnkpngs -0.708  0.191  0.174  0.012  0.034   -0.042                
## rgnNrrinlnd -0.628  0.168  0.123 -0.011 -0.007   -0.046    0.558       
## rgnSndsvlls -0.598  0.065  0.065 -0.011  0.061   -0.039    0.556  0.528</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Ever_married_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Ever_married)
<span class="kw">plot_fortified_mer</span>(Ever_married_coefs, <span class="st">&quot;Odds of ever marrying&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Ever_married-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Ever_married)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Ever_married-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
<div id="number-of-children" class="section level2">
<h2>Number of children</h2>
<pre class="sourceCode r"><code class="sourceCode r">Children &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    children ~<span class="st"> </span><span class="kw">center</span>(spouses)*male +<span class="st"> </span>birth.cohort +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff  +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents) +<span class="st"> </span>(<span class="dv">1</span>|idIndividu), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>, <span class="dt">subset =</span> spouses &gt;<span class="st"> </span><span class="dv">0</span> &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1850</span>,
<span class="dt">family =</span> <span class="st">&#39;poisson&#39;</span>, <span class="dt">control =</span> control_defaults )
<span class="kw">summary</span>(Children)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: poisson  ( log )
## Formula: 
## children ~ center(spouses) * male + birth.cohort + paternalage.mean +  
##     paternalage.diff + region + (1 | idParents) + (1 | idIndividu)
##    Data: ddb.1
## Control: control_defaults
##  Subset: spouses &gt; 0 &amp; byear &lt; 1850
## 
##      AIC      BIC   logLik deviance df.resid 
##   150719   150827   -75346   150693    29952 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.7534 -0.6212  0.0523  0.4582  1.4870 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  idIndividu (Intercept) 0.2767   0.526   
##  idParents  (Intercept) 0.0603   0.246   
## Number of obs: 29965, groups:  idIndividu, 29965; idParents, 13542
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              1.13755    0.02014    56.5   &lt;2e-16 ***
## center(spouses)          0.32288    0.01810    17.8   &lt;2e-16 ***
## male                     0.13969    0.02328     6.0    2e-09 ***
## birth.cohort(1824,1845]  0.01078    0.01040     1.0   0.3000    
## birth.cohort(1845,1860] -0.04816    0.01633    -2.9   0.0032 ** 
## paternalage.mean         0.00186    0.00771     0.2   0.8097    
## paternalage.diff        -0.02258    0.00916    -2.5   0.0137 *  
## regionLinkopings        -0.47161    0.01526   -30.9   &lt;2e-16 ***
## regionNorra inlands      0.00965    0.01363     0.7   0.4789    
## regionSundsvalls        -0.31456    0.01374   -22.9   &lt;2e-16 ***
## center(spouses):male     0.01566    0.02593     0.6   0.5459    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) cntr() male   b.(182 b.(184 ptrnlg.m ptrnlg.d rgnLnk
## centr(spss) -0.747                                                     
## male        -0.565  0.650                                              
## b.(1824,184 -0.376  0.003 -0.010                                       
## b.(1845,186 -0.247 -0.002 -0.008  0.402                                
## paternlg.mn -0.089  0.003  0.002  0.095  0.059                         
## patrnlg.dff  0.105  0.007 -0.002 -0.116 -0.074  0.015                  
## regnLnkpngs -0.383 -0.005 -0.008  0.205  0.160  0.035   -0.048         
## rgnNrrinlnd -0.398 -0.019 -0.002  0.189  0.121 -0.006   -0.037    0.490
## rgnSndsvlls -0.342 -0.036 -0.035  0.069  0.048  0.068   -0.037    0.463
## cntr(spss):  0.515 -0.697 -0.925  0.012  0.008 -0.004    0.002    0.009
##             rgnNri rgnSnd
## centr(spss)              
## male                     
## b.(1824,184              
## b.(1845,186              
## paternlg.mn              
## patrnlg.dff              
## regnLnkpngs              
## rgnNrrinlnd              
## rgnSndsvlls  0.510       
## cntr(spss): -0.002  0.039</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Children_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Children)
<span class="kw">plot_fortified_mer</span>(Children_coefs, <span class="st">&quot;Nr. Children (of those who had at least one spouse&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Children-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Children)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Children-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
<div id="number-of-children-surviving-first-year" class="section level2">
<h2>Number of children surviving first year</h2>
<pre class="sourceCode r"><code class="sourceCode r">Children.surviving1y &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    children.surviving1y ~<span class="st">  </span><span class="kw">center</span>(children.wddate) +<span class="st"> </span>birth.cohort +<span class="st"> </span>male +paternalage.mean +<span class="st"> </span>paternalage.diff  +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents) +<span class="st"> </span>(<span class="dv">1</span>|idIndividu), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>, <span class="dt">subset =</span> children &gt;<span class="st"> </span><span class="dv">0</span> &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1850</span>,
    <span class="dt">family =</span> <span class="st">&#39;poisson&#39;</span>, <span class="dt">control =</span> control_defaults )</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Children.surviving1y)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: poisson  ( log )
## Formula: children.surviving1y ~ center(children.wddate) + birth.cohort +  
##     male + paternalage.mean + paternalage.diff + region + (1 |  
##     idParents) + (1 | idIndividu)
##    Data: ddb.1
## Control: control_defaults
##  Subset: children &gt; 0 &amp; byear &lt; 1850
## 
##      AIC      BIC   logLik deviance df.resid 
##    93609    93707   -46792    93585    26278 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -5.998 -0.550  0.031  0.492  0.986 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  idIndividu (Intercept) 0        0       
##  idParents  (Intercept) 0        0       
## Number of obs: 26290, groups:  idIndividu, 26290; idParents, 12597
## 
## Fixed effects:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              0.659040   0.009530    69.2  &lt; 2e-16 ***
## center(children.wddate)  0.170888   0.000890   192.1  &lt; 2e-16 ***
## birth.cohort(1824,1845] -0.010465   0.006584    -1.6     0.11    
## birth.cohort(1845,1860] -0.017722   0.010765    -1.6     0.10 .  
## male                    -0.008060   0.006003    -1.3     0.18    
## paternalage.mean        -0.003583   0.004818    -0.7     0.46    
## paternalage.diff         0.000273   0.006171     0.0     0.96    
## regionLinkopings        -0.076464   0.009803    -7.8  6.2e-15 ***
## regionNorra inlands     -0.047376   0.007691    -6.2  7.3e-10 ***
## regionSundsvalls        -0.085744   0.008530   -10.1  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) cnt(.) b.(182 b.(184 male   ptrnlg.m ptrnlg.d rgnLnk
## cntr(chld.) -0.556                                                     
## b.(1824,184 -0.474 -0.020                                              
## b.(1845,186 -0.300  0.014  0.355                                       
## male        -0.287 -0.059  0.006  0.006                                
## paternlg.mn -0.108 -0.011  0.090  0.056  0.000                         
## patrnlg.dff  0.115  0.024 -0.090 -0.029  0.000  0.027                  
## regnLnkpngs -0.489  0.133  0.186  0.133 -0.021  0.033   -0.034         
## rgnNrrinlnd -0.460 -0.064  0.194  0.105 -0.009 -0.011   -0.028    0.422
## rgnSndsvlls -0.475  0.141  0.046  0.015  0.001  0.066   -0.031    0.382
##             rgnNri
## cntr(chld.)       
## b.(1824,184       
## b.(1845,186       
## male              
## paternlg.mn       
## patrnlg.dff       
## regnLnkpngs       
## rgnNrrinlnd       
## rgnSndsvlls  0.448</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Children.surviving1y_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Children.surviving1y)
<span class="kw">plot_fortified_mer</span>(Children.surviving1y_coefs, <span class="st">&quot;Nr. Children who survive first year (of those who survived infancy&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/children.s1y-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Children.surviving1y)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/children.s1y-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
<div id="number-of-grandchildren" class="section level2">
<h2>Number of grandchildren</h2>
<pre class="sourceCode r"><code class="sourceCode r">Grandchildren.per.Child &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    grandchildren ~<span class="st"> </span><span class="kw">center</span>(children) +<span class="st"> </span>male +paternalage.mean +<span class="st"> </span>paternalage.diff  +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents) +<span class="st"> </span>(<span class="dv">1</span>|idIndividu), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>, <span class="dt">subset =</span> children &gt;<span class="st"> </span><span class="dv">0</span> &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1800</span>,
    <span class="dt">family =</span> <span class="st">&#39;poisson&#39;</span>, <span class="dt">control =</span> control_defaults )
<span class="kw">summary</span>(Grandchildren.per.Child)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: poisson  ( log )
## Formula: grandchildren ~ center(children) + male + paternalage.mean +  
##     paternalage.diff + region + (1 | idParents) + (1 | idIndividu)
##    Data: ddb.1
## Control: control_defaults
##  Subset: children &gt; 0 &amp; byear &lt; 1800
## 
##      AIC      BIC   logLik deviance df.resid 
##    15184    15231    -7584    15168     2514 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.4946 -0.5758  0.0024  0.1512  0.7496 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  idIndividu (Intercept) 1.516    1.231   
##  idParents  (Intercept) 0.464    0.681   
## Number of obs: 2522, groups:  idIndividu, 2522; idParents, 1479
## 
## Fixed effects:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -1.02948    0.08764  -11.75   &lt;2e-16 ***
## center(children)     0.29026    0.01070   27.12   &lt;2e-16 ***
## male                 0.03310    0.06221    0.53     0.59    
## paternalage.mean     0.00189    0.04545    0.04     0.97    
## paternalage.diff     0.02302    0.06749    0.34     0.73    
## regionNorra inlands  1.40774    0.07737   18.19   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) cntr() male   ptrnlg.m ptrnlg.d
## cntr(chldr) -0.500                                
## male        -0.332 -0.027                         
## paternlg.mn -0.164  0.007 -0.017                  
## patrnlg.dff  0.078  0.048  0.054  0.014           
## rgnNrrinlnd -0.571 -0.091 -0.013  0.043    0.008</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Grandchildren.per.Child_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Grandchildren.per.Child)
<span class="kw">plot_fortified_mer</span>(Grandchildren.per.Child_coefs, <span class="st">&quot;Nr. of grandchildren per child&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/GrandchildrenPerChild-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Grandchildren.per.Child)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/GrandchildrenPerChild-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
<div id="any-surviving-children" class="section level2">
<h2>Any surviving children</h2>
<pre class="sourceCode r"><code class="sourceCode r">Any_surviving_children &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    any_surviving_children ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff  +<span class="st"> </span>region +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> ddb<span class="fl">.1</span>,
    <span class="dt">subset =</span> byear &lt;<span class="st"> </span><span class="dv">1850</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults )
<span class="kw">summary</span>(Any_surviving_children)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## any_surviving_children ~ birth.cohort + male + paternalage.mean +  
##     paternalage.diff + region + (1 | idParents)
##    Data: ddb.1
## Control: control_defaults
##  Subset: byear &lt; 1850
## 
##      AIC      BIC   logLik deviance df.resid 
##    84702    84796   -42341    84682    84567 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -2.023 -0.519 -0.287 -0.182  4.564 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 0.992    0.996   
## Number of obs: 84577, groups:  idParents, 24595
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              -0.6402     0.0337   -19.0   &lt;2e-16 ***
## birth.cohort(1824,1845]  -0.0669     0.0239    -2.8   0.0051 ** 
## birth.cohort(1845,1860]  -0.4515     0.0383   -11.8   &lt;2e-16 ***
## male                     -0.0362     0.0189    -1.9   0.0561 .  
## paternalage.mean          0.1248     0.0175     7.1    1e-12 ***
## paternalage.diff         -0.3455     0.0203   -17.0   &lt;2e-16 ***
## regionLinkopings         -1.9447     0.0374   -52.0   &lt;2e-16 ***
## regionNorra inlands      -0.0906     0.0363    -2.5   0.0127 *  
## regionSundsvalls         -0.3801     0.0350   -10.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(182 b.(184 male   ptrnlg.m ptrnlg.d rgnLnk rgnNri
## b.(1824,184 -0.509                                                     
## b.(1845,186 -0.361  0.422                                              
## male        -0.281  0.002 -0.001                                       
## paternlg.mn -0.116  0.095  0.054  0.000                                
## patrnlg.dff  0.172 -0.150 -0.120  0.001 -0.003                         
## regnLnkpngs -0.644  0.201  0.179 -0.003  0.034   -0.050                
## rgnNrrinlnd -0.665  0.181  0.130 -0.006 -0.008   -0.055    0.555       
## rgnSndsvlls -0.627  0.066  0.065 -0.004  0.067   -0.032    0.558  0.558</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Any_surviving_children_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Any_surviving_children)
<span class="kw">plot_fortified_mer</span>(Any_surviving_children_coefs, <span class="st">&quot;Any surviving children&quot;</span>)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Any_surviving_children-1.png" title="" alt="" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Any_surviving_children)</code></pre>
<p><img src="2_ddb_main_effects_files/figure-html/Any_surviving_children-2.png" title="" alt="" width="1440px" height="900px" /></p>
</div>
</div>
<div id="wrap-up" class="section level1 accordion">
<h1>Wrap up</h1>
<div id="save-coefficients" class="section level4">
<h4>Save coefficients</h4>
<pre class="sourceCode r"><code class="sourceCode r">name =<span class="st"> &quot;ddb_main_effects&quot;</span>
<span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">lstype</span>(<span class="st">&#39;confint.merMod&#39;</span>),<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;coefs/&quot;</span>,name,<span class="st">&quot;_coefs.rdata&quot;</span>))
<span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">lstype</span>(),<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;coefs/&quot;</span>,name,<span class="st">&quot;_models.rdata&quot;</span>))</code></pre>
</div>
<div id="session-info" class="section level4">
<h4>Session Info</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre>
<pre><code>## R version 3.1.3 (2015-03-09)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.10.2 (Yosemite)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] grid      graphics  grDevices utils     datasets  stats     methods  
## [8] base     
## 
## other attached packages:
##  [1] MCMCglmm_2.22    ape_3.2          coda_0.17-1      pipeR_0.6       
##  [5] htmltools_0.2.6  XML_3.98-1.1     gridSVG_1.4-3    extrafont_0.17  
##  [9] lmerTest_2.0-20  blme_1.0-2       lme4_1.1-7       Rcpp_0.11.5     
## [13] Matrix_1.1-5     zoo_1.7-11       foreign_0.8-63   mgcv_1.8-4      
## [17] nlme_3.1-120     haven_0.1.1.9000 QuantPsyc_1.5    MASS_7.3-39     
## [21] boot_1.3-15      psych_1.5.1      Hmisc_3.15-0     Formula_1.2-0   
## [25] survival_2.38-1  lattice_0.20-30  reshape2_1.4.1   lubridate_1.3.3 
## [29] car_2.0-25       stringi_0.4-1    dplyr_0.4.1      pander_0.5.2    
## [33] knitr_1.9        rmarkdown_0.5.1  plyr_1.8.1       ggplot2_1.0.0   
## [37] formr_0.1.11     data.table_1.9.5 stringr_0.6.2    devtools_1.7.0  
## 
## loaded via a namespace (and not attached):
##  [1] acepack_1.3-3.3      assertthat_0.1       bitops_1.0-6        
##  [4] caTools_1.17.1       chron_2.3-45         cluster_2.0.1       
##  [7] codetools_0.2-10     colorspace_1.2-5     corpcor_1.6.7       
## [10] cubature_1.1-2       DBI_0.3.1            digest_0.6.8        
## [13] evaluate_0.5.5       extrafontdb_1.0      formatR_1.0         
## [16] formula.tools_1.3.4  gdata_2.13.3         gplots_2.16.0       
## [19] gtable_0.1.2         gtools_3.4.1         KernSmooth_2.23-14  
## [22] labeling_0.3         latticeExtra_0.6-26  lazyeval_0.1.10     
## [25] magrittr_1.5         memoise_0.2.1        minqa_1.2.4         
## [28] mnormt_1.5-1         munsell_0.4.2        nloptr_1.0.4        
## [31] nnet_7.3-9           numDeriv_2012.9-1    operator.tools_1.3.0
## [34] parallel_3.1.3       pbkrtest_0.4-2       proto_0.3-10        
## [37] quantreg_5.11        RColorBrewer_1.1-2   RJSONIO_1.3-0       
## [40] rpart_4.1-9          Rttf2pt1_1.3.3       scales_0.2.4        
## [43] SparseM_1.6          splines_3.1.3        tcltk_3.1.3         
## [46] tensorA_0.36         tools_3.1.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">date</span>()</code></pre>
<pre><code>## [1] &quot;Mon Mar 30 18:06:49 2015&quot;</code></pre>
<script src="library/auto_tab_first_section.js"></script>
<style> img { max-width:100%; height: auto; } </style>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>
</body>
</html>
