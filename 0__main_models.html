<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title> Main Models</title>

<script src="library/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="library/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>



</head>

<body>
<div class="container-fluid main-container">
	<div class="row">
	<div class="col-md-2" style="border-top:solid #E2A674 20px"></div>
	<div class="col-md-2 rpqa" style="border-top:solid #9F3B2B 20px"></div>
	<div class="col-md-4" style="background:black;text-align:center"><a href="index.html" style="color:white"><i class="glyphicon glyphicon-th-list"></i> Back to index</a></div>
	<div class="col-md-2 hist_sweden" style="border-top:solid #21523B 20px"></div>
	<div class="col-md-2 mod_sweden" style="border-top:solid #8A846C 20px"></div>
	</div>
</div>

<div class="container-fluid main-container">


<div id="model-description" class="section level3">
<h3>Model description</h3>
<p>All of the following models have the following in common:</p>
<div id="estimation" class="section level4">
<h4>Estimation</h4>
<p>We fit all models using <code>brms</code> v. 1.2.0, a Bayesian regression analysis statistical package. <code>brms</code> uses <code>Stan</code>, a probabilistic programming langugage to fit models using Hamiltonian Monte Carlo.</p>
</div>
<div id="covariates" class="section level4">
<h4>Covariates</h4>
<p>In our main models we adjust for average paternal age in the family, birth cohort (birth years in five equally large bins), for male sex, for age at paternal and maternal loss (0-1, 2-5, 6-10, …, 41-45, 45+, unknown), for maternal age (bins of 14-20, 20-35 and 35-50), for the number of siblings, for the number of older siblings (0-5, 5+) and for being last born.</p>
</div>
<div id="model-stratification" class="section level4">
<h4>Model stratification</h4>
<p>We added random intercepts for each family (father-mother dyad). We then controlled for the average paternal age in the family. Hence, the paternal age effects in the plot are split into those between families and those within families or between siblings. We are interested in the effect of paternal age between siblings, as this effect cannot be explained by e.g. genetic propensities of the father to reproduce late.</p>
</div>
</div>
<div id="m1_children_linear_noranef" class="section level2 tab-content">
<h2><em>m1</em>: No sibling comparison</h2>
<p>Here, we ignore the pedigree structure of the data to see whether it matters for the estimation of the paternal age effect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_filename =<span class="st"> </span><span class="kw">make_path</span>(<span class="st">&quot;m1_children_linear_noranef&quot;</span>)
<span class="kw">summarise_model</span>()
m1 =<span class="st"> </span>model</code></pre></div>
</div>
<div id="m2_children_linear_no_diff" class="section level2 tab-content">
<h2><em>m2</em>: Sibling comparison, no paternal age effect</h2>
<p>Here, we compared siblings by including a random intercept for the family, but we modelled no effect for paternal age differences among siblings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_filename =<span class="st"> </span><span class="kw">make_path</span>(<span class="st">&quot;m2_children_linear_no_diff&quot;</span>)
<span class="kw">summarise_model</span>()
m2 =<span class="st"> </span>model</code></pre></div>
</div>
<div id="m3_children_linear" class="section level2 tab-content">
<h2><em>m3</em>: Sibling comparison, linear paternal age effect</h2>
<p>Here, we compared siblings by including a random intercept for the family, and we modelled a linear effect for paternal age differences among siblings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_filename =<span class="st"> </span><span class="kw">make_path</span>(<span class="st">&quot;m3_children_linear&quot;</span>)
<span class="kw">summarise_model</span>()
m3 =<span class="st"> </span>model</code></pre></div>
</div>
<div id="m4_children_nonlinear" class="section level2 tab-content">
<h2><em>m4</em>: Sibling comparison, nonlinear paternal age effect</h2>
<p>Here, we compared siblings by including a random intercept for the family, and we modelled a possibly nonlinear effect for paternal age differences among siblings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_filename =<span class="st"> </span><span class="kw">make_path</span>(<span class="st">&quot;m4_children_nonlinear&quot;</span>)
<span class="kw">summarise_model</span>()
m4 =<span class="st"> </span>model</code></pre></div>
</div>
<div id="model-comparison" class="section level2">
<h2>Model comparison</h2>
<p>We compare the four models using an approximative leave-one-out cross-validation information criterion as implemented in <code>brms</code> and <code>loo</code> and the Watanabe-Akaike information criterion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_comparison =<span class="st"> </span><span class="kw">LOO</span>(m1, m2, m3, m4, <span class="dt">pointwise =</span> <span class="ot">FALSE</span>)
<span class="kw">print</span>(model_comparison)
<span class="kw">plot</span>(model_comparison$m1)
<span class="kw">plot</span>(model_comparison$m2)
<span class="kw">plot</span>(model_comparison$m3)
<span class="kw">plot</span>(model_comparison$m4)
<span class="kw">WAIC</span>(m1, m2, m3, m4, <span class="dt">compare =</span> <span class="ot">TRUE</span>, <span class="dt">pointwise =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>
</body>
</html>
