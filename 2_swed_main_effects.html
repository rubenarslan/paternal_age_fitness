<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Modern Sweden Main Effects</title>

<script src="library/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.1/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>


<script src="library/auto_tab_first_section.js"></script>

</head>

<body>
<div style="width:100%;height:200px;background-image:url('library/header/swed.jpg');background-size:cover;"></div>
<div class="container-fluid main-container"><div class="row"><div class="col-md-4"><a href="index.html"><i class="glyphicon glyphicon-th-list"></i> Back to index</a></div></div></div>

<div class="container-fluid main-container">


<div id="sweden-main-effects" class="section level1 tab-content">
<h1>Sweden main effects</h1>
<div id="loading-details" class="section level3 accordion">
<h3>Loading details</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bsub -q fat -W 48:00 -n 1 Rscript -e &quot;setwd(&#39;/usr/users/rarslan/updated_data/2_swed_main_effects_surv/&#39;);knitr::knit(input = &#39;2_swed_main_effects.Rmd&#39;, output = &#39;2_swed_main_effects.md&#39;)&quot;</span>

<span class="kw">library</span>(data.table); <span class="kw">library</span>(ggplot2); <span class="kw">library</span>(knitr); <span class="kw">library</span>(lme4);   <span class="kw">library</span>(formr); <span class="kw">library</span>(blme)

opts_chunk$<span class="kw">set</span>(<span class="dt">warning=</span><span class="ot">TRUE</span>, <span class="dt">cache=</span>T,<span class="dt">cache.lazy=</span>F,<span class="dt">tidy=</span><span class="ot">FALSE</span>,<span class="dt">autodep=</span><span class="ot">TRUE</span>,<span class="dt">dev=</span><span class="kw">c</span>(<span class="st">&#39;png&#39;</span>,<span class="st">&#39;pdf&#39;</span>),<span class="dt">fig.width=</span><span class="dv">20</span>,<span class="dt">fig.height=</span><span class="fl">12.5</span>,<span class="dt">out.width=</span><span class="st">&#39;1440px&#39;</span>,<span class="dt">out.height=</span><span class="st">&#39;900px&#39;</span>,<span class="dt">cache.extra=</span><span class="kw">file.info</span>(<span class="st">&#39;swed1.rdata&#39;</span>)[, <span class="st">&#39;mtime&#39;</span>])

<span class="kw">source</span>(<span class="st">&quot;0__helpers.R&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;swed1.rdata&quot;</span>)
swed<span class="fl">.2</span> =<span class="st"> </span>swed<span class="fl">.2</span>[byear &gt;<span class="st"> </span><span class="dv">1969</span>, ]
<span class="co"># library(dplyr)</span>
<span class="co"># swed.2 %&gt;% group_by(idParents) %&gt;% summarise(sibs = n()) %&gt;% ggplot() + geom_bar(aes(sibs))</span></code></pre>
</div>
<div id="analysis-description" class="section level2">
<h2>Analysis description</h2>
<div id="data-subset" class="section level3">
<h3>Data subset</h3>
<p>The <code>swed.1</code> dataset contains only those participants where paternal age is known, the birthdate of the father is between 1890 and 1900. ### Model description All of the following models have the following in common:</p>
<div id="optimizer-settings" class="section level4">
<h4>Optimizer settings</h4>
<p>Bobyqa is fairly robust to convergence failures. In addition to using Bobyqa, we center some variables that otherwise lead to large eigenvalues.</p>
<pre class="sourceCode r"><code class="sourceCode r">control_defaults =<span class="st"> </span><span class="kw">glmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>)</code></pre>
</div>
<div id="covariates" class="section level4">
<h4>Covariates</h4>
<p>We control for birth.cohort (birth years in five equally large bins), male sex.</p>
</div>
<div id="model-stratification" class="section level4">
<h4>Model stratification</h4>
<p>We added random intercepts for each family (father-mother dyad). We then controlled for the average paternal age in the family. Hence, the paternal age effects in the plot are split into those between families and those within families or between siblings. The relevant effect for our hypothesized mechanism, de novo mutations, is paternal age between siblings.</p>
</div>
<div id="episodes-of-selection" class="section level4">
<h4>Episodes of selection</h4>
<p>Here, episodes of selection refers to survival, mating success, reproductive success. To steer clear of sacrificial pseudo-replication, we make sure that each effect cannot be explained by the episode of selection preceding it. At its simplest, we check for effect on survival to reproduction only among those who lived to their first birthday. In later models, we look for an effect on number of children only among those who married and control their number of spouses.</p>
</div>
</div>
</div>
<div id="all-children" class="section level2">
<h2>All children</h2>
<p>unlike the other models we don’t compute the number of surviving children. The pragmatic reason is that a) if we force data to span enough time for children’s survival to count as observed, we dramatically reduce sample size and b) child mortality in modern Sweden is so low, that there really shouldn’t be much of a difference between the two numbers</p>
<pre class="sourceCode r"><code class="sourceCode r">Children_all &lt;-<span class="st"> </span><span class="kw">bglmer</span>(
    children ~<span class="st"> </span>male +<span class="st"> </span>birth.cohort +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>(<span class="dv">1</span>|idParents),
    <span class="dt">data=</span> swed<span class="fl">.1</span>, <span class="dt">subset =</span> byear &lt;<span class="st"> </span><span class="dv">1958</span>,
<span class="dt">family =</span> <span class="st">&#39;poisson&#39;</span>, <span class="dt">control =</span> control_defaults, 
<span class="dt">fixef.prior =</span> <span class="kw">normal</span>()  )
<span class="kw">summary</span>(Children_all)</code></pre>
<pre><code>## Cov prior  : idParents ~ wishart(df = 3.5, scale = Inf, posterior.scale = cov, common.scale = TRUE)
## Fixef prior: normal(sd = c(10, 2.5, ...), corr = c(0 ...), common.scale = FALSE)
## Prior dev  : 44.44
## 
## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [bglmerMod]
##  Family: poisson  ( log )
## Formula: 
## children ~ male + birth.cohort + paternalage.mean + paternalage.diff +  
##     (1 | idParents)
##    Data: swed.1
## Control: control_defaults
##  Subset: byear &lt; 1958
## 
##      AIC      BIC   logLik deviance df.resid 
##  3949126  3949222 -1974555  3949110  1207595 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -1.415 -0.642  0.095  0.770 11.486 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 2.38e-05 0.00487 
## Number of obs: 1207603, groups:  idParents, 795812
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              0.64926    0.00140     462  &lt; 2e-16 ***
## male                    -0.05725    0.00134     -43  &lt; 2e-16 ***
## birth.cohort(1949,1951] -0.00286    0.00201      -1  0.15480    
## birth.cohort(1951,1954] -0.00639    0.00180      -4  0.00039 ***
## birth.cohort(1954,1957] -0.01092    0.00180      -6  1.3e-09 ***
## paternalage.mean        -0.02756    0.00114     -24  &lt; 2e-16 ***
## paternalage.diff        -0.03475    0.00202     -17  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) male   b.(194 b.(1951 b.(1954 ptrnlg.m
## male        -0.472                                       
## b.(1949,195 -0.541 -0.003                                
## b.(1951,195 -0.605 -0.003  0.423                         
## b.(1954,195 -0.607 -0.003  0.424  0.475                  
## paternlg.mn -0.062  0.001  0.026  0.049   0.072          
## patrnlg.dff  0.015  0.001 -0.011 -0.021  -0.030  -0.091</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Children_all_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Children_all)
<span class="kw">plot_fortified_mer</span>(Children_all_coefs, <span class="st">&quot;Nr. Children (of those who had at least one spouse)&quot;</span>)</code></pre>
<p><img src="2_swed_main_effects/figure/Children_all-1.png" title="plot of chunk Children_all" alt="plot of chunk Children_all" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Children_all)</code></pre>
<p><img src="2_swed_main_effects/figure/Children_all-2.png" title="plot of chunk Children_all" alt="plot of chunk Children_all" width="1440px" height="900px" /></p>
</div>
<div id="any-children" class="section level2">
<h2>Any children</h2>
<pre class="sourceCode r"><code class="sourceCode r">swed<span class="fl">.1</span>$any_children =<span class="st"> </span><span class="kw">ifelse</span>(swed<span class="fl">.1</span>$children &gt;<span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)
Any_children &lt;-<span class="st"> </span><span class="kw">bglmer</span>(
    any_children ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> swed<span class="fl">.1</span>, <span class="dt">subset =</span> byear &lt;<span class="st"> </span><span class="dv">1958</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults, 
<span class="dt">fixef.prior =</span> <span class="kw">normal</span>()  )
<span class="kw">summary</span>(Any_children)</code></pre>
<pre><code>## Cov prior  : idParents ~ wishart(df = 3.5, scale = Inf, posterior.scale = cov, common.scale = TRUE)
## Fixef prior: normal(sd = c(10, 2.5, ...), corr = c(0 ...), common.scale = FALSE)
## Prior dev  : 28.92
## 
## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [bglmerMod]
##  Family: binomial  ( logit )
## Formula: 
## any_children ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     (1 | idParents)
##    Data: swed.1
## Control: control_defaults
##  Subset: byear &lt; 1958
## 
##      AIC      BIC   logLik deviance df.resid 
##  1185433  1185529  -592708  1185417  1207595 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -2.935  0.332  0.386  0.445  1.177 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 0.789    0.888   
## Number of obs: 1207603, groups:  idParents, 795812
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              2.00871    0.00583     345   &lt;2e-16 ***
## birth.cohort(1949,1951] -0.09487    0.00781     -12   &lt;2e-16 ***
## birth.cohort(1951,1954] -0.17527    0.00696     -25   &lt;2e-16 ***
## birth.cohort(1954,1957] -0.25876    0.00693     -37   &lt;2e-16 ***
## male                    -0.44408    0.00519     -86   &lt;2e-16 ***
## paternalage.mean        -0.18431    0.00446     -41   &lt;2e-16 ***
## paternalage.diff        -0.02356    0.00777      -3   0.0024 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(194 b.(1951 b.(1954 male   ptrnlg.m
## b.(1949,195 -0.527                                       
## b.(1951,195 -0.598  0.444                                
## b.(1954,195 -0.611  0.448  0.513                         
## male        -0.514 -0.001  0.002   0.003                 
## paternlg.mn -0.097  0.027  0.053   0.078   0.008         
## patrnlg.dff  0.027 -0.023 -0.047  -0.069   0.002 -0.096</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Any_children_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Any_children)
<span class="kw">plot_fortified_mer</span>(Any_children_coefs, <span class="st">&quot;Any children&quot;</span>)</code></pre>
<p><img src="2_swed_main_effects/figure/Any_children-1.png" title="plot of chunk Any_children" alt="plot of chunk Any_children" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Any_children)</code></pre>
<p><img src="2_swed_main_effects/figure/Any_children-2.png" title="plot of chunk Any_children" alt="plot of chunk Any_children" width="1440px" height="900px" /></p>
</div>
<div id="survival-to-first-year" class="section level2">
<h2>Survival to first year</h2>
<pre class="sourceCode r"><code class="sourceCode r">Survive_infancy &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    survive1y ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> swed<span class="fl">.2</span>, 
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>),
 <span class="dt">nAGQ =</span> <span class="dv">0</span>  )

<span class="kw">summary</span>(Survive_infancy)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Adaptive
##   Gauss-Hermite Quadrature, nAGQ = 0) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## survive1y ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     (1 | idParents)
##    Data: swed.2
## Control: glmerControl(optimizer = &quot;bobyqa&quot;)
## 
##      AIC      BIC   logLik deviance df.resid 
##   216611   216728  -108296   216593  3315763 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -11.764   0.062   0.070   0.078   0.566 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 1.43     1.2     
## Number of obs: 3315772, groups:  idParents, 1828187
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               4.9491     0.0175   282.5  &lt; 2e-16 ***
## birth.cohort(1974,1981]   0.3215     0.0216    14.9  &lt; 2e-16 ***
## birth.cohort(1981,1988]   0.4703     0.0222    21.2  &lt; 2e-16 ***
## birth.cohort(1988,1993]   0.6033     0.0242    24.9  &lt; 2e-16 ***
## birth.cohort(1993,1999]   0.9564     0.0275    34.8  &lt; 2e-16 ***
## male                     -0.2333     0.0154   -15.2  &lt; 2e-16 ***
## paternalage.mean         -0.2208     0.0135   -16.4  &lt; 2e-16 ***
## paternalage.diff          0.1904     0.0275     6.9  4.2e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(197 b.(1981 b.(1988 b.(199 male   ptrnlg.m
## b.(1974,198 -0.598                                              
## b.(1981,198 -0.592  0.475                                       
## b.(1988,199 -0.547  0.435  0.435                                
## b.(1993,199 -0.487  0.385  0.386   0.359                        
## male        -0.500  0.000 -0.001   0.000   0.000                
## paternlg.mn  0.132 -0.056 -0.117  -0.126  -0.150  0.001         
## patrnlg.dff  0.029  0.006 -0.016  -0.030  -0.029  0.002  0.041</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Survive_infancy_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Survive_infancy)
<span class="kw">plot_fortified_mer</span>(Survive_infancy_coefs, <span class="st">&quot;Surviving infancy / first year&quot;</span>)</code></pre>
<p><img src="2_swed_main_effects/figure/Survive_1y-1.png" title="plot of chunk Survive_1y" alt="plot of chunk Survive_1y" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Survive_infancy)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<p><img src="2_swed_main_effects/figure/Survive_1y-2.png" title="plot of chunk Survive_1y" alt="plot of chunk Survive_1y" width="1440px" height="900px" /></p>
</div>
<div id="survival-to-reproductive-age" class="section level2">
<h2>Survival to reproductive age</h2>
<pre class="sourceCode r"><code class="sourceCode r">Survive_reproductive &lt;-<span class="st"> </span><span class="kw">glmer</span>(
    surviveR ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> swed<span class="fl">.2</span>, <span class="dt">subset =</span> survive1y ==<span class="st"> </span><span class="ot">TRUE</span> &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1990</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults,
    <span class="dt">nAGQ =</span> <span class="dv">0</span> )
<span class="kw">summary</span>(Survive_reproductive)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Adaptive
##   Gauss-Hermite Quadrature, nAGQ = 0) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## surviveR ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     (1 | idParents)
##    Data: swed.2
## Control: control_defaults
##  Subset: survive1y == TRUE &amp; byear &lt; 1990
## 
##      AIC      BIC   logLik deviance df.resid 
##    74695    74796   -37340    74679  2169610 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -15.932   0.044   0.048   0.053   0.322 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 1.64     1.28    
## Number of obs: 2169618, groups:  idParents, 1286846
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               5.8909     0.0290   203.1  &lt; 2e-16 ***
## birth.cohort(1974,1981]   0.3089     0.0338     9.1  &lt; 2e-16 ***
## birth.cohort(1981,1988]   0.4492     0.0348    12.9  &lt; 2e-16 ***
## birth.cohort(1988,1993]   0.5390     0.0693     7.8  7.5e-15 ***
## male                     -0.2973     0.0278   -10.7  &lt; 2e-16 ***
## paternalage.mean         -0.1822     0.0248    -7.3  2.2e-13 ***
## paternalage.diff          0.4348     0.0487     8.9  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(197 b.(1981 b.(1988 male   ptrnlg.m
## b.(1974,198 -0.571                                       
## b.(1981,198 -0.568  0.478                                
## b.(1988,199 -0.287  0.240  0.240                         
## male        -0.563  0.000 -0.001   0.000                 
## paternlg.mn  0.158 -0.068 -0.139  -0.076   0.001         
## patrnlg.dff  0.066  0.006 -0.024  -0.018   0.002  0.055</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Survive_reproductive_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Survive_reproductive)
<span class="kw">plot_fortified_mer</span>(Survive_reproductive_coefs, <span class="st">&quot;Surviving to reproductive age / 15 years&quot;</span>)</code></pre>
<p><img src="2_swed_main_effects/figure/Survive_reproductive-1.png" title="plot of chunk Survive_reproductive" alt="plot of chunk Survive_reproductive" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Survive_reproductive)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<p><img src="2_swed_main_effects/figure/Survive_reproductive-2.png" title="plot of chunk Survive_reproductive" alt="plot of chunk Survive_reproductive" width="1440px" height="900px" /></p>
</div>
<div id="ever-married" class="section level2">
<h2>Ever married</h2>
<pre class="sourceCode r"><code class="sourceCode r">Ever_married &lt;-<span class="st"> </span><span class="kw">bglmer</span>(
    ever_married ~<span class="st"> </span>birth.cohort +<span class="st"> </span>male +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> swed<span class="fl">.1</span>, <span class="dt">subset =</span> (surviveR ==<span class="st"> </span>T |<span class="st"> </span><span class="kw">is.na</span>(surviveR)) &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1960</span>,
    <span class="dt">family =</span> <span class="st">&#39;binomial&#39;</span>, <span class="dt">control =</span> control_defaults,
    <span class="dt">fixef.prior =</span> <span class="kw">normal</span>()  )
<span class="kw">summary</span>(Ever_married)</code></pre>
<pre><code>## Cov prior  : idParents ~ wishart(df = 3.5, scale = Inf, posterior.scale = cov, common.scale = TRUE)
## Fixef prior: normal(sd = c(10, 2.5, ...), corr = c(0 ...), common.scale = FALSE)
## Prior dev  : 33.62
## 
## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [bglmerMod]
##  Family: binomial  ( logit )
## Formula: 
## ever_married ~ birth.cohort + male + paternalage.mean + paternalage.diff +  
##     (1 | idParents)
##    Data: swed.1
## Control: control_defaults
##  Subset: (surviveR == T | is.na(surviveR)) &amp; byear &lt; 1960
## 
##      AIC      BIC   logLik deviance df.resid 
##  1574406  1574515  -787194  1574388  1402935 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -2.757 -1.098  0.476  0.563  1.326 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 0.442    0.664   
## Number of obs: 1402944, groups:  idParents, 884054
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              1.77684    0.00521     341   &lt;2e-16 ***
## birth.cohort(1949,1951] -0.23331    0.00714     -33   &lt;2e-16 ***
## birth.cohort(1951,1954] -0.42604    0.00630     -68   &lt;2e-16 ***
## birth.cohort(1954,1957] -0.63336    0.00620    -102   &lt;2e-16 ***
## birth.cohort(1957,1959] -0.80199    0.00679    -118   &lt;2e-16 ***
## male                    -0.38920    0.00417     -93   &lt;2e-16 ***
## paternalage.mean        -0.10584    0.00362     -29   &lt;2e-16 ***
## paternalage.diff         0.00317    0.00621       1     0.61    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) b.(194 b.(1951 b.(1954 b.(1957 male   ptrnlg.m
## b.(1949,195 -0.565                                               
## b.(1951,195 -0.646  0.467                                        
## b.(1954,195 -0.665  0.477  0.547                                 
## b.(1957,195 -0.613  0.435  0.500   0.517                         
## male        -0.455  0.002  0.007   0.012   0.013                 
## paternlg.mn -0.078  0.025  0.048   0.072   0.086   0.006         
## patrnlg.dff  0.026 -0.017 -0.035  -0.054  -0.060   0.001 -0.096</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Ever_married_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Ever_married)
<span class="kw">plot_fortified_mer</span>(Ever_married_coefs, <span class="st">&quot;Odds of ever marrying&quot;</span>)</code></pre>
<p><img src="2_swed_main_effects/figure/Ever_married-1.png" title="plot of chunk Ever_married" alt="plot of chunk Ever_married" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Ever_married)</code></pre>
<p><img src="2_swed_main_effects/figure/Ever_married-2.png" title="plot of chunk Ever_married" alt="plot of chunk Ever_married" width="1440px" height="900px" /></p>
</div>
<div id="number-of-children" class="section level2">
<h2>Number of children</h2>
<pre class="sourceCode r"><code class="sourceCode r">Children &lt;-<span class="st"> </span><span class="kw">bglmer</span>(
    children ~<span class="st"> </span><span class="kw">center</span>(spouses)*male +<span class="st"> </span>birth.cohort +<span class="st"> </span>paternalage.mean +<span class="st"> </span>paternalage.diff +<span class="st"> </span>(<span class="dv">1</span>|idParents), 
    <span class="dt">data=</span> swed<span class="fl">.1</span>, <span class="dt">subset =</span> spouses &gt;<span class="st"> </span><span class="dv">0</span>  &amp;<span class="st"> </span>byear &lt;<span class="st"> </span><span class="dv">1958</span>,
<span class="dt">family =</span> <span class="st">&#39;poisson&#39;</span>, <span class="dt">control =</span> control_defaults,
    <span class="dt">fixef.prior =</span> <span class="kw">normal</span>()  )
<span class="kw">summary</span>(Children)</code></pre>
<pre><code>## Cov prior  : idParents ~ wishart(df = 3.5, scale = Inf, posterior.scale = cov, common.scale = TRUE)
## Fixef prior: normal(sd = c(10, 2.5, ...), corr = c(0 ...), common.scale = FALSE)
## Prior dev  : 55.38
## 
## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [bglmerMod]
##  Family: poisson  ( log )
## Formula: 
## children ~ center(spouses) * male + birth.cohort + paternalage.mean +  
##     paternalage.diff + (1 | idParents)
##    Data: swed.1
## Control: control_defaults
##  Subset: spouses &gt; 0 &amp; byear &lt; 1958
## 
##      AIC      BIC   logLik deviance df.resid 
##  2874285  2874402 -1437133  2874265   899026 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -1.994 -0.230 -0.080  0.561 10.211 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  idParents (Intercept) 2.17e-06 0.00147 
## Number of obs: 899036, groups:  idParents, 647504
## 
## Fixed effects:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)              0.67908    0.00181     374  &lt; 2e-16 ***
## center(spouses)          0.10063    0.00191      53  &lt; 2e-16 ***
## male                     0.01123    0.00175       6  1.3e-10 ***
## birth.cohort(1949,1951]  0.04459    0.00216      21  &lt; 2e-16 ***
## birth.cohort(1951,1954]  0.06545    0.00198      33  &lt; 2e-16 ***
## birth.cohort(1954,1957]  0.07946    0.00200      40  &lt; 2e-16 ***
## paternalage.mean         0.00047    0.00124       0      0.7    
## paternalage.diff        -0.03094    0.00214     -14  &lt; 2e-16 ***
## center(spouses):male     0.03998    0.00285      14  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) cntr() male   b.(194 b.(1951 b.(1954 ptrnlg.m ptrnlg.d
## centr(spss) -0.572                                                       
## male        -0.528  0.419                                                
## b.(1949,195 -0.522  0.148  0.026                                         
## b.(1951,195 -0.605  0.217  0.048  0.437                                  
## b.(1954,195 -0.604  0.221  0.049  0.435  0.490                           
## paternlg.mn -0.076  0.036  0.007  0.033  0.057   0.079                   
## patrnlg.dff  0.013  0.000 -0.001 -0.011 -0.021  -0.030  -0.092           
## cntr(spss):  0.306 -0.644 -0.566 -0.029 -0.057  -0.055   0.000    0.003</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Children_coefs =<span class="st"> </span><span class="kw">fortify_mine</span>(Children)
<span class="kw">plot_fortified_mer</span>(Children_coefs, <span class="st">&quot;Nr. Children (of those who had at least one spouse)&quot;</span>)</code></pre>
<p><img src="2_swed_main_effects/figure/Children-1.png" title="plot of chunk Children" alt="plot of chunk Children" width="1440px" height="900px" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_residuals</span>(Children)</code></pre>
<p><img src="2_swed_main_effects/figure/Children-2.png" title="plot of chunk Children" alt="plot of chunk Children" width="1440px" height="900px" /></p>
</div>
</div>
<div id="wrap-up" class="section level1 accordion">
<h1>Wrap up</h1>
<div id="save-coefficients" class="section level4">
<h4>Save coefficients</h4>
<pre class="sourceCode r"><code class="sourceCode r">name =<span class="st"> &quot;swed_main_effects&quot;</span>
<span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">lstype</span>(<span class="st">&#39;confint.merMod&#39;</span>),<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;coefs/&quot;</span>,name,<span class="st">&quot;_coefs.rdata&quot;</span>))
<span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">lstype</span>(),<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;coefs/&quot;</span>,name,<span class="st">&quot;_models.rdata&quot;</span>))</code></pre>
</div>
<div id="session-info" class="section level4">
<h4>Session Info</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre>
<pre><code>## R version 3.1.0 (2014-04-10)
## Platform: x86_64-redhat-linux-gnu (64-bit)
## 
## locale:
##  [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US       
##  [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US   
##  [7] LC_PAPER=en_US       LC_NAME=C            LC_ADDRESS=C        
## [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C 
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
##  [1] mgcv_1.8-4       nlme_3.1-119     stringr_0.6.2    pander_0.5.1    
##  [5] blme_1.0-2       formr_0.1.11     lme4_1.1-7       Rcpp_0.11.4     
##  [9] Matrix_1.1-5     ggplot2_1.0.0    data.table_1.9.5 knitr_1.9       
## 
## loaded via a namespace (and not attached):
##  [1] car_2.0-24           chron_2.3-45         codetools_0.2-10    
##  [4] colorspace_1.2-4     digest_0.6.8         evaluate_0.5.5      
##  [7] formatR_1.0          formula.tools_1.3.4  grid_3.1.0          
## [10] gtable_0.1.2         labeling_0.3         lattice_0.20-29     
## [13] MASS_7.3-37          minqa_1.2.4          munsell_0.4.2       
## [16] nloptr_1.0.4         nnet_7.3-8           operator.tools_1.3.0
## [19] parallel_3.1.0       pbkrtest_0.4-2       plyr_1.8.1          
## [22] proto_0.3-10         quantreg_5.11        reshape2_1.4.1      
## [25] scales_0.2.4         SparseM_1.6          splines_3.1.0       
## [28] tools_3.1.0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">date</span>()</code></pre>
<pre><code>## [1] &quot;Tue Apr 28 21:21:41 2015&quot;</code></pre>
<script src="library/auto_tab_first_section.js"></script>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>
</body>
</html>
