<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Ruben Arslan" />

<meta name="date" content="2015-03-05" />

<title>Simulate Effects</title>

<script src="library/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.1/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<script src="library/auto_tab_first_section.js"></script>
</head>

<body>

<div class="container-fluid main-container">


<div id="header">
<h4 class="author"><em>Ruben Arslan</em></h4>
<h4 class="date"><em>05 Mar 2015</em></h4>
</div>


<div id="load-libraries-and-define-simulation-functions" class="section level3 accordion">
<h3>load libraries and define simulation functions</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bsub -q mpi -W 48:00 -n 1 Rscript -e &quot;setwd(&#39;/usr/users/rarslan/&#39;); filebase = &#39;0_simulate_cycle&#39;; knitr::knit(input = paste0(filebase,&#39;.Rmd&#39;), output = paste0(filebase,&#39;.md&#39;));cat(readLines(paste0(filebase,&#39;.md&#39;)), sep = &#39;\n&#39;)&quot;</span>
<span class="kw">library</span>(data.table); <span class="kw">library</span>(ggplot2); <span class="kw">library</span>(psych); <span class="kw">library</span>(reshape2);<span class="kw">library</span>(plyr); <span class="kw">library</span>(dplyr); <span class="kw">library</span>(lme4); <span class="kw">library</span>(lmerTest)</code></pre>
<div id="simulation-functions" class="section level4">
<h4>Simulation functions</h4>
<pre class="sourceCode r"><code class="sourceCode r">simulate_fitness =<span class="st"> </span>function(
    ### settings
<span class="dt">nr_of_people =</span> <span class="fl">2e4</span>,
<span class="dt">average_family_size =</span> <span class="dv">5</span>,
<span class="dt">IBI =</span> <span class="dv">3</span>,
<span class="dt">effects =</span> <span class="kw">list</span>(
<span class="dt">family_intercept =</span> <span class="dv">15</span>,
<span class="dt">SES =</span> <span class="dv">1</span>,
<span class="dt">sibship_size =</span> -<span class="fl">0.1</span>,
<span class="dt">cohort =</span> <span class="fl">0.1</span>,
<span class="dt">patage =</span> -<span class="fl">0.1</span>,
<span class="dt">patage_on_ses =</span> <span class="fl">0.2</span>,
<span class="dt">noise =</span> <span class="dv">5</span>
)
) { 
    <span class="kw">library</span>(data.table); <span class="kw">library</span>(dplyr)
    #### simulate families
    nr_of_families =<span class="st"> </span><span class="kw">round</span>(nr_of_people/average_family_size)
<span class="co">#   sum(rpois(nr_of_families, lambda = average_family_size)) # ~number of individuals</span>
    individuals_in_family =<span class="st"> </span><span class="dv">1</span>+<span class="kw">rpois</span>(nr_of_families, <span class="dt">lambda =</span> average_family_size<span class="dv">-1</span>) <span class="co"># families need at least one member</span>
    
    families =<span class="st"> </span><span class="kw">data.table</span>(
        <span class="dt">family =</span> <span class="dv">1</span>:nr_of_families,
        <span class="dt">family_intercept =</span> <span class="kw">rnorm</span>(nr_of_families),
        <span class="dt">sibship_size =</span> individuals_in_family,
        <span class="dt">year_of_first_birth =</span> <span class="dv">20</span> *<span class="st"> </span><span class="kw">runif</span>(nr_of_families) +<span class="st"> </span><span class="dv">1950</span>,
        <span class="dt">paternal_age_at_first_birth =</span> <span class="dv">7</span> *<span class="st"> </span><span class="kw">rnorm</span>(nr_of_families) +<span class="st"> </span><span class="dv">35</span>
    )
    families$SES =<span class="st"> </span><span class="fl">0.7</span> *<span class="st"> </span><span class="kw">rnorm</span>(nr_of_families) +<span class="st"> </span>effects$sibship_size *<span class="st"> </span>families$sibship_size +<span class="st"> </span>effects$patage_on_ses *<span class="st"> </span>((families$paternal_age_at_first_birth<span class="dv">-35</span>)/<span class="dv">10</span>) <span class="co"># family wealth is function of sibship size and paternal age</span>
    
    #### simulate people
    people =<span class="st"> </span><span class="kw">data.table</span>(
        <span class="dt">person =</span> <span class="dv">1</span>:nr_of_people,
        <span class="dt">family =</span> <span class="kw">rep</span>(<span class="dt">x =</span> <span class="dv">1</span>:nr_of_families, <span class="dt">times =</span> individuals_in_family, <span class="dt">length.out =</span> nr_of_people),
        <span class="dt">male =</span> <span class="kw">round</span>(<span class="kw">runif</span>(nr_of_people))
    )
    people =<span class="st"> </span><span class="kw">merge</span>(people, families, <span class="dt">by =</span> <span class="st">&#39;family&#39;</span>)
    <span class="co"># 30 seconds vs 8</span>
<span class="co">#   people = people %&gt;% group_by(family) %&gt;% mutate(</span>
<span class="co">#       birth_order = row_number(person),</span>
<span class="co">#       birth_year = year_of_first_birth + (birth_order - 1) * (1 + rpois(1, lambda = IBI - 1)),</span>
<span class="co">#       paternal_age = paternal_age_at_first_birth + birth_year - year_of_first_birth,</span>
<span class="co">#       paternal_age_mean = mean(paternal_age)</span>
<span class="co">#   ) </span>
    people[, birth_order :<span class="er">=</span><span class="st"> </span><span class="kw">ave</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(people), family,<span class="dt">FUN =</span> seq_along)]
    people[, birth_year :<span class="er">=</span><span class="st"> </span><span class="ot">NA_real_</span> ]
    people[, birth_year :<span class="er">=</span><span class="st"> </span>
<span class="st">        </span>year_of_first_birth +<span class="st"> </span>(birth_order -<span class="st"> </span><span class="dv">1</span>) *<span class="st"> </span>(<span class="dv">1</span> +<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">1</span>, <span class="dt">lambda =</span> IBI -<span class="st"> </span><span class="dv">1</span>)), by =<span class="st"> </span>family]

    <span class="co"># we used a bit odd method to simulate families with systematic differences in paternal ages</span>
    people[, paternal_age :<span class="er">=</span><span class="st"> </span>paternal_age_at_first_birth +<span class="st"> </span>birth_year -<span class="st"> </span>year_of_first_birth]
    people[, paternal_age_mean :<span class="er">=</span><span class="st"> </span><span class="kw">ave</span>(paternal_age, family,<span class="dt">FUN =</span> mean)]
    
    people[, fitness :<span class="er">=</span><span class="st"> </span>
<span class="st">                    </span>effects$family_intercept *<span class="st"> </span>family_intercept +<span class="st"> </span><span class="co"># unsystematic family effect</span>
<span class="st">                    </span>effects$SES *<span class="st"> </span>SES +<span class="st"> </span><span class="co"># unobs level 2 confound, pos. correlated with average pat age</span>
<span class="st">                    </span>effects$cohort *<span class="st"> </span>(birth_year<span class="dv">-1950</span>)/<span class="dv">10</span> +<span class="st"> </span><span class="co"># Flynn effect</span>
<span class="st">                    </span>effects$patage *<span class="st"> </span>(paternal_age<span class="dv">-35</span>)/<span class="dv">10</span> <span class="co"># paternal age effect</span>
    ]
    people[, fitness_m :<span class="er">=</span><span class="st"> </span>fitness +<span class="st"> </span>effects$noise  *<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">nrow</span>(people))]
    people
}

sumfun_fixed &lt;-<span class="st"> </span>function(fit) {
        aa =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">coef</span>(<span class="kw">summary</span>(fit)))
        aa$var =<span class="st"> </span><span class="kw">rownames</span>(aa)
        bb =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">confint</span>(fit,<span class="dt">method=</span><span class="st">&quot;Wald&quot;</span>))
        bb$var =<span class="st"> </span><span class="kw">rownames</span>(bb)
        aa =<span class="st"> </span><span class="kw">merge</span>(aa, bb, <span class="dt">by =</span> <span class="st">&quot;var&quot;</span>)
    aa
}

fitfun =<span class="st"> </span>function(data) { 
    <span class="kw">library</span>(lme4); <span class="kw">library</span>(lmerTest)
    <span class="kw">lmer</span>(fitness_m ~<span class="st"> </span>paternal_age_mean +<span class="st"> </span>paternal_age +<span class="st"> </span>birth_year +<span class="st"> </span>sibship_size +<span class="st"> </span>(<span class="dv">1</span> |<span class="st"> </span>family), <span class="dt">data =</span> data)
}

fitfunction =<span class="st"> </span>function(data) {
    <span class="kw">library</span>(formr); <span class="kw">library</span>(reshape2)
    coefs =<span class="st"> </span><span class="kw">sumfun_fixed</span>(<span class="kw">fitfun</span>(data))
    <span class="kw">dcast</span>(<span class="kw">melt</span>(coefs[coefs$var %contains%<span class="st"> &quot;paternal&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;var&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;Pr(&gt;|t|)&quot;</span>)],<span class="dt">id=</span><span class="st">&quot;var&quot;</span>), <span class="dt">formula =</span> . ~<span class="st"> </span>variable+<span class="st"> </span>var)[,<span class="dv">2</span>:<span class="dv">5</span>]
}</code></pre>
</div>
</div>
<div id="find-out-whether-lower-family-size-moves-the-paternal-age-effect" class="section level3">
<h3>Find out whether lower family size moves the paternal age effect</h3>
<p>from within family to between</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fitfunction</span>(<span class="kw">simulate_fitness</span>(<span class="dt">nr_of_people =</span> <span class="fl">2e5</span>, <span class="dt">average_family_size =</span> <span class="fl">1.9</span>))</code></pre>
<pre><code>##   Estimate_paternal_age Estimate_paternal_age_mean Pr(&gt;|t|)_paternal_age
## 1                -0.016                      0.025                  0.13
##   Pr(&gt;|t|)_paternal_age_mean
## 1                       0.05</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fitfunction</span>(<span class="kw">simulate_fitness</span>(<span class="dt">nr_of_people =</span> <span class="fl">2e5</span>, <span class="dt">average_family_size =</span> <span class="dv">2</span>))</code></pre>
<pre><code>##   Estimate_paternal_age Estimate_paternal_age_mean Pr(&gt;|t|)_paternal_age
## 1               -0.0093                     0.0085                  0.39
##   Pr(&gt;|t|)_paternal_age_mean
## 1                       0.51</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fitfunction</span>(<span class="kw">simulate_fitness</span>(<span class="dt">nr_of_people =</span> <span class="fl">2e5</span>, <span class="dt">average_family_size =</span> <span class="dv">3</span>))</code></pre>
<pre><code>##   Estimate_paternal_age Estimate_paternal_age_mean Pr(&gt;|t|)_paternal_age
## 1                0.0027                     0.0023                   0.8
##   Pr(&gt;|t|)_paternal_age_mean
## 1                       0.86</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fitfunction</span>(<span class="kw">simulate_fitness</span>(<span class="dt">nr_of_people =</span> <span class="fl">2e5</span>, <span class="dt">average_family_size =</span> <span class="dv">5</span>))</code></pre>
<pre><code>##   Estimate_paternal_age Estimate_paternal_age_mean Pr(&gt;|t|)_paternal_age
## 1                -0.025                      0.031                 0.042
##   Pr(&gt;|t|)_paternal_age_mean
## 1                      0.034</code></pre>
<div id="simulate-lots-of-configurations" class="section level4 accordion">
<h4>Simulate lots of configurations</h4>
<pre class="sourceCode r"><code class="sourceCode r">if(!<span class="kw">file.exists</span>(<span class="st">&#39;lme4_sims.Rdata&#39;</span>)) {
sample_people =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">3e4</span>)
average_family_size =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.9</span>,<span class="dv">3</span>,<span class="dv">6</span>)
IBI =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)
patage =<span class="st"> </span><span class="kw">c</span>(-<span class="fl">0.1</span>,-<span class="fl">0.2</span>,<span class="dv">0</span>)
patage_on_ses =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="dv">0</span>)
res0 &lt;-<span class="st"> </span><span class="kw">fitfunction</span>(<span class="kw">simulate_fitness</span>())
nrep &lt;-<span class="st"> </span><span class="dv">100</span>


resarr &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(
    <span class="kw">length</span>(sample_people),
    <span class="kw">length</span>(average_family_size),
    <span class="kw">length</span>(IBI),
    <span class="kw">length</span>(patage),
    <span class="kw">length</span>(patage_on_ses),
    nrep,
    <span class="kw">length</span>(res0)
), <span class="dt">dimnames =</span> <span class="kw">list</span>(
    <span class="dt">sample_size =</span> sample_people,
    <span class="dt">average_family_size =</span> average_family_size,
    <span class="dt">IBI =</span> IBI,
    <span class="dt">patage =</span> patage,
    <span class="dt">patage_on_ses =</span> patage_on_ses,
    <span class="dt">rep =</span> <span class="kw">seq</span>(nrep),
  <span class="dt">var =</span> <span class="kw">names</span>(res0)
    )
)

time_took =<span class="st"> </span><span class="kw">system.time</span>({ res0 &lt;-<span class="st"> </span><span class="kw">fitfun</span>(<span class="kw">simulate_fitness</span>(<span class="dt">nr_of_people =</span> <span class="dv">30</span>)) })
<span class="co"># time_calc</span>
<span class="kw">as.vector</span>(time_took[<span class="dv">3</span>]) *<span class="st"> </span><span class="kw">length</span>(resarr)/<span class="kw">length</span>(res0) /<span class="st"> </span><span class="dv">60</span> /<span class="st"> </span><span class="dv">60</span>  <span class="co"># hours for the whole results array</span>

## prefer to use i,j,k,... for indices
for (i in <span class="kw">seq_along</span>(sample_people)) {
    for (j in <span class="kw">seq_along</span>(average_family_size)) {
        for (k in <span class="kw">seq_along</span>(IBI)) {
            for (l in <span class="kw">seq_along</span>(patage)) {
                for (m in <span class="kw">seq_along</span>(patage_on_ses)) {
                    ## if you want to see progress in the output file 
                    <span class="kw">cat</span>(i,j,k,l,m,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) 
                        for(n in <span class="dv">1</span>:nrep) {

                        resarr[i,j,k,l,m,n,] &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">fitfunction</span>(<span class="kw">simulate_fitness</span>(
                            <span class="dt">nr_of_people =</span> sample_people[i],
                            <span class="dt">average_family_size =</span> average_family_size[j],
                            <span class="dt">IBI =</span> IBI[k],
                                        <span class="dt">effects =</span> <span class="kw">list</span>(
                                            <span class="dt">family_intercept =</span> <span class="dv">15</span>,
                                            <span class="dt">SES =</span> <span class="dv">1</span>,
                                            <span class="dt">sibship_size =</span> -<span class="fl">0.1</span>,
                                            <span class="dt">cohort =</span> <span class="fl">0.1</span>,
                                <span class="dt">patage =</span> patage[l],
                                <span class="dt">patage_on_ses =</span> patage_on_ses[m],
                                            <span class="dt">noise =</span> <span class="dv">5</span>
                                        )
                                )))
                        }
                    ## checkpointing
                    ## decide whether you want this in the innermost or next-
                    ## or next-next ... probably don&#39;t need to save more than once every
                    ## 10 minutes or so unless you&#39;re really impatient and want
                    ## to look at interim results in an independent R session
                }
            }
            <span class="kw">save</span>(resarr,<span class="dt">file=</span><span class="st">&quot;lme4_sims.RData&quot;</span>)
    }
    }
}
<span class="kw">save</span>(resarr,<span class="dt">file=</span><span class="st">&quot;lme4_sims.RData&quot;</span>)
} else {
    <span class="kw">load</span>(<span class="st">&quot;lme4_sims.Rdata&quot;</span>)
}</code></pre>
<div id="reshape-the-results-array" class="section level5">
<h5>reshape the results array</h5>
<pre class="sourceCode r"><code class="sourceCode r">resdf =<span class="st"> </span><span class="kw">melt</span>(resarr)
resdf =<span class="st"> </span><span class="kw">dcast</span>(resdf,<span class="dt">formula =</span> sample_size +<span class="st"> </span>average_family_size +<span class="st"> </span>IBI +<span class="st"> </span>patage +<span class="st"> </span>patage_on_ses +<span class="st"> </span>rep ~<span class="st"> </span>var)
resdf$pval_mean =<span class="st"> </span>resdf$<span class="st">`</span><span class="dt">Pr(&gt;|t|)_paternal_age_mean</span><span class="st">`</span>
resdf$pval_diff =<span class="st"> </span>resdf$<span class="st">`</span><span class="dt">Pr(&gt;|t|)_paternal_age</span><span class="st">`</span>
resdf2 =<span class="st"> </span><span class="kw">na.omit</span>(<span class="kw">data.table</span>(resdf))</code></pre>
</div>
<div id="power-permutations" class="section level5">
<h5>Power permutations</h5>
<pre class="sourceCode r"><code class="sourceCode r">power_all =<span class="st"> </span>resdf2 %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(sample_size, average_family_size, IBI, patage, patage_on_ses) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(
                         <span class="dt">power_mean =</span> <span class="kw">mean</span>(pval_mean &lt;<span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                         <span class="dt">power_diff =</span> <span class="kw">mean</span>(pval_diff &lt;<span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                         <span class="dt">estimation_mean =</span> <span class="kw">mean</span>(Estimate_paternal_age_mean, <span class="dt">na.rm=</span>T),
                         <span class="dt">estimation_diff =</span> <span class="kw">mean</span>(Estimate_paternal_age, <span class="dt">na.rm=</span>T)
)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_famsize =<span class="st"> </span>resdf2 %&gt;%
<span class="st">    </span><span class="kw">filter</span>(patage ==<span class="st"> </span>-<span class="fl">0.1</span>, patage_on_ses ==<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(sample_size, average_family_size, IBI) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(
                         <span class="dt">power_mean =</span> <span class="kw">mean</span>(pval_mean &lt;<span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                         <span class="dt">power_diff =</span> <span class="kw">mean</span>(pval_diff &lt;<span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                         <span class="dt">estimation_mean =</span> <span class="kw">mean</span>(Estimate_paternal_age_mean, <span class="dt">na.rm=</span>T),
                         <span class="dt">estimation_diff =</span> <span class="kw">mean</span>(Estimate_paternal_age, <span class="dt">na.rm=</span>T)
    ) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">melt</span>(<span class="dt">id=</span><span class="kw">c</span>(<span class="st">&quot;sample_size&quot;</span>,<span class="st">&quot;average_family_size&quot;</span>,<span class="st">&quot;IBI&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(
        <span class="dt">variable =</span> <span class="kw">as.character</span>(variable),
        <span class="dt">level =</span> <span class="kw">str_split_fixed</span>(variable,<span class="dt">pattern =</span> <span class="st">&quot;_&quot;</span>,<span class="dt">n =</span> <span class="dv">2</span>)[,<span class="dv">2</span>], 
        <span class="dt">variable =</span> <span class="kw">str_split_fixed</span>(variable,<span class="dt">pattern =</span> <span class="st">&quot;_&quot;</span>,<span class="dt">n =</span> <span class="dv">2</span>)[,<span class="dv">1</span>]) %&gt;%
<span class="st">    </span><span class="kw">dcast</span>(<span class="dt">formula =</span> ... ~<span class="st"> </span>variable, <span class="dt">fun.aggregate =</span> mean)
<span class="kw">qplot</span>(<span class="dt">x =</span> <span class="kw">factor</span>(average_family_size), <span class="dt">y =</span> power,<span class="dt">colour =</span> level, <span class="dt">label =</span> <span class="kw">round</span>(power,<span class="dv">2</span>), <span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">data =</span> power_famsize) +<span class="st"> </span><span class="kw">facet_grid</span>(IBI ~<span class="st"> </span>sample_size)</code></pre>
<p><img src="5_simulate_effects_files/figure-html/unnamed-chunk-3-1.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">x =</span> <span class="kw">factor</span>(average_family_size), <span class="dt">y =</span> estimation,<span class="dt">colour =</span> level, <span class="dt">label =</span> <span class="kw">round</span>(estimation,<span class="dv">2</span>), <span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">data =</span> power_famsize) +<span class="st"> </span><span class="kw">facet_grid</span>(IBI ~<span class="st"> </span>sample_size)</code></pre>
<p><img src="5_simulate_effects_files/figure-html/unnamed-chunk-3-2.png" /></p>
<script src="library/auto_tab_first_section.js"></script>
</div>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>
</body>
</html>
